# Common features across plots {-}

```{r echo = F}
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
```

This page aims to assess common functionalities present across the different functions in the package.

## Changing the font size.
This can be achieved by using `font.size` parameter and works for all **ggplot2-based** plots.

```{r, fig.cap="SCpubr do_DimPlot increasing font.size.", fig.width=14, fig.height=7}
p <- SCpubr::do_DimPlot(sample) | 
     SCpubr::do_DimPlot(sample, 
                        font.size = 18)
p
```

```{r, fig.cap="SCpubr do_FeaturePlot increasing font.size.", fig.width=14, fig.height=7}
p <- SCpubr::do_FeaturePlot(sample = sample,
                            features = "CD14") | 
     SCpubr::do_FeaturePlot(sample = sample, 
                            features = "CD14",
                            font.size = 18)
p
```
```{r, fig.cap="SCpubr do_NebulosaPlot increasing font.size.", fig.width=14, fig.height=7}
p <- SCpubr::do_NebulosaPlot(sample = sample,
                             features = "CD14") |
     SCpubr::do_NebulosaPlot(sample = sample,
                             features = "CD14",
                             font.size = 18)
p
```

```{r, fig.cap="SCpubr do_BeeSwarmPlot increasing font.size.", fig.width=14, fig.height=7}
p <- SCpubr::do_BeeSwarmPlot(sample = sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters") | 
     SCpubr::do_BeeSwarmPlot(sample = sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters",
                             font.size = 18)
p
```


```{r, fig.cap="SCpubr do_VlnPlot increasing font.size.", fig.width=10, fig.height=8}
p <- SCpubr::do_VlnPlot(sample = sample,
                        features = "CD14") /
     SCpubr::do_VlnPlot(sample = sample,
                        features = "CD14",
                        font.size = 18)
p
```

```{r, fig.cap="SCpubr do_DotPlot increasing font.size.", fig.width=14, fig.height=7}
p <- SCpubr::do_DotPlot(sample = sample,
                        features = "CD14") | 
     SCpubr::do_DotPlot(sample = sample,
                        features = "CD14",
                        font.size = 18)
p
```

```{r, fig.cap="SCpubr do_BarPlot increasing font.size.", fig.width=14, fig.height=7}
p <- SCpubr::do_BarPlot(sample = sample,
                        features = "seurat_clusters",
                        horizontal = T) | 
     SCpubr::do_BarPlot(sample = sample,
                        features = "seurat_clusters",
                        horizontal = T,
                        font.size = 18)
p
```

```{r, fig.cap="SCpubr do_TermEnrichmentPlot increasing font.size.", fig.width=24, fig.height=10}
p <- SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 2) |
     SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 2,
                                   font.size = 18)
p
```

```{r, fig.cap="SCpubr do_CellularStatesPlot increasing font.size.", fig.width=14, fig.height=7}
genes <- list("A" = Seurat::VariableFeatures(sample)[1:5],
              "B" = Seurat::VariableFeatures(sample)[6:10],
              "C" = Seurat::VariableFeatures(sample)[11:15],
              "D" = Seurat::VariableFeatures(sample)[16:20])

p <- SCpubr::do_CellularStatesPlot(sample = sample,
                                   gene_list = genes,
                                   x1 = "A",
                                   y1 = "B",
                                   x2 = "C",
                                   y2 = "D",
                                   enforce_simmetry = T) |
     SCpubr::do_CellularStatesPlot(sample = sample,
                                   gene_list = genes,
                                   x1 = "A",
                                   y1 = "B",
                                   x2 = "C",
                                   y2 = "D",
                                   enforce_simmetry = T,
                                   font.size = 18)
p
```

## Change font type of the plots.

Despite limited, it is possible to change the font type of the plots to either `sans`, `serif` or `mono`. Those are fonts installed by default in every system. Other font types need to be pre-installed in the user systems and, therefore, are not considered for this package. This can be achieved by providing `font.type = "mono"`, `font.type = "sans"` and `font.type = "serif"` to any **ggplot2-based** plot.   

```{r, fig.cap="SCpubr do_DimPlot changing font type.", fig.width=21, fig.height=7}
p <- SCpubr::do_DimPlot(sample, font.type = "mono") | 
     SCpubr::do_DimPlot(sample, font.type = "sans") | 
     SCpubr::do_DimPlot(sample, font.type = "serif")
p
```

```{r, fig.cap="SCpubr do_FeaturePlot changing font type.", fig.width=21, fig.height=7}
p <- SCpubr::do_FeaturePlot(sample = sample,
                            features = "CD14",
                            font.type = "mono") | 
     SCpubr::do_FeaturePlot(sample = sample, 
                            features = "CD14",
                            font.type = "sans") | 
     SCpubr::do_FeaturePlot(sample = sample, 
                            features = "CD14",
                            font.type = "serif")
p
```
```{r, fig.cap="SCpubr do_NebulosaPlot changing font type.", fig.width=21, fig.height=7}
p <- SCpubr::do_NebulosaPlot(sample = sample,
                             features = "CD14",
                             font.type = "mono") |
     SCpubr::do_NebulosaPlot(sample = sample,
                             features = "CD14",
                             font.type = "sans") | 
     SCpubr::do_NebulosaPlot(sample = sample,
                             features = "CD14",
                             font.type = "serif")
p
```

```{r, fig.cap="SCpubr do_BeeSwarmPlot changing font type.", fig.width=21, fig.height=7}
p <- SCpubr::do_BeeSwarmPlot(sample = sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters",
                             font.type = "mono") | 
     SCpubr::do_BeeSwarmPlot(sample = sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters",
                             font.type = "sans") |
     SCpubr::do_BeeSwarmPlot(sample = sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters",
                             font.type = "serif")
p
```


```{r, fig.cap="SCpubr do_VlnPlot changing font type.", fig.width=10, fig.height=15}
p <- SCpubr::do_VlnPlot(sample = sample,
                        features = "CD14",
                        font.type = "mono") /
     SCpubr::do_VlnPlot(sample = sample,
                        features = "CD14",
                        font.type = "sans") /
     SCpubr::do_VlnPlot(sample = sample,
                        features = "CD14",
                        font.type = "serif")
p
```

```{r, fig.cap="SCpubr do_DotPlot changing font type.", fig.width=21, fig.height=7}
p <- SCpubr::do_DotPlot(sample = sample,
                        features = "CD14",
                        font.type = "mono") | 
     SCpubr::do_DotPlot(sample = sample,
                        features = "CD14",
                        font.type = "sans") |
     SCpubr::do_DotPlot(sample = sample,
                        features = "CD14",
                        font.type = "serif")
p
```

```{r, fig.cap="SCpubr do_BarPlot changing font type.", fig.width=21, fig.height=7}
p <- SCpubr::do_BarPlot(sample = sample,
                        features = "seurat_clusters",
                        horizontal = T,
                        font.type = "mono") | 
     SCpubr::do_BarPlot(sample = sample,
                        features = "seurat_clusters",
                        horizontal = T,
                        font.type = "sans") |
     SCpubr::do_BarPlot(sample = sample,
                        features = "seurat_clusters",
                        horizontal = T,
                        font.type = "serif")
p
```

```{r, fig.cap="SCpubr do_TermEnrichmentPlot changing font type.", fig.width=36, fig.height=10}
p <- SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 2,
                                   font.type = "mono") |
     SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 2,
                                   font.type = "sans") | 
     SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 2,
                                   font.type = "serif")
p
```

```{r, fig.cap="SCpubr do_CellularStatesPlot changing font type.", fig.width=21, fig.height=7}
genes <- list("A" = Seurat::VariableFeatures(sample)[1:5],
              "B" = Seurat::VariableFeatures(sample)[6:10],
              "C" = Seurat::VariableFeatures(sample)[11:15],
              "D" = Seurat::VariableFeatures(sample)[16:20])

p <- SCpubr::do_CellularStatesPlot(sample = sample,
                                   gene_list = genes,
                                   x1 = "A",
                                   y1 = "B",
                                   x2 = "C",
                                   y2 = "D",
                                   enforce_simmetry = T,
                                   font.type = "mono") |
     SCpubr::do_CellularStatesPlot(sample = sample,
                                   gene_list = genes,
                                   x1 = "A",
                                   y1 = "B",
                                   x2 = "C",
                                   y2 = "D",
                                   enforce_simmetry = T,
                                   font.type = "sans") |
     SCpubr::do_CellularStatesPlot(sample = sample,
                                   gene_list = genes,
                                   x1 = "A",
                                   y1 = "B",
                                   x2 = "C",
                                   y2 = "D",
                                   enforce_simmetry = T,
                                   font.type = "serif")
p
```

## Adding plot titles, subtitles and captions to plots.

To all **ggplot2-based** plots, one can add title, subtitle and caption to them by using `plot.title`, `plot.subtitle` and `plot.caption` parameters.  

```{r, fig.cap="SCpubr do_DimPlot adding title, subtitle and caption.", fig.width=7, fig.height=7}
p <- SCpubr::do_DimPlot(sample, 
                        plot.title = "This is a title",
                        plot.subtitle = "This is a subtitle",
                        plot.caption = "This is a caption")
p
```

```{r, fig.cap="SCpubr do_FeaturePlot adding title, subtitle and caption.", fig.width=7, fig.height=7}
p <- SCpubr::do_FeaturePlot(sample = sample,
                            features = "CD14", 
                            plot.title = "This is a title",
                            plot.subtitle = "This is a subtitle",
                            plot.caption = "This is a caption")
p
```
```{r, fig.cap="SCpubr do_NebulosaPlot adding title, subtitle and caption.", fig.width=7, fig.height=7}
p <- SCpubr::do_NebulosaPlot(sample = sample,
                             features = "CD14", 
                             plot.title = "This is a title",
                             plot.subtitle = "This is a subtitle",
                             plot.caption = "This is a caption")
p
```

```{r, fig.cap="SCpubr do_BeeSwarmPlot adding title, subtitle and caption.", fig.width=7, fig.height=7}
p <- SCpubr::do_BeeSwarmPlot(sample = sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters", 
                             plot.title = "This is a title",
                             plot.subtitle = "This is a subtitle",
                             plot.caption = "This is a caption")
p
```


```{r, fig.cap="SCpubr do_VlnPlot adding title, subtitle and caption.", fig.width=10, fig.height=5}
p <- SCpubr::do_VlnPlot(sample = sample,
                        features = "CD14", 
                        plot.title = "This is a title",
                        plot.subtitle = "This is a subtitle",
                        plot.caption = "This is a caption")
p
```

```{r, fig.cap="SCpubr do_DotPlot adding title, subtitle and caption.", fig.width=7, fig.height=7}
p <- SCpubr::do_DotPlot(sample = sample,
                        features = "CD14", 
                        plot.title = "This is a title",
                        plot.subtitle = "This is a subtitle",
                        plot.caption = "This is a caption")
p
```

```{r, fig.cap="SCpubr do_BarPlot adding title, subtitle and caption.", fig.width=7, fig.height=7}
p <- SCpubr::do_BarPlot(sample = sample,
                        features = "seurat_clusters",
                        horizontal = T, 
                        plot.title = "This is a title",
                        plot.subtitle = "This is a subtitle",
                        plot.caption = "This is a caption")
p
```

```{r, fig.cap="SCpubr do_TermEnrichmentPlot adding title, subtitle and caption.", fig.width=12, fig.height=10}
p <- SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 2, 
                                   plot.title = "This is a title",
                                   plot.subtitle = "This is a subtitle",
                                   plot.caption = "This is a caption")
p
```

```{r, fig.cap="SCpubr do_CellularStatesPlot adding title, subtitle and caption.", fig.width=7, fig.height=7}
genes <- list("A" = Seurat::VariableFeatures(sample)[1:5],
              "B" = Seurat::VariableFeatures(sample)[6:10],
              "C" = Seurat::VariableFeatures(sample)[11:15],
              "D" = Seurat::VariableFeatures(sample)[16:20])

p <- SCpubr::do_CellularStatesPlot(sample = sample,
                                   gene_list = genes,
                                   x1 = "A",
                                   y1 = "B",
                                   x2 = "C",
                                   y2 = "D",
                                   enforce_simmetry = T,
                                   plot.title = "This is a title",
                                   plot.subtitle = "This is a subtitle",
                                   plot.caption = "This is a caption")
p
```

### Further customization 

Titles, subtitles and captions are modified versions of `ggplot2::element_text()`, using [ggtext](https://github.com/wilkelab/ggtext) package. This allows for partial modifications, in markdown style, of the elements. You can also change the color by providing **HTML tags** as follows:

```{r, fig.cap="SCpubr do_DimPlot adding title, subtitle and caption with extra modifications.", fig.width=7, fig.height=7}
p <- SCpubr::do_DimPlot(sample, 
                        plot.title = "<span style = 'color:#87191c;'>This</span><span style = 'color:#243a76;'> is a </span><span style = 'color:#096837;'>colored title</span>",
                        plot.subtitle = "This is a *subtitle*",
                        plot.caption = "This is a **caption**")
p
```

## Change between legend types in continuous variables.

Users can opt to change between three type of legends **continuous** variables: the one that comes by default with `ggplot2`, a colorbar that is a modified version of the default, with a wider range and more marked ticks, or a colorbar with discrete steps (colorsteps), which can be a nice alternative depending on the situation. This can be achieved by providing `legend.type = "normal"`, `legend.type = "colorbar"` or `legend.type = "colorsteps"`. This can be applied to any **ggplot2-based** plot.


```{r, fig.cap="SCpubr do_FeaturePlot changing font type.", fig.width=21, fig.height=7}
p <- SCpubr::do_FeaturePlot(sample = sample,
                            features = "PC_1",
                            legend.type = "normal") | 
     SCpubr::do_FeaturePlot(sample = sample, 
                            features = "PC_1",
                            legend.type = "colorbar") | 
     SCpubr::do_FeaturePlot(sample = sample, 
                            features = "PC_1",
                            legend.type = "colorsteps")
p
```

```{r, fig.cap="SCpubr do_NebulosaPlot changing font type.", fig.width=21, fig.height=7}
p <- SCpubr::do_NebulosaPlot(sample = sample,
                             features = "PC_1",
                             legend.type = "normal") |
     SCpubr::do_NebulosaPlot(sample = sample,
                             features = "PC_1",
                             legend.type = "colorbar") | 
     SCpubr::do_NebulosaPlot(sample = sample,
                             features = "PC_1",
                             legend.type = "colorsteps")
p
```

```{r, fig.cap="SCpubr do_BeeSwarmPlot changing font type.", fig.width=21, fig.height=7}
p <- SCpubr::do_BeeSwarmPlot(sample = sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters",
                             continuous_feature = T,
                             legend.type = "normal") | 
     SCpubr::do_BeeSwarmPlot(sample = sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters",
                             continuous_feature = T,
                             legend.type = "colorbar") |
     SCpubr::do_BeeSwarmPlot(sample = sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters",
                             continuous_feature = T,
                             legend.type = "colorsteps")
p
```


```{r, fig.cap="SCpubr do_DotPlot changing font type.", fig.width=21, fig.height=7}
p <- SCpubr::do_DotPlot(sample = sample,
                        features = "PC_1",
                        legend.type = "normal") | 
     SCpubr::do_DotPlot(sample = sample,
                        features = "PC_1",
                        legend.type = "colorbar") |
     SCpubr::do_DotPlot(sample = sample,
                        features = "PC_1",
                        legend.type = "colorsteps")
p
```


```{r, fig.cap="SCpubr do_TermEnrichmentPlot changing font type.", fig.width=21, fig.height=7}
p <- SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 2,
                                   legend.type = "normal") |
     SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 2,
                                   legend.type = "colorbar") | 
     SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 2,
                                   legend.type = "colorsteps")
p
```

## Relocating the legend

## Modifying colors

### Categorical variables

### Continuous variables
