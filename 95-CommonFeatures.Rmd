# Common features across plots {-}

```{r echo = F}
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
```

This page aims to assess common functionalities present across the different functions in the package.

## Changing the font size. {-}
This can be achieved by using `font.size` parameter and works for all **ggplot2-based** plots.

```{r, fig.cap="SCpubr do_DimPlot increasing font.size.", fig.width=14, fig.height=7}
p <- SCpubr::do_DimPlot(sample) | 
     SCpubr::do_DimPlot(sample, 
                        font.size = 18)
p
```

```{r, fig.cap="SCpubr do_FeaturePlot increasing font.size.", fig.width=14, fig.height=7}
p <- SCpubr::do_FeaturePlot(sample = sample,
                            features = "CD14") | 
     SCpubr::do_FeaturePlot(sample = sample, 
                            features = "CD14",
                            font.size = 18)
p
```
```{r, fig.cap="SCpubr do_NebulosaPlot increasing font.size.", fig.width=14, fig.height=7}
p <- SCpubr::do_NebulosaPlot(sample = sample,
                             features = "CD14") |
     SCpubr::do_NebulosaPlot(sample = sample,
                             features = "CD14",
                             font.size = 18)
p
```

```{r, fig.cap="SCpubr do_BeeSwarmPlot increasing font.size.", fig.width=14, fig.height=7}
p <- SCpubr::do_BeeSwarmPlot(sample = sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters") | 
     SCpubr::do_BeeSwarmPlot(sample = sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters",
                             font.size = 18)
p
```


```{r, fig.cap="SCpubr do_VlnPlot increasing font.size.", fig.width=10, fig.height=8}
p <- SCpubr::do_VlnPlot(sample = sample,
                        features = "CD14") /
     SCpubr::do_VlnPlot(sample = sample,
                        features = "CD14",
                        font.size = 18)
p
```

```{r, fig.cap="SCpubr do_DotPlot increasing font.size.", fig.width=14, fig.height=7}
genes <- c("IL7R", "CCR7", "CD14", "LYZ", 
           "S100A4", "MS4A1", "CD8A", "FCGR3A", 
           "MS4A7", "GNLY", "NKG7", "FCER1A", 
           "CST3", "PPBP")
p <- SCpubr::do_DotPlot(sample = sample,
                        features = genes) | 
     SCpubr::do_DotPlot(sample = sample,
                        features = genes,
                        font.size = 18)
p
```

```{r, fig.cap="SCpubr do_BarPlot increasing font.size.", fig.width=14, fig.height=7}
p <- SCpubr::do_BarPlot(sample = sample,
                        features = "seurat_clusters",
                        horizontal = T) | 
     SCpubr::do_BarPlot(sample = sample,
                        features = "seurat_clusters",
                        horizontal = T,
                        font.size = 18)
p
```

```{r, fig.cap="SCpubr do_TermEnrichmentPlot increasing font.size.", fig.width=24, fig.height=10}
p <- SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 2) |
     SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 2,
                                   font.size = 18)
p
```

```{r, fig.cap="SCpubr do_CellularStatesPlot increasing font.size.", fig.width=14, fig.height=7}
genes <- list("A" = Seurat::VariableFeatures(sample)[1:5],
              "B" = Seurat::VariableFeatures(sample)[6:10],
              "C" = Seurat::VariableFeatures(sample)[11:15],
              "D" = Seurat::VariableFeatures(sample)[16:20])

p <- SCpubr::do_CellularStatesPlot(sample = sample,
                                   gene_list = genes,
                                   x1 = "A",
                                   y1 = "B",
                                   x2 = "C",
                                   y2 = "D",
                                   enforce_simmetry = T) |
     SCpubr::do_CellularStatesPlot(sample = sample,
                                   gene_list = genes,
                                   x1 = "A",
                                   y1 = "B",
                                   x2 = "C",
                                   y2 = "D",
                                   enforce_simmetry = T,
                                   font.size = 18)
p
```

## Change font type of the plots. {-}

Despite limited, it is possible to change the font type of the plots to either `sans`, `serif` or `mono`. Those are fonts installed by default in every system. Other font types need to be pre-installed in the user systems and, therefore, are not considered for this package. This can be achieved by providing `font.type = "mono"`, `font.type = "sans"` and `font.type = "serif"` to any **ggplot2-based** plot.   

```{r, fig.cap="SCpubr do_DimPlot changing font type.", fig.width=21, fig.height=7}
p <- SCpubr::do_DimPlot(sample, font.type = "mono") | 
     SCpubr::do_DimPlot(sample, font.type = "sans") | 
     SCpubr::do_DimPlot(sample, font.type = "serif")
p
```

```{r, fig.cap="SCpubr do_FeaturePlot changing font type.", fig.width=21, fig.height=7}
p <- SCpubr::do_FeaturePlot(sample = sample,
                            features = "CD14",
                            font.type = "mono") | 
     SCpubr::do_FeaturePlot(sample = sample, 
                            features = "CD14",
                            font.type = "sans") | 
     SCpubr::do_FeaturePlot(sample = sample, 
                            features = "CD14",
                            font.type = "serif")
p
```
```{r, fig.cap="SCpubr do_NebulosaPlot changing font type.", fig.width=21, fig.height=7}
p <- SCpubr::do_NebulosaPlot(sample = sample,
                             features = "CD14",
                             font.type = "mono") |
     SCpubr::do_NebulosaPlot(sample = sample,
                             features = "CD14",
                             font.type = "sans") | 
     SCpubr::do_NebulosaPlot(sample = sample,
                             features = "CD14",
                             font.type = "serif")
p
```

```{r, fig.cap="SCpubr do_BeeSwarmPlot changing font type.", fig.width=21, fig.height=7}
p <- SCpubr::do_BeeSwarmPlot(sample = sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters",
                             font.type = "mono") | 
     SCpubr::do_BeeSwarmPlot(sample = sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters",
                             font.type = "sans") |
     SCpubr::do_BeeSwarmPlot(sample = sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters",
                             font.type = "serif")
p
```


```{r, fig.cap="SCpubr do_VlnPlot changing font type.", fig.width=10, fig.height=15}
p <- SCpubr::do_VlnPlot(sample = sample,
                        features = "CD14",
                        font.type = "mono") /
     SCpubr::do_VlnPlot(sample = sample,
                        features = "CD14",
                        font.type = "sans") /
     SCpubr::do_VlnPlot(sample = sample,
                        features = "CD14",
                        font.type = "serif")
p
```

```{r, fig.cap="SCpubr do_DotPlot changing font type.", fig.width=21, fig.height=7}
genes <- c("IL7R", "CCR7", "CD14", "LYZ", 
           "S100A4", "MS4A1", "CD8A", "FCGR3A", 
           "MS4A7", "GNLY", "NKG7", "FCER1A", 
           "CST3", "PPBP")

p <- SCpubr::do_DotPlot(sample = sample,
                        features = genes,
                        font.type = "mono") | 
     SCpubr::do_DotPlot(sample = sample,
                        features = genes,
                        font.type = "sans") |
     SCpubr::do_DotPlot(sample = sample,
                        features = genes,
                        font.type = "serif")
p
```

```{r, fig.cap="SCpubr do_BarPlot changing font type.", fig.width=21, fig.height=7}
p <- SCpubr::do_BarPlot(sample = sample,
                        features = "seurat_clusters",
                        horizontal = T,
                        font.type = "mono") | 
     SCpubr::do_BarPlot(sample = sample,
                        features = "seurat_clusters",
                        horizontal = T,
                        font.type = "sans") |
     SCpubr::do_BarPlot(sample = sample,
                        features = "seurat_clusters",
                        horizontal = T,
                        font.type = "serif")
p
```

```{r, fig.cap="SCpubr do_TermEnrichmentPlot changing font type.", fig.width=36, fig.height=10}
p <- SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 2,
                                   font.type = "mono") |
     SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 2,
                                   font.type = "sans") | 
     SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 2,
                                   font.type = "serif")
p
```

```{r, fig.cap="SCpubr do_CellularStatesPlot changing font type.", fig.width=21, fig.height=7}
genes <- list("A" = Seurat::VariableFeatures(sample)[1:5],
              "B" = Seurat::VariableFeatures(sample)[6:10],
              "C" = Seurat::VariableFeatures(sample)[11:15],
              "D" = Seurat::VariableFeatures(sample)[16:20])

p <- SCpubr::do_CellularStatesPlot(sample = sample,
                                   gene_list = genes,
                                   x1 = "A",
                                   y1 = "B",
                                   x2 = "C",
                                   y2 = "D",
                                   enforce_simmetry = T,
                                   font.type = "mono") |
     SCpubr::do_CellularStatesPlot(sample = sample,
                                   gene_list = genes,
                                   x1 = "A",
                                   y1 = "B",
                                   x2 = "C",
                                   y2 = "D",
                                   enforce_simmetry = T,
                                   font.type = "sans") |
     SCpubr::do_CellularStatesPlot(sample = sample,
                                   gene_list = genes,
                                   x1 = "A",
                                   y1 = "B",
                                   x2 = "C",
                                   y2 = "D",
                                   enforce_simmetry = T,
                                   font.type = "serif")
p
```

## Adding plot titles, subtitles and captions to plots. {-}

To all **ggplot2-based** plots, one can add title, subtitle and caption to them by using `plot.title`, `plot.subtitle` and `plot.caption` parameters.  

```{r, fig.cap="SCpubr do_DimPlot adding title, subtitle and caption.", fig.width=7, fig.height=7}
p <- SCpubr::do_DimPlot(sample, 
                        plot.title = "This is a title",
                        plot.subtitle = "This is a subtitle",
                        plot.caption = "This is a caption")
p
```

```{r, fig.cap="SCpubr do_FeaturePlot adding title, subtitle and caption.", fig.width=7, fig.height=7}
p <- SCpubr::do_FeaturePlot(sample = sample,
                            features = "CD14", 
                            plot.title = "This is a title",
                            plot.subtitle = "This is a subtitle",
                            plot.caption = "This is a caption")
p
```
```{r, fig.cap="SCpubr do_NebulosaPlot adding title, subtitle and caption.", fig.width=7, fig.height=7}
p <- SCpubr::do_NebulosaPlot(sample = sample,
                             features = "CD14", 
                             plot.title = "This is a title",
                             plot.subtitle = "This is a subtitle",
                             plot.caption = "This is a caption")
p
```

```{r, fig.cap="SCpubr do_BeeSwarmPlot adding title, subtitle and caption.", fig.width=7, fig.height=7}
p <- SCpubr::do_BeeSwarmPlot(sample = sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters", 
                             plot.title = "This is a title",
                             plot.subtitle = "This is a subtitle",
                             plot.caption = "This is a caption")
p
```


```{r, fig.cap="SCpubr do_VlnPlot adding title, subtitle and caption.", fig.width=10, fig.height=5}
p <- SCpubr::do_VlnPlot(sample = sample,
                        features = "CD14", 
                        plot.title = "This is a title",
                        plot.subtitle = "This is a subtitle",
                        plot.caption = "This is a caption")
p
```

```{r, fig.cap="SCpubr do_DotPlot adding title, subtitle and caption.", fig.width=7, fig.height=7}
genes <- c("IL7R", "CCR7", "CD14", "LYZ", 
           "S100A4", "MS4A1", "CD8A", "FCGR3A", 
           "MS4A7", "GNLY", "NKG7", "FCER1A", 
           "CST3", "PPBP")

p <- SCpubr::do_DotPlot(sample = sample,
                        features = genes, 
                        plot.title = "This is a title",
                        plot.subtitle = "This is a subtitle",
                        plot.caption = "This is a caption")
p
```

```{r, fig.cap="SCpubr do_BarPlot adding title, subtitle and caption.", fig.width=7, fig.height=7}
p <- SCpubr::do_BarPlot(sample = sample,
                        features = "seurat_clusters",
                        horizontal = T, 
                        plot.title = "This is a title",
                        plot.subtitle = "This is a subtitle",
                        plot.caption = "This is a caption")
p
```

```{r, fig.cap="SCpubr do_TermEnrichmentPlot adding title, subtitle and caption.", fig.width=12, fig.height=10}
p <- SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 2, 
                                   plot.title = "This is a title",
                                   plot.subtitle = "This is a subtitle",
                                   plot.caption = "This is a caption")
p
```

```{r, fig.cap="SCpubr do_CellularStatesPlot adding title, subtitle and caption.", fig.width=7, fig.height=7}
genes <- list("A" = Seurat::VariableFeatures(sample)[1:5],
              "B" = Seurat::VariableFeatures(sample)[6:10],
              "C" = Seurat::VariableFeatures(sample)[11:15],
              "D" = Seurat::VariableFeatures(sample)[16:20])

p <- SCpubr::do_CellularStatesPlot(sample = sample,
                                   gene_list = genes,
                                   x1 = "A",
                                   y1 = "B",
                                   x2 = "C",
                                   y2 = "D",
                                   enforce_simmetry = T,
                                   plot.title = "This is a title",
                                   plot.subtitle = "This is a subtitle",
                                   plot.caption = "This is a caption")
p
```

### Further customization  {-}

Titles, subtitles and captions are modified versions of `ggplot2::element_text()`, using [ggtext](https://github.com/wilkelab/ggtext) package. This allows for partial modifications, in markdown style, of the elements. You can also change the color by providing **HTML tags** as follows:

```{r, fig.cap="SCpubr do_DimPlot adding title, subtitle and caption with extra modifications.", fig.width=7, fig.height=7}
p <- SCpubr::do_DimPlot(sample, 
                        plot.title = "<span style = 'color:#87191c;'>This</span><span style = 'color:#243a76;'> is a </span><span style = 'color:#096837;'>colored title</span>",
                        plot.subtitle = "This is a *subtitle*",
                        plot.caption = "This is a **caption**")
p
```

## Change between legend types in continuous variables. {-}

Users can opt to change between three type of legends **continuous** variables: the one that comes by default with `ggplot2`, a colorbar that is a modified version of the default, with a wider range and more marked ticks, or a colorbar with discrete steps (colorsteps), which can be a nice alternative depending on the situation. This can be achieved by providing `legend.type = "normal"`, `legend.type = "colorbar"` or `legend.type = "colorsteps"`. This can be applied to any **ggplot2-based** plot.


```{r, fig.cap="SCpubr do_FeaturePlot changing legend type.", fig.width=21, fig.height=7}
p <- SCpubr::do_FeaturePlot(sample = sample,
                            features = "PC_1",
                            legend.type = "normal") | 
     SCpubr::do_FeaturePlot(sample = sample, 
                            features = "PC_1",
                            legend.type = "colorbar") | 
     SCpubr::do_FeaturePlot(sample = sample, 
                            features = "PC_1",
                            legend.type = "colorsteps")
p
```

```{r, fig.cap="SCpubr do_NebulosaPlot changing legend type.", fig.width=21, fig.height=7}
p <- SCpubr::do_NebulosaPlot(sample = sample,
                             features = "PC_1",
                             legend.type = "normal") |
     SCpubr::do_NebulosaPlot(sample = sample,
                             features = "PC_1",
                             legend.type = "colorbar") | 
     SCpubr::do_NebulosaPlot(sample = sample,
                             features = "PC_1",
                             legend.type = "colorsteps")
p
```

```{r, fig.cap="SCpubr do_BeeSwarmPlot changing legend type.", fig.width=21, fig.height=7}
p <- SCpubr::do_BeeSwarmPlot(sample = sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters",
                             continuous_feature = T,
                             legend.type = "normal") | 
     SCpubr::do_BeeSwarmPlot(sample = sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters",
                             continuous_feature = T,
                             legend.type = "colorbar") |
     SCpubr::do_BeeSwarmPlot(sample = sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters",
                             continuous_feature = T,
                             legend.type = "colorsteps")
p
```


```{r, fig.cap="SCpubr do_DotPlot changing legend type.", fig.width=21, fig.height=7}
genes <- c("IL7R", "CCR7", "CD14", "LYZ", 
           "S100A4", "MS4A1", "CD8A", "FCGR3A", 
           "MS4A7", "GNLY", "NKG7", "FCER1A", 
           "CST3", "PPBP")

p <- SCpubr::do_DotPlot(sample = sample,
                        features = "PC_1",
                        legend.type = "normal") | 
     SCpubr::do_DotPlot(sample = sample,
                        features = "PC_1",
                        legend.type = "colorbar") |
     SCpubr::do_DotPlot(sample = sample,
                        features = "PC_1",
                        legend.type = "colorsteps")
p
```


```{r, fig.cap="SCpubr do_TermEnrichmentPlot changing legend type.", fig.width=21, fig.height=7}
p <- SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 2,
                                   legend.type = "normal") |
     SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 2,
                                   legend.type = "colorbar") | 
     SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 2,
                                   legend.type = "colorsteps")
p
```

## Relocating the legend {-}
Legends can be switched to any of the following positions: top, bottom, left and right. Depending on the set ups of the figure, one location might be more suitable than another. By default, `SCpubr` locates them either right or bottom, but this can be changed anytime by using `legend.position = "top"`, `legend.position = "bottom"`, `legend.position = "left"` or `legend.position = "right"`. This only works in **ggplot2-based** plots.

```{r, fig.cap="SCpubr do_DimPlot with varying legend positions.", fig.width=14, fig.height=14}
p <- (SCpubr::do_DimPlot(sample, 
                         legend.position = "top") | 
      SCpubr::do_DimPlot(sample, 
                         legend.position = "bottom")) /
     (SCpubr::do_DimPlot(sample, 
                         legend.position = "left") |
      SCpubr::do_DimPlot(sample, 
                         legend.position = "right"))
p
```


```{r, fig.cap="SCpubr do_FeaturePlot with varying legend positions.", fig.width=14, fig.height=14}
p <- (SCpubr::do_FeaturePlot(sample, 
                             features = "PC_1", 
                             legend.position = "top") | 
      SCpubr::do_FeaturePlot(sample, 
                             features = "PC_1", 
                             legend.position = "bottom")) /
     (SCpubr::do_FeaturePlot(sample, 
                             features = "PC_1", 
                             legend.position = "left") |
      SCpubr::do_FeaturePlot(sample, 
                             features = "PC_1", 
                             legend.position = "right"))
p
```

```{r, fig.cap="SCpubr do_NebulosaPlot with varying legend positions.", fig.width=14, fig.height=14}
p <- (SCpubr::do_NebulosaPlot(sample, 
                              features = "PC_1", 
                              legend.position = "top") | 
      SCpubr::do_NebulosaPlot(sample, 
                              features = "PC_1", 
                              legend.position = "bottom")) /
     (SCpubr::do_NebulosaPlot(sample, 
                              features = "PC_1", 
                              legend.position = "left") |
      SCpubr::do_NebulosaPlot(sample, 
                              features = "PC_1", 
                              legend.position = "right"))
p
```

```{r, fig.cap="SCpubr do_BeeSwarmPlot with varying legend positions.", fig.width=14, fig.height=14}
p <- (SCpubr::do_BeeSwarmPlot(sample,
                              feature_to_rank = "PC_1", 
                              group.by = "seurat_clusters",
                              continuous_feature = TRUE,
                              legend.position = "top") | 
      SCpubr::do_BeeSwarmPlot(sample,
                              feature_to_rank = "PC_1", 
                              group.by = "seurat_clusters",
                              continuous_feature = TRUE, 
                              legend.position = "bottom")) /
     (SCpubr::do_BeeSwarmPlot(sample,
                              feature_to_rank = "PC_1", 
                              group.by = "seurat_clusters",
                              continuous_feature = TRUE, 
                              legend.position = "left") |
      SCpubr::do_BeeSwarmPlot(sample,
                              feature_to_rank = "PC_1", 
                              group.by = "seurat_clusters",
                              continuous_feature = TRUE, 
                              legend.position = "right"))
p
```

```{r, fig.cap="SCpubr do_DotPlot with varying legend positions.", fig.width=14, fig.height=14}
genes <- c("IL7R", "CCR7", "CD14", "LYZ", 
           "S100A4", "MS4A1", "CD8A", "FCGR3A", 
           "MS4A7", "GNLY", "NKG7", "FCER1A", 
           "CST3", "PPBP")

p <- (SCpubr::do_DotPlot(sample,
                         features = genes, 
                         legend.position = "top") |
      SCpubr::do_DotPlot(sample,
                         features = genes, 
                         legend.position = "bottom")) /
     (SCpubr::do_DotPlot(sample,
                         features = genes, 
                         legend.position = "left") |
      SCpubr::do_DotPlot(sample,
                         features = genes, 
                         legend.position = "right"))
p
```

```{r, fig.cap="SCpubr do_BarPlot with varying legend positions.", fig.width=14, fig.height=14}
p <- (SCpubr::do_BarPlot(sample,
                         features = "seurat_clusters", 
                         legend.position = "top") |
      SCpubr::do_BarPlot(sample,
                         features = "seurat_clusters", 
                         legend.position = "bottom")) /
     (SCpubr::do_BarPlot(sample,
                         features = "seurat_clusters", 
                         legend.position = "left") |
      SCpubr::do_BarPlot(sample,
                         features = "seurat_clusters", 
                         legend.position = "right"))
p
```
```{r, fig.cap="SCpubr do_TermEnrichmentPlot with varying legend positions.", fig.width=28, fig.height=28}
p <- (SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                    dbs_use = "GO_Biological_Process_2021",
                                    nterms = 2,
                                    legend.position = "top") |
      SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                    dbs_use = "GO_Biological_Process_2021",
                                    nterms = 2,
                                    legend.position = "bottom")) / 
     (SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                    dbs_use = "GO_Biological_Process_2021",
                                    nterms = 2,
                                    legend.position = "left") |
      SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                    dbs_use = "GO_Biological_Process_2021",
                                    nterms = 2,
                                    legend.position = "right"))
p
```


```{r, fig.cap="SCpubr do_CellularStatesPlot with varying legend positions.", fig.width=14, fig.height=14}
genes <- list("A" = Seurat::VariableFeatures(sample)[1:5],
              "B" = Seurat::VariableFeatures(sample)[6:10],
              "C" = Seurat::VariableFeatures(sample)[11:15],
              "D" = Seurat::VariableFeatures(sample)[16:20])

p <- (SCpubr::do_CellularStatesPlot(sample = sample,
                                    gene_list = genes,
                                    x1 = "A",
                                    y1 = "B",
                                    x2 = "C",
                                    y2 = "D",
                                    enforce_simmetry = T,
                                    legend.position = "top") |
      SCpubr::do_CellularStatesPlot(sample = sample,
                                    gene_list = genes,
                                    x1 = "A",
                                    y1 = "B",
                                    x2 = "C",
                                    y2 = "D",
                                    enforce_simmetry = T,
                                    legend.position = "bottom")) /
     (SCpubr::do_CellularStatesPlot(sample = sample,
                                    gene_list = genes,
                                    x1 = "A",
                                    y1 = "B",
                                    x2 = "C",
                                    y2 = "D",
                                    enforce_simmetry = T,
                                    legend.position = "left") |
      SCpubr::do_CellularStatesPlot(sample = sample,
                                    gene_list = genes,
                                    x1 = "A",
                                    y1 = "B",
                                    x2 = "C",
                                    y2 = "D",
                                    enforce_simmetry = T,
                                    legend.position = "right"))
   
p
```
## Modifying colors {-}
Perhaps, one of the most critical parameters, the possibility to change the colors displayed up to the user's wish. This is mainly achieved by `colors.use` in any plot making use of categorical variables and the plots using continuous variables but not implementing a **viridis** color scale. For those cases, `viridis_color_map` is used. 

### Categorical variables {-}

For plots using categorical variables, colors can be modified using `colors.use` and a vector of named colors. The names have to match the unique values being displayed on the plot and the colors need to be proper color representations or HEX codes.

```{r}
# Create a color scale for the unique values in seurat clusters.
colors <- c("0" = "#001219",
            "1" = "#005f73",
            "2" = "#0a9396",
            "3" = "#94d2bd",
            "4" = "#e9d8a6",
            "5" = "#ee9b00",
            "6" = "#ca6702",
            "7" = "#bb3e03",
            "8" = "#ae2012",
            "9" = "#9b2226")
```

```{r, fig.cap="SCpubr do_DimPlot modifying colors.", fig.width=14, fig.height=7}
p <- SCpubr::do_DimPlot(sample) | 
     SCpubr::do_DimPlot(sample, 
                        colors.use = colors)
p
```
```{r, fig.cap="SCpubr do_BeeSwarmPlot modifying colors.", fig.width=14, fig.height=7}
p <- SCpubr::do_BeeSwarmPlot(sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters") | 
     SCpubr::do_BeeSwarmPlot(sample,
                             feature_to_rank = "PC_1",
                             group.by = "seurat_clusters",
                             colors.use = colors)
p
```
```{r, fig.cap="SCpubr do_VlnPlot modifying colors.", fig.width=12, fig.height=10}
p <- SCpubr::do_VlnPlot(sample,
                        features = "PC_1") /
     SCpubr::do_VlnPlot(sample, 
                        features = "PC_1",
                        colors.use = colors)
p
```
```{r, fig.cap="SCpubr do_BarPlot modifying colors.", fig.width=14, fig.height=7}
p <- SCpubr::do_BarPlot(sample,
                        features = "seurat_clusters",
                        horizontal = T) |
     SCpubr::do_BarPlot(sample, 
                        features = "seurat_clusters",
                        horizontal = T,
                        colors.use = colors)
p
```

```{r, fig.cap="SCpubr::do_CellularStatesPlot modifying colors.", fig.width=14, fig.height=7}
genes <- list("A" = Seurat::VariableFeatures(sample)[1:5],
              "B" = Seurat::VariableFeatures(sample)[6:10],
              "C" = Seurat::VariableFeatures(sample)[11:15],
              "D" = Seurat::VariableFeatures(sample)[16:20])

p <- SCpubr::do_CellularStatesPlot(sample = sample,
                                   gene_list = genes,
                                   x1 = "A",
                                   y1 = "B",
                                   x2 = "C",
                                   y2 = "D",
                                   enforce_simmetry = T) |
     SCpubr::do_CellularStatesPlot(sample = sample,
                                   gene_list = genes,
                                   x1 = "A",
                                   y1 = "B",
                                   x2 = "C",
                                   y2 = "D",
                                   enforce_simmetry = T,
                                   colors.use = colors)
p
```


### Continuous variables {-}

As explained above, modifying the color scales in the plots highly depends on whether the color scale is based on **viridis** or not. 

#### Viridis-based plots {-}

For viridis-based plots, the scale can be changed according to the **different available color maps** in the [viridis package](https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html). Options are:

- A - magma color map.
- B - inferno color map.
- C - plasma color map.
- D - viridis color map.
- E - cividis color map.
- F - rocket color map.
- G - mako color map.
- H - turbo  color map.

To change the color map, just provide either the **letter** or the **name** of the color map to `viridis_color_map`.

```{r, fig.cap = "SCpubr::do_FeaturePlot modifying viridis color maps.", fig.width=10, fig.height=20}
p1 <- SCpubr::do_FeaturePlot(sample = sample, 
                             features = "CD14", 
                             viridis_color_map = "A", 
                             plot.title = "Magma")

p2 <- SCpubr::do_FeaturePlot(sample = sample, 
                             features = "CD14", 
                             viridis_color_map = "B", 
                             plot.title = "Inferno")

p3 <- SCpubr::do_FeaturePlot(sample = sample, 
                             features = "CD14", 
                             viridis_color_map = "C", 
                             plot.title = "Plasma")

p4 <- SCpubr::do_FeaturePlot(sample = sample, 
                             features = "CD14", 
                             viridis_color_map = "D", 
                             plot.title = "Viridis")

p5 <- SCpubr::do_FeaturePlot(sample = sample, 
                             features = "CD14", 
                             viridis_color_map = "E", 
                             plot.title = "Cividis")

p6 <- SCpubr::do_FeaturePlot(sample = sample, 
                             features = "CD14", 
                             viridis_color_map = "F", 
                             plot.title = "Rocket")

p7 <- SCpubr::do_FeaturePlot(sample = sample, 
                             features = "CD14", 
                             viridis_color_map = "G", 
                             plot.title = "Mako")

p8 <- SCpubr::do_FeaturePlot(sample = sample, 
                             features = "CD14", 
                             viridis_color_map = "H", 
                             plot.title = "Turbo")

p <- patchwork::wrap_plots(list(p1, p2, p3, p4, p5, p6, p7, p8), ncol = 2, byrow = TRUE)
p
```

```{r, fig.cap = "SCpubr Nebulosa plot modifying viridis color maps.", fig.width=10, fig.height=20}
p1 <- SCpubr::do_NebulosaPlot(sample = sample, 
                              features = "CD14", 
                              viridis_color_map = "A", 
                              plot.title = "Magma")

p2 <- SCpubr::do_NebulosaPlot(sample = sample, 
                              features = "CD14", 
                              viridis_color_map = "B", 
                              plot.title = "Inferno")

p3 <- SCpubr::do_NebulosaPlot(sample = sample, 
                              features = "CD14", 
                              viridis_color_map = "C", 
                              plot.title = "Plasma")

p4 <- SCpubr::do_NebulosaPlot(sample = sample, 
                              features = "CD14", 
                              viridis_color_map = "D", 
                              plot.title = "Viridis")

p5 <- SCpubr::do_NebulosaPlot(sample = sample, 
                              features = "CD14", 
                              viridis_color_map = "E", 
                              plot.title = "Cividis")

p6 <- SCpubr::do_NebulosaPlot(sample = sample, 
                              features = "CD14", 
                              viridis_color_map = "F", 
                              plot.title = "Rocket")

p7 <- SCpubr::do_NebulosaPlot(sample = sample, 
                              features = "CD14", 
                              viridis_color_map = "G", 
                              plot.title = "Mako")

p8 <- SCpubr::do_NebulosaPlot(sample = sample, 
                              features = "CD14", 
                              viridis_color_map = "H", 
                              plot.title = "Turbo")


p <- patchwork::wrap_plots(list(p1, p2, p3, p4, p5, p6, p7, p8), ncol = 2, byrow = TRUE)
p
```

```{r, fig.cap = "SCpubr::do_BeeSwarmPlot modifying viridis color maps.", fig.width=10, fig.height=20}
p1 <- SCpubr::do_BeeSwarmPlot(sample = sample, 
                              feature_to_rank = "PC_1", 
                              group.by = "seurat_clusters", 
                              continuous_feature = TRUE, 
                              viridis_color_map = "A", 
                              plot.title = "Magma")

p2 <- SCpubr::do_BeeSwarmPlot(sample = sample, 
                              feature_to_rank = "PC_1", 
                              group.by = "seurat_clusters", 
                              continuous_feature = TRUE, 
                              viridis_color_map = "B", 
                              plot.title = "Inferno")

p3 <- SCpubr::do_BeeSwarmPlot(sample = sample, 
                              feature_to_rank = "PC_1", 
                              group.by = "seurat_clusters", 
                              continuous_feature = TRUE, 
                              viridis_color_map = "C", 
                              plot.title = "Plasma")

p4 <- SCpubr::do_BeeSwarmPlot(sample = sample, 
                              feature_to_rank = "PC_1", 
                              group.by = "seurat_clusters", 
                              continuous_feature = TRUE, 
                              viridis_color_map = "D", 
                              plot.title = "Viridis")

p5 <- SCpubr::do_BeeSwarmPlot(sample = sample, 
                              feature_to_rank = "PC_1", 
                              group.by = "seurat_clusters", 
                              continuous_feature = TRUE, 
                              viridis_color_map = "E", 
                              plot.title = "Cividis")

p6 <- SCpubr::do_BeeSwarmPlot(sample = sample, 
                              feature_to_rank = "PC_1", 
                              group.by = "seurat_clusters", 
                              continuous_feature = TRUE, 
                              viridis_color_map = "F", 
                              plot.title = "Rocket")

p7 <- SCpubr::do_BeeSwarmPlot(sample = sample, 
                              feature_to_rank = "PC_1", 
                              group.by = "seurat_clusters", 
                              continuous_feature = TRUE, 
                              viridis_color_map = "G", 
                              plot.title = "Mako")

p8 <- SCpubr::do_BeeSwarmPlot(sample = sample, 
                              feature_to_rank = "PC_1", 
                              group.by = "seurat_clusters", 
                              continuous_feature = TRUE, 
                              viridis_color_map = "H", 
                              plot.title = "Turbo")

p <- patchwork::wrap_plots(list(p1, p2, p3, p4, p5, p6, p7, p8), ncol = 2, byrow = TRUE)
p
```
#### 2 color gradient plots {-}

The rest of plots that do present a continuous color scale, normally define the gradient based on a combination of pair of colors provided by the user to `colors.use`. This pair of colors do not need to be named, but they do need to be **valid colors** or **HEX codes**.

```{r, fig.cap="SCpubr do_DotPlot modifying colors.", fig.width=14, fig.height=7}
genes <- c("IL7R", "CCR7", "CD14", "LYZ", 
           "S100A4", "MS4A1", "CD8A", "FCGR3A", 
           "MS4A7", "GNLY", "NKG7", "FCER1A", 
           "CST3", "PPBP")

colors <- c("#006d77", "#e29578")

p <- SCpubr::do_DotPlot(sample,
                        features = genes) | 
     SCpubr::do_DotPlot(sample,
                        features = genes,
                        colors.use = colors)
p
```

```{r, fig.cap="SCpubr do_TermEnrichmentPlot modifying colors.", fig.width=24, fig.height=10}
colors <- c("#006d77", "#e29578")

p <- SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 4) | 
     SCpubr::do_TermEnrichmentPlot(genes = c("CD14", "LYN"),
                                   dbs_use = "GO_Biological_Process_2021",
                                   nterms = 4,
                                   colors.use = colors)
p
```

```{r, fig.width=10, fig.height=5}
genes <- c("IL7R", "CCR7", "CD14", "LYZ", 
           "S100A4", "MS4A1", "CD8A", "FCGR3A", 
           "MS4A7", "GNLY", "NKG7", "FCER1A", 
           "CST3", "PPBP")

p <- SCpubr::do_EnrichmentHeatmap(sample = sample,
                                  list_genes = genes,
                                  transpose = T) 
     
p
```


```{r, fig.width=10, fig.height=5, fig.cap = "SCpubr::do_EnrichmentHeatmap with modified colors"}
genes <- c("IL7R", "CCR7", "CD14", "LYZ", 
           "S100A4", "MS4A1", "CD8A", "FCGR3A", 
           "MS4A7", "GNLY", "NKG7", "FCER1A", 
           "CST3", "PPBP")
colors <- c("#006d77", "#e29578")

p <- SCpubr::do_EnrichmentHeatmap(sample = sample,
                                  list_genes = genes,
                                  transpose = T,
                                  colors.use = colors) 
     
p
```
```{r, fig.width=7, fig.height=7}
p <- SCpubr::do_CorrelationPlot(sample = sample,
                                column_names_rot = 0)
     
p
```

```{r, fig.width=7, fig.height=7, fig.cap = "SCpubr::do_CorrelationPlot with modified colors"}
colors <- c("#006d77", "#e29578")
p <- SCpubr::do_CorrelationPlot(sample = sample,
                                column_names_rot = 0,
                                colors.use = colors)
     
p
```
