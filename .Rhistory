plot.title = "My awesome SC data set",
reduction = "pca")
p2 <- SCpubr::do_FeaturePlot(sample = sample,
features = "CD14",
plot.title = "My awesome SC data set",
dims = c(2, 1))
p1 | p2
p <- SCpubr::do_FeaturePlot(sample, features = c("nCount_RNA",
"nFeature_RNA",
"percent.mt",
"CD14"),
plot.title = "My very important features",
ncol = 2)
p
p <- SCpubr::do_FeaturePlot(sample = sample,
features = c("nCount_RNA",
"nFeature_RNA",
"percent.mt",
"CD14"),
plot.title = "My very important features",
individual.titles = c("Plot A",
"Plot_B",
NA,
"Plot_D"),
ncol = 2)
p
cells.plot <- colnames(sample[, !(sample$seurat_clusters %in% c("2", "5", "8"))])
p <- SCpubr::do_FeaturePlot(sample[, cells.plot],
features = c("CD14"),
plot.title = "My very important features")
p
cells.plot <- colnames(sample[, !(sample$seurat_clusters %in% c("2", "5", "8"))])
p <- SCpubr::do_FeaturePlot(sample = sample,
cells.highlight = cells.plot,
features = c("CD14"),
plot.title = "My very important features")
p
p <- SCpubr::do_FeaturePlot(sample = sample,
idents.highlight = levels(sample)[!(levels(sample) %in% c("2", "5", "8"))],
features = c("CD14"),
plot.title = "My very important features")
p
# Group clusters.
sample$new_clusters <- as.character(sample$seurat_clusters)
sample$new_clusters[sample$new_clusters %in% c("0", "1", "2", "3")] <- "Cluster 1"
sample$new_clusters[sample$new_clusters %in% c("4", "5", "6")] <- "Cluster 2"
sample$new_clusters[sample$new_clusters %in% c("7", "8", "9")] <- "Cluster 3"
p <- Seurat::FeaturePlot(sample,
features = "LYN",
split.by = "new_clusters")
p
p <- SCpubr::do_FeaturePlot(sample = sample,
features = "LYN",
split.by = "new_clusters")
p
p <- SCpubr::do_FeaturePlot(sample,
features = c("LYN", "nCount_RNA", "PC_1"),
split.by = "new_clusters")
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p <- Seurat::FeaturePlot(sample,
features = "nCount_RNA")
p
p <- Seurat::FeaturePlot(sample,
features = "nCount_RNA") +
Seurat::NoAxes() +
viridis::scale_color_viridis()
p
p <- SCpubr::do_FeaturePlot(sample = sample,
features = "nCount_RNA",
plot.title = "Number of UMIs")
p
p1 <- SCpubr::do_FeaturePlot(sample = sample,
features = "CD14",
plot.title = "My awesome SC data set",
reduction = "pca")
p2 <- SCpubr::do_FeaturePlot(sample = sample,
features = "CD14",
plot.title = "My awesome SC data set",
dims = c(2, 1))
p1 | p2
p <- SCpubr::do_FeaturePlot(sample, features = c("nCount_RNA",
"nFeature_RNA",
"percent.mt",
"CD14"),
plot.title = "My very important features",
ncol = 2)
p
p <- SCpubr::do_FeaturePlot(sample = sample,
features = c("nCount_RNA",
"nFeature_RNA",
"percent.mt",
"CD14"),
plot.title = "My very important features",
individual.titles = c("Plot A",
"Plot_B",
NA,
"Plot_D"),
ncol = 2)
p
cells.plot <- colnames(sample[, !(sample$seurat_clusters %in% c("2", "5", "8"))])
p <- SCpubr::do_FeaturePlot(sample[, cells.plot],
features = c("CD14"),
plot.title = "My very important features")
p
cells.plot <- colnames(sample[, !(sample$seurat_clusters %in% c("2", "5", "8"))])
p <- SCpubr::do_FeaturePlot(sample = sample,
cells.highlight = cells.plot,
features = c("CD14"),
plot.title = "My very important features")
p
p <- SCpubr::do_FeaturePlot(sample = sample,
idents.highlight = levels(sample)[!(levels(sample) %in% c("2", "5", "8"))],
features = c("CD14"),
plot.title = "My very important features")
p
# Group clusters.
sample$new_clusters <- as.character(sample$seurat_clusters)
sample$new_clusters[sample$new_clusters %in% c("0", "1", "2", "3")] <- "Cluster 1"
sample$new_clusters[sample$new_clusters %in% c("4", "5", "6")] <- "Cluster 2"
sample$new_clusters[sample$new_clusters %in% c("7", "8", "9")] <- "Cluster 3"
p <- Seurat::FeaturePlot(sample,
features = "LYN",
split.by = "new_clusters")
p
p <- SCpubr::do_FeaturePlot(sample = sample,
features = "LYN",
split.by = "new_clusters")
p
p <- SCpubr::do_FeaturePlot(sample,
features = c("LYN", "nCount_RNA", "PC_1"),
split.by = "new_clusters")
p
p <- SCpubr::do_FeaturePlot(sample,
features = c("LYN", "nCount_RNA", "PC_1"),
split.by = "seurat_clusters",
split.by.idents = c("2", "5"))
p
p1 <- SCpubr::do_FeaturePlot(sample = sample, features = "CD14", viridis_color_map = "A", plot.title = "Magma")
p2 <- SCpubr::do_FeaturePlot(sample = sample, features = "CD14", viridis_color_map = "B", plot.title = "Inferno")
p3 <- SCpubr::do_FeaturePlot(sample = sample, features = "CD14", viridis_color_map = "C", plot.title = "Plasma")
p4 <- SCpubr::do_FeaturePlot(sample = sample, features = "CD14", viridis_color_map = "D", plot.title = "Viridis")
p5 <- SCpubr::do_FeaturePlot(sample = sample, features = "CD14", viridis_color_map = "E", plot.title = "Cividis")
p6 <- SCpubr::do_FeaturePlot(sample = sample, features = "CD14", viridis_color_map = "F", plot.title = "Rocket")
p7 <- SCpubr::do_FeaturePlot(sample = sample, features = "CD14", viridis_color_map = "G", plot.title = "Mako")
p8 <- SCpubr::do_FeaturePlot(sample = sample, features = "CD14", viridis_color_map = "H", plot.title = "Turbo")
p <- patchwork::wrap_plots(list(p1, p2, p3, p4, p5, p6, p7, p8), ncol = 2, byrow = TRUE)
p
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p <- Nebulosa::plot_density(sample,
features = "CD14")
p
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = "CD14")
p
p1 <- SCpubr::do_FeaturePlot(sample = sample,
features = "CD14")
p2 <- SCpubr::do_NebulosaPlot(sample = sample,
features = "CD14")
p1 | p2
p <- SCpubr::do_NebulosaPlot(sample,
features = c("CD14", "CD8A"))
p
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE)
p
features.use <- c("CD14", "CD8A")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
return_only_joint = TRUE,
plot.title = "Joint density CD14-CD8A")
p
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
individual.titles = c("Plot A",
NA,
"Combined density"),
plot.title = "Density analysis")
p
p1 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "A", plot.title = "Magma")
p2 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "B", plot.title = "Inferno")
p3 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "C", plot.title = "Plasma")
p4 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "D", plot.title = "Viridis")
p5 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "E", plot.title = "Cividis")
p6 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "F", plot.title = "Rocket")
p7 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "G", plot.title = "Mako")
p8 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "H", plot.title = "Turbo")
p <- patchwork::wrap_plots(list(p1, p2, p3, p4, p5, p6, p7, p8), ncol = 2, byrow = TRUE)
p
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE)
p
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p <- Seurat::VlnPlot(sample,
features = "nCount_RNA")
p
p <- Seurat::VlnPlot(sample,
features = "nCount_RNA")
# "Surgically" add the alpha parameter in the ggplot2 object.
p$layers[[2]]$aes_params$alpha <- 0.05
p
p <- SCpubr::do_VlnPlot(sample = sample,
features = "nCount_RNA")
p
p <- SCpubr::do_VlnPlot(sample = sample,
features = "nCount_RNA",
plot_boxplot = FALSE)
p
p <- SCpubr::do_VlnPlot(sample = sample,
features = c("nCount_RNA"),
rotate_x_labels = TRUE,)
p
p <- SCpubr::do_VlnPlot(sample = sample,
features = c("nCount_RNA", "nFeature_RNA"),
rotate_x_labels = c(FALSE, TRUE),
ncol = 1)
p
p <- SCpubr::do_VlnPlot(sample = sample,
features = "nCount_RNA",
y_cut = 30000)
p
p <- SCpubr::do_VlnPlot(sample = sample,
features = c("nCount_RNA", "nFeature_RNA"),
y_cut = c(NA, 5000),
individual.titles = c("UMIs", NA),
ncol = 1)
p
# Create a color scale for the unique values in seurat clusters.
colors <- c("0" = "#001219",
"1" = "#005f73",
"2" = "#0a9396",
"3" = "#94d2bd",
"4" = "#e9d8a6",
"5" = "#ee9b00",
"6" = "#ca6702",
"7" = "#bb3e03",
"8" = "#ae2012",
"9" = "#9b2226")
p <- SCpubr::do_VlnPlot(sample = sample,
features = "nCount_RNA",
colors.use = colors)
p
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p <- Nebulosa::plot_density(sample,
features = "CD14")
p
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = "CD14")
p
p1 <- SCpubr::do_FeaturePlot(sample = sample,
features = "CD14")
p2 <- SCpubr::do_NebulosaPlot(sample = sample,
features = "CD14")
p1 | p2
p <- SCpubr::do_NebulosaPlot(sample,
features = c("CD14", "CD8A"))
p
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE)
p
features.use <- c("CD14", "CD8A")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
return_only_joint = TRUE,
plot.title = "Joint density CD14-CD8A")
p
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
individual.titles = c("Plot A",
NA,
"Combined density"),
plot.title = "Density analysis")
p
p1 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "A", plot.title = "Magma")
p2 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "B", plot.title = "Inferno")
p3 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "C", plot.title = "Plasma")
p4 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "D", plot.title = "Viridis")
p5 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "E", plot.title = "Cividis")
p6 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "F", plot.title = "Rocket")
p7 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "G", plot.title = "Mako")
p8 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "H", plot.title = "Turbo")
p <- patchwork::wrap_plots(list(p1, p2, p3, p4, p5, p6, p7, p8), ncol = 2, byrow = TRUE)
p
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE)
p
features.use <- c("CD14", "CD8A")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
return_only_joint = TRUE,
plot.title = "Joint density CD14-CD8A")
p
p <- SCpubr::do_NebulosaPlot(sample,
features = c("CD14", "CD8A"))
p
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE)
p
features.use <- c("CD14", "CD8A")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
return_only_joint = TRUE,
plot.title = "Joint density CD14-CD8A")
p
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
individual.titles = c("Plot A",
NA,
"Combined density"),
plot.title = "Density analysis")
p
p1 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "A", plot.title = "Magma")
p2 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "B", plot.title = "Inferno")
p3 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "C", plot.title = "Plasma")
p4 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "D", plot.title = "Viridis")
p5 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "E", plot.title = "Cividis")
p6 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "F", plot.title = "Rocket")
p7 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "G", plot.title = "Mako")
p8 <- SCpubr::do_NebulosaPlot(sample = sample, features = "CD8A", viridis_color_map = "H", plot.title = "Turbo")
p <- patchwork::wrap_plots(list(p1, p2, p3, p4, p5, p6, p7, p8), ncol = 2, byrow = TRUE)
p
p1 <- Seurat::DotPlot(sample,
features = "CD14")
p2 <- Seurat::DotPlot(sample,
features = "nCount_RNA")
p1 | p2
p1 <- SCpubr::do_DotPlot(sample = sample,
features = "CD14")
p2 <- SCpubr::do_DotPlot(sample = sample,
features = "nFeature_RNA")
p1 | p2
genes <- c("IL7R", "CCR7", "CD14", "LYZ",
"S100A4", "MS4A1", "CD8A", "FCGR3A",
"MS4A7", "GNLY", "NKG7", "FCER1A",
"CST3", "PPBP")
p <- SCpubr::do_DotPlot(sample = sample,
features = genes)
p
genes <- list("Naive CD4+ T" = c("IL7R", "CCR7"),
"CD14+ Mono" = c("CD14", "LYZ"),
"Memory CD4+" = c("S100A4"),
"B" = c("MS4A1"),
"CD8+ T" = c("CD8A"),
"FCGR3A+ Mono" = c("FCGR3A", "MS4A7"),
"NK" = c("GNLY", "NKG7"),
"DC" = c("FCER1A", "CST3"),
"Platelet" = c("PPBP"))
p <- SCpubr::do_DotPlot(sample = sample,
features = genes)
p
genes <- list("Naive CD4+ T" = c("IL7R", "CCR7"),
"CD14+ Mono" = c("CD14", "LYZ"),
"Memory CD4+" = c("S100A4"),
"B" = c("MS4A1"),
"CD8+ T" = c("CD8A"),
"FCGR3A+ Mono" = c("FCGR3A", "MS4A7"),
"NK" = c("GNLY", "NKG7"),
"DC" = c("FCER1A", "CST3"),
"Platelet" = c("PPBP"))
p1 <- SCpubr::do_DotPlot(sample = sample,
features = genes,
plot.title = "Not clustered")
p2 <- SCpubr::do_DotPlot(sample = sample,
features = genes,
cluster.idents = TRUE,
plot.title = "Clustered")
p1 / p2
genes <- c("IL7R", "CCR7", "CD14", "LYZ",
"S100A4", "MS4A1", "CD8A", "FCGR3A",
"MS4A7", "GNLY", "NKG7", "FCER1A",
"CST3", "PPBP")
p1 <- SCpubr::do_DotPlot(sample = sample,
features = genes,
plot.title = "Not clustered",
flip = T)
p2 <- SCpubr::do_DotPlot(sample = sample,
features = genes,
cluster.idents = TRUE,
plot.title = "Clustered",
flip = T)
p1 | p2
genes <- c("IL7R", "CCR7", "CD14", "LYZ",
"S100A4", "MS4A1", "CD8A", "FCGR3A",
"MS4A7", "GNLY", "NKG7", "FCER1A",
"CST3", "PPBP")
p <- SCpubr::do_DotPlot(sample = sample,
features = genes,
colors.use = c("#001219", "#e9d8a6"))
p
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = F,
plot.title = "Number of cells per cluster")
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = F,
plot.title = "Number of cells per cluster",
horizontal = T)
p1 | p2
p <- SCpubr::do_BarPlot(sample = sample,
features = "nCount_RNA",
legend = F,
plot.title = "Number of UMIs?",
horizontal = F)
p
# We only have one value in orig.ident. Let's modify it so that it resembles a multi-sample Seurat object.
sample$modified_orig.ident <- sample(x = c("Sample_A", "Sample_B", "Sample_C"),
size = ncol(sample),
replace = T,
prob = c(0.2, 0.7, 0.1))
p1 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
plot.title = "Number of cells per sample",
position = "stack",
legend = T,
horizontal = F)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "Number of cells per cluster and sample",
position = "stack",
legend = T,
horizontal = F)
p1 | p2
# We are going to use the previously generated sample assignment.
p1 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
plot.title = "Without group.by - position = stack",
position = "stack",
legend = T,
horizontal = F)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
plot.title = "Without group.by - position = fill",
position = "fill",
legend = T,
horizontal = F)
p3 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "With group.by - position = stack",
position = "stack",
legend = T,
horizontal = F)
p4 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "With group.by - position = fill",
position = "fill",
legend = T,
horizontal = F)
p <- (p1 | p2) / (p3 | p4)
p
# Modify proportions.
sample$modified_seurat_clusters <- as.character(sample$seurat_clusters)
sample$modified_seurat_clusters[sample$modified_orig.ident == "Sample_A" & sample$modified_seurat_clusters %in% c("0", "2", "3", "4", "5", "6", "7")] <- "1"
p1 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "modified_seurat_clusters",
plot.title = "Number of cells per sample",
order.by = "1",
position = "stack",
legend = T,
horizontal = F)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "modified_seurat_clusters",
plot.title = "Number of cells per cluster and sample",
order.by = "1",
position = "fill",
legend = T,
horizontal = F)
p1 | p2
# Create a color scale for the unique values in seurat clusters.
colors <- c("0" = "#001219",
"1" = "#005f73",
"2" = "#0a9396",
"3" = "#94d2bd",
"4" = "#e9d8a6",
"5" = "#ee9b00",
"6" = "#ca6702",
"7" = "#bb3e03",
"8" = "#ae2012",
"9" = "#9b2226")
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = F,
plot.title = "Number of cells per cluster",
horizontal = T,
colors.use = colors)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "With group.by - position = fill",
position = "fill",
legend = T,
horizontal = F,
colors.use = colors)
p1 | p2
?warning
