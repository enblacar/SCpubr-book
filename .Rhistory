flip = T)
p2 <- SCpubr::do_DotPlot(sample = sample,
features = genes,
cluster.idents = TRUE,
plot.title = "Clustered",
flip = T)
p1 | p2
genes <- c("IL7R", "CCR7", "CD14", "LYZ",
"S100A4", "MS4A1", "CD8A", "FCGR3A",
"MS4A7", "GNLY", "NKG7", "FCER1A",
"CST3", "PPBP")
p <- SCpubr::do_DotPlot(sample = sample,
features = genes,
colors.use = c("#001219", "#e9d8a6"))
p
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = F,
plot.title = "Number of cells per cluster")
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = F,
plot.title = "Number of cells per cluster",
horizontal = T)
p1 | p2
p <- SCpubr::do_BarPlot(sample = sample,
features = "nCount_RNA",
legend = F,
plot.title = "Number of UMIs?",
horizontal = F)
p
# We only have one value in orig.ident. Let's modify it so that it resembles a multi-sample Seurat object.
sample$modified_orig.ident <- sample(x = c("Sample_A", "Sample_B", "Sample_C"),
size = ncol(sample),
replace = T,
prob = c(0.2, 0.7, 0.1))
p1 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
plot.title = "Number of cells per sample",
position = "stack",
legend = T,
horizontal = F)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "Number of cells per cluster and sample",
position = "stack",
legend = T,
horizontal = F)
p1 | p2
# We are going to use the previously generated sample assignment.
p1 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
plot.title = "Without group.by - position = stack",
position = "stack",
legend = T,
horizontal = F)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
plot.title = "Without group.by - position = fill",
position = "fill",
legend = T,
horizontal = F)
p3 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "With group.by - position = stack",
position = "stack",
legend = T,
horizontal = F)
p4 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "With group.by - position = fill",
position = "fill",
legend = T,
horizontal = F)
p <- (p1 | p2) / (p3 | p4)
p
# Modify proportions.
sample$modified_seurat_clusters <- as.character(sample$seurat_clusters)
sample$modified_seurat_clusters[sample$modified_orig.ident == "Sample_A" & sample$modified_seurat_clusters %in% c("0", "2", "3", "4", "5", "6", "7")] <- "1"
p1 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "modified_seurat_clusters",
plot.title = "Number of cells per sample",
order.by = "1",
position = "stack",
legend = T,
horizontal = F)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "modified_seurat_clusters",
plot.title = "Number of cells per cluster and sample",
order.by = "1",
position = "fill",
legend = T,
horizontal = F)
p1 | p2
# Create a color scale for the unique values in seurat clusters.
colors <- c("0" = "#001219",
"1" = "#005f73",
"2" = "#0a9396",
"3" = "#94d2bd",
"4" = "#e9d8a6",
"5" = "#ee9b00",
"6" = "#ca6702",
"7" = "#bb3e03",
"8" = "#ae2012",
"9" = "#9b2226")
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = F,
plot.title = "Number of cells per cluster",
horizontal = T,
colors.use = colors)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "With group.by - position = fill",
position = "fill",
legend = T,
horizontal = F,
colors.use = colors)
p1 | p2
?warning
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = F,
plot.title = "Number of cells per cluster")
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = F,
plot.title = "Number of cells per cluster",
horizontal = T)
p1 | p2
p <- SCpubr::do_BarPlot(sample = sample,
features = "nCount_RNA",
legend = F,
plot.title = "Number of UMIs?",
horizontal = F)
p
# We only have one value in orig.ident. Let's modify it so that it resembles a multi-sample Seurat object.
sample$modified_orig.ident <- sample(x = c("Sample_A", "Sample_B", "Sample_C"),
size = ncol(sample),
replace = T,
prob = c(0.2, 0.7, 0.1))
p1 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
plot.title = "Number of cells per sample",
position = "stack",
legend = T,
horizontal = F)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "Number of cells per cluster and sample",
position = "stack",
legend = T,
horizontal = F)
p1 | p2
# We are going to use the previously generated sample assignment.
p1 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
plot.title = "Without group.by - position = stack",
position = "stack",
legend = T,
horizontal = F)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
plot.title = "Without group.by - position = fill",
position = "fill",
legend = T,
horizontal = F)
p3 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "With group.by - position = stack",
position = "stack",
legend = T,
horizontal = F)
p4 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "With group.by - position = fill",
position = "fill",
legend = T,
horizontal = F)
p <- (p1 | p2) / (p3 | p4)
p
# Modify proportions.
sample$modified_seurat_clusters <- as.character(sample$seurat_clusters)
sample$modified_seurat_clusters[sample$modified_orig.ident == "Sample_A" & sample$modified_seurat_clusters %in% c("0", "2", "3", "4", "5", "6", "7")] <- "1"
p1 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "modified_seurat_clusters",
plot.title = "Number of cells per sample",
order.by = "1",
position = "stack",
legend = T,
horizontal = F)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "modified_seurat_clusters",
plot.title = "Number of cells per cluster and sample",
order.by = "1",
position = "fill",
legend = T,
horizontal = F)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = FALSE,
add.summary_labels = TRUE)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = FALSE,
horizontal = TRUE,
add.summary_labels = TRUE)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = FALSE,
add.summary_labels = TRUE,
size.labels = 2.5)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = FALSE,
horizontal = TRUE,
add.summary_labels = TRUE,
size.labels = 2.5)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
add.summary_labels = TRUE)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
horizontal = TRUE,
add.summary_labels = TRUE)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
horizontal = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE,
repel.subgroup_labels = TRUE)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
horizontal = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE,
repel.subgroup_labels = TRUE)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE,
repel.summary_labels = TRUE,
repel.subgroup_labels = TRUE)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
horizontal = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE,
repel.summary_labels = TRUE,
repel.subgroup_labels = TRUE)
p1 | p2
# Create a color scale for the unique values in seurat clusters.
colors <- c("0" = "#001219",
"1" = "#005f73",
"2" = "#0a9396",
"3" = "#94d2bd",
"4" = "#e9d8a6",
"5" = "#ee9b00",
"6" = "#ca6702",
"7" = "#bb3e03",
"8" = "#ae2012",
"9" = "#9b2226")
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = FALSE,
plot.title = "Number of cells per cluster",
horizontal = TRUE,
colors.use = colors)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "With group.by - position = fill",
position = "fill",
legend = TRUE,
horizontal = FALSE,
colors.use = colors)
p1 | p2
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = F,
plot.title = "Number of cells per cluster")
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = F,
plot.title = "Number of cells per cluster",
horizontal = T)
p1 | p2
p <- SCpubr::do_BarPlot(sample = sample,
features = "nCount_RNA",
legend = F,
plot.title = "Number of UMIs?",
horizontal = F)
p
# We only have one value in orig.ident. Let's modify it so that it resembles a multi-sample Seurat object.
sample$modified_orig.ident <- sample(x = c("Sample_A", "Sample_B", "Sample_C"),
size = ncol(sample),
replace = T,
prob = c(0.2, 0.7, 0.1))
p1 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
plot.title = "Number of cells per sample",
position = "stack",
legend = T,
horizontal = F)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "Number of cells per cluster and sample",
position = "stack",
legend = T,
horizontal = F)
p1 | p2
# We are going to use the previously generated sample assignment.
p1 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
plot.title = "Without group.by - position = stack",
position = "stack",
legend = T,
horizontal = F)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
plot.title = "Without group.by - position = fill",
position = "fill",
legend = T,
horizontal = F)
p3 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "With group.by - position = stack",
position = "stack",
legend = T,
horizontal = F)
p4 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "With group.by - position = fill",
position = "fill",
legend = T,
horizontal = F)
p <- (p1 | p2) / (p3 | p4)
p
# Modify proportions.
sample$modified_seurat_clusters <- as.character(sample$seurat_clusters)
sample$modified_seurat_clusters[sample$modified_orig.ident == "Sample_A" & sample$modified_seurat_clusters %in% c("0", "2", "3", "4", "5", "6", "7")] <- "1"
p1 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "modified_seurat_clusters",
plot.title = "Number of cells per sample",
order.by = "1",
position = "stack",
legend = T,
horizontal = F)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "modified_seurat_clusters",
plot.title = "Number of cells per cluster and sample",
order.by = "1",
position = "fill",
legend = T,
horizontal = F)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = FALSE,
add.summary_labels = TRUE)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = FALSE,
horizontal = TRUE,
add.summary_labels = TRUE)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = FALSE,
add.summary_labels = TRUE,
size.labels = 2.5)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = FALSE,
horizontal = TRUE,
add.summary_labels = TRUE,
size.labels = 2.5)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
add.summary_labels = TRUE)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
horizontal = TRUE,
add.summary_labels = TRUE)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
horizontal = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE,
repel.subgroup_labels = TRUE)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
horizontal = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE,
repel.subgroup_labels = TRUE)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE,
repel.summary_labels = TRUE,
repel.subgroup_labels = TRUE)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
horizontal = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE,
repel.summary_labels = TRUE,
repel.subgroup_labels = TRUE)
p1 | p2
# Create a color scale for the unique values in seurat clusters.
colors <- c("0" = "#001219",
"1" = "#005f73",
"2" = "#0a9396",
"3" = "#94d2bd",
"4" = "#e9d8a6",
"5" = "#ee9b00",
"6" = "#ca6702",
"7" = "#bb3e03",
"8" = "#ae2012",
"9" = "#9b2226")
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = FALSE,
plot.title = "Number of cells per cluster",
horizontal = TRUE,
colors.use = colors)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "With group.by - position = fill",
position = "fill",
legend = TRUE,
horizontal = FALSE,
colors.use = colors)
p1 | p2
