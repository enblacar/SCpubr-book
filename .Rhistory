dims = c(3, 4))
p3 <- SCpubr::do_BeeSwarmPlot(sample = sample,
features_to_rank = "PC_1",
group.by = "seurat_clusters",
continuous_feature = F)
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p1 <- SCpubr::do_DimPlot(sample = sample,
reduction = "pca",
label = T,
legend = F,
dims = c(1, 2))
p2 <- SCpubr::do_DimPlot(sample = sample,
reduction = "pca",
label = T,
legend = F,
dims = c(3, 4))
p3 <- SCpubr::do_BeeSwarmPlot(sample = sample,
features_to_rank = "PC_1",
group.by = "seurat_clusters",
continuous_feature = F)
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p1 <- SCpubr::do_DimPlot(sample = sample,
reduction = "pca",
label = T,
legend = F,
dims = c(1, 2))
p2 <- SCpubr::do_DimPlot(sample = sample,
reduction = "pca",
label = T,
legend = F,
dims = c(3, 4))
p3 <- SCpubr::do_BeeSwarmPlot(sample = sample,
features_to_rank = "PC_1",
group.by = "seurat_clusters",
continuous_feature = F)
p4 <- SCpubr::do_BeeSwarmPlot(sample = sample,
features_to_rank = "PC_4",
group.by = "seurat_clusters",
continuous_feature = F)
(p1 | p3) / (p2 | p4)
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p1 <- SCpubr::do_DimPlot(sample,
reduction = "pca",
label = T,
legend = F,
dims = c(1, 2))
p2 <- SCpubr::do_DimPlot(sample,
reduction = "pca",
label = T,
legend = F,
dims = c(3, 4))
p1 | p2
p1 <- SCpubr::do_DimPlot(sample = sample,
reduction = "pca",
label = T,
legend = F,
dims = c(1, 2))
p2 <- SCpubr::do_DimPlot(sample = sample,
reduction = "pca",
label = T,
legend = F,
dims = c(3, 4))
p3 <- SCpubr::do_BeeSwarmPlot(sample = sample,
feature_to_rank = "PC_1",
group.by = "seurat_clusters",
continuous_feature = F)
p4 <- SCpubr::do_BeeSwarmPlot(sample = sample,
feature_to_rank = "PC_4",
group.by = "seurat_clusters",
continuous_feature = F)
(p1 | p3) / (p2 | p4)
# Clusters to exclude.
clusters_exclude <- c("0", "3", "5", "7", "8", "9")
# Keep the original coloring.
cols.use <- colortools::setColors("steelblue",
length(levels(sample)))
names(cols.use) <- levels(sample)
p1 <- SCpubr::do_DimPlot(sample = sample[, !(sample$seurat_clusters %in% clusters_exclude)],
reduction = "pca",
label = T,
legend = F,
dims = c(3, 4),
colors.use = cols.use)
p2 <- SCpubr::do_BeeSwarmPlot(sample = sample[, !(sample$seurat_clusters %in% clusters_exclude)],
feature_to_rank = "PC_4",
group.by = "seurat_clusters",
continuous_feature = F,
colors.use = cols.use)
p1 | p2
# Clusters to exclude.
clusters_exclude <- c("0", "1", "2", "3", "5", "7", "8", "9")
# Keep the original coloring.
cols.use <- colortools::setColors("steelblue", length(levels(sample)))
names(cols.use) <- levels(sample)
p1 <- SCpubr::do_DimPlot(sample = sample[, !(sample$seurat_clusters %in% clusters_exclude)],
reduction = "pca",
label = T,
legend = F,
dims = c(3, 4),
colors.use = cols.use)
p2 <- SCpubr::do_BeeSwarmPlot(sample = sample[, !(sample$seurat_clusters %in% clusters_exclude)],
feature_to_rank = "PC_4",
group.by = "seurat_clusters",
continuous_feature = F,
colors.use = cols.use)
p1 | p2
# Set up list of a genes to compute enrichment. Let's use a monocyte signature.
genes.use <- c("CD14", "LYZ")
# Compute enrichment and rename the output.
sample <- Seurat::AddModuleScore(sample,
features = genes.use,
name = "Monocyte_signature")
sample$Monocyte_signature <- sample$Monocyte_signature1
sample$Monocyte_signature1 <- NULL
p1 <- SCpubr::do_DimPlot(sample = sample,
label = T,
legend = F)
p2 <- SCpubr::do_FeaturePlot(sample = sample,
features = "Monocyte_signature")
p3 <- SCpubr::do_BeeSwarmPlot(sample = sample,
feature_to_rank = "Monocyte_signature",
group.by = "seurat_clusters",
continuous_feature = T)
p1 | p2 | p3
# Create a color scale for the unique values in seurat clusters.
colors <- c("0" = "#001219",
"1" = "#005f73",
"2" = "#0a9396",
"3" = "#94d2bd",
"4" = "#e9d8a6",
"5" = "#ee9b00",
"6" = "#ca6702",
"7" = "#bb3e03",
"8" = "#ae2012",
"9" = "#9b2226")
p <- SCpubr::do_BeeSwarmPlot(sample = sample,
feature_to_rank = "Monocyte_signature",
group.by = "seurat_clusters",
colors.use = colors)
p
p1 <- SCpubr::do_BeeSwarmPlot(sample = sample, feature_to_rank = "Monocyte_signature", group.by = "seurat_clusters", continuous_feature = TRUE, fontsize = 10, viridis_color_map = "A", plot.title = "Magma")
p2 <- SCpubr::do_BeeSwarmPlot(sample = sample, feature_to_rank = "Monocyte_signature", group.by = "seurat_clusters", continuous_feature = TRUE, fontsize = 10, viridis_color_map = "B", plot.title = "Inferno")
p3 <- SCpubr::do_BeeSwarmPlot(sample = sample, feature_to_rank = "Monocyte_signature", group.by = "seurat_clusters", continuous_feature = TRUE, fontsize = 10, viridis_color_map = "C", plot.title = "Plasma")
p4 <- SCpubr::do_BeeSwarmPlot(sample = sample, feature_to_rank = "Monocyte_signature", group.by = "seurat_clusters", continuous_feature = TRUE, fontsize = 10, viridis_color_map = "D", plot.title = "Viridis")
p5 <- SCpubr::do_BeeSwarmPlot(sample = sample, feature_to_rank = "Monocyte_signature", group.by = "seurat_clusters", continuous_feature = TRUE, fontsize = 10, viridis_color_map = "E", plot.title = "Cividis")
p6 <- SCpubr::do_BeeSwarmPlot(sample = sample, feature_to_rank = "Monocyte_signature", group.by = "seurat_clusters", continuous_feature = TRUE, fontsize = 10, viridis_color_map = "F", plot.title = "Rocket")
p7 <- SCpubr::do_BeeSwarmPlot(sample = sample, feature_to_rank = "Monocyte_signature", group.by = "seurat_clusters", continuous_feature = TRUE, fontsize = 10, viridis_color_map = "G", plot.title = "Mako")
p8 <- SCpubr::do_BeeSwarmPlot(sample = sample, feature_to_rank = "Monocyte_signature", group.by = "seurat_clusters", continuous_feature = TRUE, fontsize = 10, viridis_color_map = "H", plot.title = "Turbo")
p <- patchwork::wrap_plots(list(p1, p2, p3, p4, p5, p6, p7, p8), ncol = 2, byrow = TRUE)
p
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p <- Seurat::FeaturePlot(sample,
features = "nCount_RNA")
p
p <- Seurat::FeaturePlot(sample,
features = "nCount_RNA") +
Seurat::NoAxes() +
viridis::scale_color_viridis()
p
p <- SCpubr::do_FeaturePlot(sample = sample,
features = "nCount_RNA",
plot.title = "Number of UMIs")
p
p <- SCpubr::do_FeaturePlot(sample, features = c("nCount_RNA",
"nFeature_RNA",
"percent.mt",
"CD14"),
plot.title = "My very important features",
ncol = 2)
p
p1 <- SCpubr::do_FeaturePlot(sample,
features = "nCount_RNA",
plot.title = "Plot A")
p2 <- SCpubr::do_FeaturePlot(sample,
features = "nFeature_RNA",
plot.title = "Plot B")
p3 <- SCpubr::do_FeaturePlot(sample,
features = "percent.mt",
plot.title = "Plot C")
p4 <- SCpubr::do_FeaturePlot(sample,
features = "CD14",
plot.title = "Plot D")
patch <- patchwork::wrap_plots(list(p1, p2, p3, p4), ncol = 2) +
patchwork::plot_annotation(title = "My very important features",
theme = ggplot2::theme(plot.title = ggplot2::element_text(size = 18,
face = "bold",
hjust = 0.5)))
patch
cells.plot <- colnames(sample[, !(sample$seurat_clusters %in% c("2", "5", "8"))])
p <- SCpubr::do_FeaturePlot(sample[, cells.plot],
features = c("CD14"),
plot.title = "My very important features")
p
cells.plot <- colnames(sample[, !(sample$seurat_clusters %in% c("2", "5", "8"))])
p <- SCpubr::do_FeaturePlot(sample = sample,
cells.highlight = cells.plot,
features = c("CD14"),
plot.title = "My very important features")
p
p <- SCpubr::do_FeaturePlot(sample = sample,
idents.highlight = levels(sample)[!(levels(sample) %in% c("2", "5", "8"))],
features = c("CD14"),
plot.title = "My very important features")
p
# Group clusters.
sample$new_clusters <- as.character(sample$seurat_clusters)
sample$new_clusters[sample$new_clusters %in% c("0", "1", "2", "3")] <- "Cluster 1"
sample$new_clusters[sample$new_clusters %in% c("4", "5", "6")] <- "Cluster 2"
sample$new_clusters[sample$new_clusters %in% c("7", "8", "9")] <- "Cluster 3"
p <- Seurat::FeaturePlot(sample,
features = "LYN",
split.by = "new_clusters")
p
p <- SCpubr::do_FeaturePlot(sample = sample,
features = "LYN",
split.by = "new_clusters")
p
p <- SCpubr::do_FeaturePlot(sample,
features = c("LYN", "nCount_RNA", "PC_1"),
split.by = "new_clusters")
p
p <- SCpubr::do_FeaturePlot(sample,
features = c("LYN", "nCount_RNA", "PC_1"),
split.by = "seurat_clusters",
split.by.idents = c("2", "5"))
p
p1 <- SCpubr::do_FeaturePlot(sample = sample, features = "CD14", viridis_color_map = "A", plot.title = "Magma")
p2 <- SCpubr::do_FeaturePlot(sample = sample, features = "CD14", viridis_color_map = "B", plot.title = "Inferno")
p3 <- SCpubr::do_FeaturePlot(sample = sample, features = "CD14", viridis_color_map = "C", plot.title = "Plasma")
p4 <- SCpubr::do_FeaturePlot(sample = sample, features = "CD14", viridis_color_map = "D", plot.title = "Viridis")
p5 <- SCpubr::do_FeaturePlot(sample = sample, features = "CD14", viridis_color_map = "E", plot.title = "Cividis")
p6 <- SCpubr::do_FeaturePlot(sample = sample, features = "CD14", viridis_color_map = "F", plot.title = "Rocket")
p7 <- SCpubr::do_FeaturePlot(sample = sample, features = "CD14", viridis_color_map = "G", plot.title = "Mako")
p8 <- SCpubr::do_FeaturePlot(sample = sample, features = "CD14", viridis_color_map = "H", plot.title = "Turbo")
p <- patchwork::wrap_plots(list(p1, p2, p3, p4, p5, p6, p7, p8), ncol = 2, byrow = TRUE)
p
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p <- SCpubr::do_FeaturePlot(sample = sample,
features = c("nCount_RNA",
"nFeature_RNA",
"percent.mt",
"CD14"),
plot.title = "My very important features",
individual.titles = c("Plot A",
"Plot_B",
NA,
"Plot_D"),
ncol = 2)
p <- SCpubr::do_FeaturePlot(sample = sample,
features = c("nCount_RNA",
"nFeature_RNA",
"percent.mt",
"CD14"),
plot.title = "My very important features",
individual.titles = c("Plot A",
"Plot_B",
NA,
"Plot_D"),
ncol = 2)
p
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
combine = F,
individual.titles = c("Plot_A",
NA,
"Combined density"))
p
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
combine = F,
individual.titles = c("Plot_A",
NA,
"Combined density"))
p
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p <- SCpubr::do_DimPlot(sample = sample)
p
SCpubr::do_DimPlot(sample = sample, group.by = "orig.ident")
# Select 1000 random cells out of clusters 1, 5 and 7.
cells.use <- sample(colnames(sample[, sample$seurat_clusters %in% c("1", "5", "7")]), 1000)
p <- Seurat::DimPlot(sample,
cells.highlight = cells.use)
p
# Select 1000 random cells out of clusters 1, 5 and 7.
cells.use <- sample(colnames(sample[, sample$seurat_clusters %in% c("1", "5", "7")]), 1000)
p <- Seurat::DimPlot(sample,
cells.highlight = cells.use)
p
# Select 1000 random cells out of clusters 1, 5 and 7.
cells.use <- sample(colnames(sample[, sample$seurat_clusters %in% c("1", "5", "7")]), 1000)
p <- SCpubr::do_DimPlot(sample = sample,
cells.highlight = cells.use)
p
# Using ncol = 5 to maintain some of the proportions.
p <- Seurat::DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5)
p
# Using ncol = 5 to maintain some of the proportions.
# Using legend = F to remove unwanted repeated legends.
p <- SCpubr::do_DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5,
legend = F)
p
# Using ncol = 5 to maintain some of the proportions.
# Using legend = F to remove unwanted repeated legends.
p <- SCpubr::do_DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5,
legend = F)
p
# Create a color scale for the unique values in seurat clusters.
colors <- c("0" = "#001219",
"1" = "#005f73",
"2" = "#0a9396",
"3" = "#94d2bd",
"4" = "#e9d8a6",
"5" = "#ee9b00",
"6" = "#ca6702",
"7" = "#bb3e03",
"8" = "#ae2012",
"9" = "#9b2226")
p1 <- SCpubr::do_DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5,
legend = F,
colors.use = colors)
p2 <- SCpubr::do_DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5,
legend = F,
colors.use = "#008080")
p1 / p2
# Select 1000 random cells out of clusters 1, 5 and 7.
cells.use <- sample(colnames(sample[, sample$seurat_clusters %in% c("1", "5", "7")]), 1000)
p1 <- SCpubr::do_DimPlot(sample = sample,
cells.highlight = cells.use)
p2 <- SCpubr::do_DimPlot(sample = sample,
cells.highlight = cells.use,
colors.use = "steelblue")
p1 / p2
# Select 1000 random cells out of clusters 1, 5 and 7.
cells.use <- sample(colnames(sample[, sample$seurat_clusters %in% c("1", "5", "7")]), 1000)
p1 <- SCpubr::do_DimPlot(sample = sample,
cells.highlight = cells.use)
p2 <- SCpubr::do_DimPlot(sample = sample,
cells.highlight = cells.use,
colors.use = "steelblue")
p1 | p2
# Clusters to exclude.
clusters_exclude <- c("0", "3", "5", "7", "8", "9")
# Keep the original coloring.
cols.use <- colortools::setColors("steelblue",
length(levels(sample)))
names(cols.use) <- levels(sample)
p1 <- SCpubr::do_DimPlot(sample = sample[, !(sample$seurat_clusters %in% clusters_exclude)],
reduction = "pca",
label = T,
legend = F,
dims = c(3, 4),
colors.use = cols.use)
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p <- Seurat::DimPlot(sample)
p
p <- Seurat::DimPlot(sample,
shuffle = T)
p
p <- Seurat::DimPlot(sample,
shuffle = T) +
Seurat::NoAxes()
p
p <- Seurat::DimPlot(sample,
shuffle = T,
pt.size = 0.5) +
Seurat::NoAxes()
p
p <- Seurat::DimPlot(sample,
shuffle = T,
pt.size = 0.5) +
Seurat::NoAxes() +
ggplot2::theme(legend.text = ggplot2::element_text(size = 12,
face = "bold"),
legend.title = ggplot2::element_text(size = 12,
face = "bold"))
p
p <- Seurat::DimPlot(sample,
shuffle = T,
pt.size = 0.5) +
Seurat::NoAxes() +
ggplot2::ggtitle("My awesome SC dataset") +
ggplot2::theme(legend.text = ggplot2::element_text(size = 12,
face = "bold"),
legend.title = ggplot2::element_text(size = 12,
face = "bold"))
p
p <- Seurat::DimPlot(sample,
shuffle = T,
pt.size = 0.5) +
Seurat::NoAxes() +
ggplot2::ggtitle("My awesome SC dataset") +
ggplot2::theme(plot.title = ggplot2::element_text(size = 16,
face = "bold",
hjust = 0.5),
legend.text = ggplot2::element_text(size = 12,
face = "bold"),
legend.title = ggplot2::element_text(size = 12,
face = "bold"))
p
num_clusters <- length(unique(sample$seurat_clusters))
color_scale <- colortools::setColors("#457b9d", num_clusters)
names(color_scale) <- sort(unique(sample$seurat_clusters))
p <- Seurat::DimPlot(sample,
shuffle = T,
pt.size = 0.5,
cols = color_scale) +
Seurat::NoAxes() +
ggplot2::ggtitle("My awesome SC dataset") +
ggplot2::theme(plot.title = ggplot2::element_text(size = 16,
face = "bold",
hjust = 0.5),
legend.text = ggplot2::element_text(size = 12,
face = "bold"),
legend.title = ggplot2::element_text(size = 12,
face = "bold"))
p
p <- SCpubr::do_DimPlot(sample = sample)
p
p <- SCpubr::do_DimPlot(sample = sample,
plot.title = "My awesome SC data set")
p
p <- SCpubr::do_DimPlot(sample = sample,
plot.title = "My awesome SC data set",
legend.position = "left",
legend.ncol = 2)
p
p <- Seurat::DimPlot(sample,
label = T)
p
p <- SCpubr::do_DimPlot(sample = sample,
label = TRUE,
legend = FALSE)
p
# Create a color scale for the unique values in seurat clusters.
colors <- c("0" = "#001219",
"1" = "#005f73",
"2" = "#0a9396",
"3" = "#94d2bd",
"4" = "#e9d8a6",
"5" = "#ee9b00",
"6" = "#ca6702",
"7" = "#bb3e03",
"8" = "#ae2012",
"9" = "#9b2226")
p <- SCpubr::do_DimPlot(sample = sample,
colors.use = colors)
p
# Select 1000 random cells out of clusters 1, 5 and 7.
cells.use <- sample(colnames(sample[, sample$seurat_clusters %in% c("1", "5", "7")]), 1000)
p <- Seurat::DimPlot(sample,
cells.highlight = cells.use)
p
# Select 1000 random cells out of clusters 1, 5 and 7.
cells.use <- sample(colnames(sample[, sample$seurat_clusters %in% c("1", "5", "7")]), 1000)
p1 <- SCpubr::do_DimPlot(sample = sample,
cells.highlight = cells.use)
p2 <- SCpubr::do_DimPlot(sample = sample,
cells.highlight = cells.use,
colors.use = "steelblue")
p1 | p2
# Select 1000 random cells out of clusters 1, 5 and 7.
cells.use <- sample(colnames(sample[, sample$seurat_clusters %in% c("1", "5", "7")]), 1000)
p <- SCpubr::do_DimPlot(sample = sample,
cells.highlight = cells.use,
sizes.highlight = 1)
p
# Using ncol = 5 to maintain some of the proportions.
p <- Seurat::DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5)
p
# Using ncol = 5 to maintain some of the proportions.
# Using legend = F to remove unwanted repeated legends.
p <- SCpubr::do_DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5,
legend = F)
p
# Create a color scale for the unique values in seurat clusters.
colors <- c("0" = "#001219",
"1" = "#005f73",
"2" = "#0a9396",
"3" = "#94d2bd",
"4" = "#e9d8a6",
"5" = "#ee9b00",
"6" = "#ca6702",
"7" = "#bb3e03",
"8" = "#ae2012",
"9" = "#9b2226")
p1 <- SCpubr::do_DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5,
legend = F,
colors.use = colors)
p2 <- SCpubr::do_DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5,
legend = F,
colors.use = "#008080")
p1 / p2
