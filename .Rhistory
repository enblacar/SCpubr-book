horizontal = TRUE,
add.summary_labels = TRUE)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
horizontal = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE,
repel.subgroup_labels = TRUE)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
horizontal = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE,
repel.subgroup_labels = TRUE)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE,
repel.summary_labels = TRUE,
repel.subgroup_labels = TRUE)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
horizontal = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE,
repel.summary_labels = TRUE,
repel.subgroup_labels = TRUE)
p1 | p2
# Create a color scale for the unique values in seurat clusters.
colors <- c("0" = "#001219",
"1" = "#005f73",
"2" = "#0a9396",
"3" = "#94d2bd",
"4" = "#e9d8a6",
"5" = "#ee9b00",
"6" = "#ca6702",
"7" = "#bb3e03",
"8" = "#ae2012",
"9" = "#9b2226")
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = FALSE,
plot.title = "Number of cells per cluster",
horizontal = TRUE,
colors.use = colors)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "With group.by - position = fill",
position = "fill",
legend = TRUE,
horizontal = FALSE,
colors.use = colors)
p1 | p2
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = F,
plot.title = "Number of cells per cluster")
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = F,
plot.title = "Number of cells per cluster",
horizontal = T)
p1 | p2
p <- SCpubr::do_BarPlot(sample = sample,
features = "nCount_RNA",
legend = F,
plot.title = "Number of UMIs?",
horizontal = F)
p
# We only have one value in orig.ident. Let's modify it so that it resembles a multi-sample Seurat object.
sample$modified_orig.ident <- sample(x = c("Sample_A", "Sample_B", "Sample_C"),
size = ncol(sample),
replace = T,
prob = c(0.2, 0.7, 0.1))
p1 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
plot.title = "Number of cells per sample",
position = "stack",
legend = T,
horizontal = F)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "Number of cells per cluster and sample",
position = "stack",
legend = T,
horizontal = F)
p1 | p2
# We are going to use the previously generated sample assignment.
p1 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
plot.title = "Without group.by - position = stack",
position = "stack",
legend = T,
horizontal = F)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
plot.title = "Without group.by - position = fill",
position = "fill",
legend = T,
horizontal = F)
p3 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "With group.by - position = stack",
position = "stack",
legend = T,
horizontal = F)
p4 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "With group.by - position = fill",
position = "fill",
legend = T,
horizontal = F)
p <- (p1 | p2) / (p3 | p4)
p
# Modify proportions.
sample$modified_seurat_clusters <- as.character(sample$seurat_clusters)
sample$modified_seurat_clusters[sample$modified_orig.ident == "Sample_A" & sample$modified_seurat_clusters %in% c("0", "2", "3", "4", "5", "6", "7")] <- "1"
p1 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "modified_seurat_clusters",
plot.title = "Number of cells per sample",
order.by = "1",
position = "stack",
legend = T,
horizontal = F)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "modified_seurat_clusters",
plot.title = "Number of cells per cluster and sample",
order.by = "1",
position = "fill",
legend = T,
horizontal = F)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = FALSE,
add.summary_labels = TRUE)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = FALSE,
horizontal = TRUE,
add.summary_labels = TRUE)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = FALSE,
add.summary_labels = TRUE,
size.labels = 2.5)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = FALSE,
horizontal = TRUE,
add.summary_labels = TRUE,
size.labels = 2.5)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
add.summary_labels = TRUE)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
horizontal = TRUE,
add.summary_labels = TRUE)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
horizontal = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE,
repel.subgroup_labels = TRUE)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
horizontal = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE,
repel.subgroup_labels = TRUE)
p1 | p2
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE,
repel.summary_labels = TRUE,
repel.subgroup_labels = TRUE)
p2 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
group.by = "modified_orig.ident",
legend = TRUE,
horizontal = TRUE,
add.summary_labels = TRUE,
add.subgroup_labels = TRUE,
repel.summary_labels = TRUE,
repel.subgroup_labels = TRUE)
p1 | p2
# Create a color scale for the unique values in seurat clusters.
colors <- c("0" = "#001219",
"1" = "#005f73",
"2" = "#0a9396",
"3" = "#94d2bd",
"4" = "#e9d8a6",
"5" = "#ee9b00",
"6" = "#ca6702",
"7" = "#bb3e03",
"8" = "#ae2012",
"9" = "#9b2226")
p1 <- SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = FALSE,
plot.title = "Number of cells per cluster",
horizontal = TRUE,
colors.use = colors)
p2 <- SCpubr::do_BarPlot(sample,
features = "modified_orig.ident",
group.by = "seurat_clusters",
plot.title = "With group.by - position = fill",
position = "fill",
legend = TRUE,
horizontal = FALSE,
colors.use = colors)
p1 | p2
sample <- readRDS("/icgc/dkfzlsdf/analysis/B062/Federico/LucaTiberi_singlecelldata/Seurat_analysis/malignant_analysis/20220131_ClusterMap/tiberi_merged_rpca.RData")
sample <- readRDS("/omics/odcf/analysis/B062/Federico/LucaTiberi_singlecelldata/Seurat_analysis/malignant_analysis/20220131_ClusterMap/tiberi_merged_rpca.RData")
sample <- readRDS("/omics/groups/OE0290/internal/Federico/LucaTiberi_singlecelldata/Seurat_analysis/malignant_analysis/20220131_ClusterMap/tiberi_merged_rpca.RData")
sample <- load("/omics/groups/OE0290/internal/Federico/LucaTiberi_singlecelldata/Seurat_analysis/malignant_analysis/20220131_ClusterMap/tiberi_merged_rpca.RData")
sample
sample <- sce.m
rm(sce.m)
sample
metadata <- readxl::read_excel("~/eblanco/project/data.xlsx")
metadata <- readxl::read_excel("~/eblanco/projects/data.xlsx")
metadata
all(rownames(metadata)==colnames(sample))
colnames(sample)
dim(metadata)
dim(sample)
sample@meta.data <- metadata
sample$cluster_new
table(sample$cluster_new)
Seurat::Idents(sample) <- sample$cluster_new
SCpubr::do_DimPlot(sample)
Seurat::Idents(sample)
Seurat::Idents(sample) <- sample$cluster_new
SCpubr::do_DimPlot(sample)
SCpubr::do_DimPlot(sample, group.by = "cluster_new")
sample
sample@meta.data
sample$...1
sample@meta.data
SCpubr::do_DimPlot(sample, group.by = "cluster_new")
sample
table(sample$cluster_new)
SCpubr::do_DimPlot(sample, group.by = "seurat_clusters")
metadata
metadata <- as.data.frame(readxl::read_excel("~/eblanco/projects/data.xlsx"))
metadata
rownames(metadata) <- sample$...1
metadata$...1 <- NULL
metadata
sample@meta.data <- metadata
Seurat::Idents(sample) <- sample$cluster_new
SCpubr::do_DimPlot(sample, group.by = "seurat_clusters")
SCpubr::do_DimPlot(sample, group.by = "cluster_new")
SCpubr::do_DimPlot(sample, split.by = "cluster_new")
SCpubr::do_FeaturePlot(sample, split.by = "cluster_new")
SCpubr::do_FeaturePlot(sample, features = "GFAP", split.by = "cluster_new")
SCpubr::do_FeaturePlot(sample, features = "GFAP", split.by = "cluster_new")
sample <- load("/omics/groups/OE0290/internal/Federico/LucaTiberi_singlecelldata/Seurat_analysis/malignant_analysis/20220131_ClusterMap/tiberi_merged_rpca.RData")
sample <- sce.m
rm(sce.m)
metadata <- as.data.frame(readxl::read_excel("~/eblanco/projects/data.xlsx"))
sample@meta.data <- metadata
Seurat::Idents(sample) <- sample$cluster_new
SCpubr::do_DimPlot(sample, group.by = "cluster_new")
# Add the metadata.
sample@meta.data <- metadata
# Check our cluster assignment.
table(sample$cluster_new)
# Reassign identities.
Seurat::Idents(sample) <- sample$cluster_new
# Normal DimPlot.
SCpubr::do_DimPlot(sample)
SCpubr::do_DimPlot(sample, split.by = "cluster_new")
SCpubr::do_DimPlot(sample, group.by = "cluster_new")
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p <- Seurat::DimPlot(sample)
p
p <- Seurat::DimPlot(sample,
shuffle = T)
p
p <- Seurat::DimPlot(sample,
shuffle = T) +
Seurat::NoAxes()
p
p <- Seurat::DimPlot(sample,
shuffle = T,
pt.size = 0.5) +
Seurat::NoAxes()
p
p <- Seurat::DimPlot(sample,
shuffle = T,
pt.size = 0.5) +
Seurat::NoAxes() +
ggplot2::theme(legend.text = ggplot2::element_text(size = 12,
face = "bold"),
legend.title = ggplot2::element_text(size = 12,
face = "bold"))
p
p <- Seurat::DimPlot(sample,
shuffle = T,
pt.size = 0.5) +
Seurat::NoAxes() +
ggplot2::ggtitle("My awesome SC dataset") +
ggplot2::theme(legend.text = ggplot2::element_text(size = 12,
face = "bold"),
legend.title = ggplot2::element_text(size = 12,
face = "bold"))
p
p <- Seurat::DimPlot(sample,
shuffle = T,
pt.size = 0.5) +
Seurat::NoAxes() +
ggplot2::ggtitle("My awesome SC dataset") +
ggplot2::theme(plot.title = ggplot2::element_text(size = 16,
face = "bold",
hjust = 0.5),
legend.text = ggplot2::element_text(size = 12,
face = "bold"),
legend.title = ggplot2::element_text(size = 12,
face = "bold"))
p
num_clusters <- length(unique(sample$seurat_clusters))
color_scale <- colortools::setColors("#457b9d", num_clusters)
names(color_scale) <- sort(unique(sample$seurat_clusters))
p <- Seurat::DimPlot(sample,
shuffle = T,
pt.size = 0.5,
cols = color_scale) +
Seurat::NoAxes() +
ggplot2::ggtitle("My awesome SC dataset") +
ggplot2::theme(plot.title = ggplot2::element_text(size = 16,
face = "bold",
hjust = 0.5),
legend.text = ggplot2::element_text(size = 12,
face = "bold"),
legend.title = ggplot2::element_text(size = 12,
face = "bold"))
p
p <- SCpubr::do_DimPlot(sample = sample)
p
p1 <- SCpubr::do_DimPlot(sample = sample,
plot.title = "My awesome SC data set",
reduction = "pca")
p2 <- SCpubr::do_DimPlot(sample = sample,
plot.title = "My awesome SC data set",
dims = c(2, 1))
p1 | p2
p <- SCpubr::do_DimPlot(sample = sample,
plot.title = "My awesome SC data set")
p
p <- SCpubr::do_DimPlot(sample = sample,
plot.title = "My awesome SC data set",
legend.position = "left",
legend.ncol = 2)
p
p <- Seurat::DimPlot(sample,
label = T)
p
p <- SCpubr::do_DimPlot(sample = sample,
label = TRUE,
legend = FALSE)
p
# Create a color scale for the unique values in seurat clusters.
colors <- c("0" = "#001219",
"1" = "#005f73",
"2" = "#0a9396",
"3" = "#94d2bd",
"4" = "#e9d8a6",
"5" = "#ee9b00",
"6" = "#ca6702",
"7" = "#bb3e03",
"8" = "#ae2012",
"9" = "#9b2226")
p <- SCpubr::do_DimPlot(sample = sample,
colors.use = colors)
p
# Select 1000 random cells out of clusters 1, 5 and 7.
cells.use <- sample(colnames(sample[, sample$seurat_clusters %in% c("1", "5", "7")]), 1000)
p <- Seurat::DimPlot(sample,
cells.highlight = cells.use)
p
# Select 1000 random cells out of clusters 1, 5 and 7.
cells.use <- sample(colnames(sample[, sample$seurat_clusters %in% c("1", "5", "7")]), 1000)
p1 <- SCpubr::do_DimPlot(sample = sample,
cells.highlight = cells.use)
p2 <- SCpubr::do_DimPlot(sample = sample,
cells.highlight = cells.use,
colors.use = "steelblue")
p1 | p2
# Select 1000 random cells out of clusters 1, 5 and 7.
cells.use <- sample(colnames(sample[, sample$seurat_clusters %in% c("1", "5", "7")]), 1000)
p <- SCpubr::do_DimPlot(sample = sample,
cells.highlight = cells.use,
sizes.highlight = 1)
p
# Using ncol = 5 to maintain some of the proportions.
p <- Seurat::DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5)
p
# Using ncol = 5 to maintain some of the proportions.
# Using legend = F to remove unwanted repeated legends.
p <- SCpubr::do_DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5,
legend = F,
fontsize = 24)
p
# Create a color scale for the unique values in seurat clusters.
colors <- c("0" = "#001219",
"1" = "#005f73",
"2" = "#0a9396",
"3" = "#94d2bd",
"4" = "#e9d8a6",
"5" = "#ee9b00",
"6" = "#ca6702",
"7" = "#bb3e03",
"8" = "#ae2012",
"9" = "#9b2226")
p1 <- SCpubr::do_DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5,
legend = F,
colors.use = colors,
fontsize = 24)
p2 <- SCpubr::do_DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5,
legend = F,
colors.use = "#008080",
fontsize = 24)
p1 / p2
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
# Modified color scale.
p <- SCpubr::do_CorrelationPlot(sample = sample,
column_names_rot = 0,
colors.use = colortools::opposite("steelblue", plot = F))
p
# Rotated axis labels.
p <- SCpubr::do_CorrelationPlot(sample = sample,
column_names_rot = 0)
p
# Rotated axis labels.
p <- SCpubr::do_CorrelationPlot(sample = sample,
column_names_rot = 0)
# Rotated axis labels.
p <- SCpubr::do_CorrelationPlot(sample = sample,
column_names_rot = 0)
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
# Rotated axis labels.
p <- SCpubr::do_CorrelationPlot(sample = sample,
column_names_rot = 0)
p
