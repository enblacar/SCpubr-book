horizontal = T)
SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = F,
plot.title = "Number of cells per cluster",
horizontal = T,)
SCpubr::do_BarPlot(sample = sample,
features = "seurat_clusters",
legend = F,
plot.title = "Number of cells per cluster",
horizontal = T,
plot_line_guides = F)
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE)
p
features.use <- c("CD14", "CD8A")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
return_only_joint = TRUE,
plot.title = "Joint density CD14-CD8A")
p
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
individual.titles = c("Plot A",
NA,
"Combined density"),
plot.title = "Density analysis")
p
p1 <- Seurat::DotPlot(sample,
features = "CD14")
p2 <- Seurat::DotPlot(sample,
features = "nCount_RNA")
p1 | p2
p1 <- SCpubr::do_DotPlot(sample = sample,
features = "CD14")
p2 <- SCpubr::do_DotPlot(sample = sample,
features = "nFeature_RNA")
p1 | p2
rm(p)
rm(p1)
rm(p2)
p1 <- SCpubr::do_DotPlot(sample = sample,
features = "CD14")
p2 <- SCpubr::do_DotPlot(sample = sample,
features = "nFeature_RNA")
p1 | p2
genes <- c("IL7R", "CCR7", "CD14", "LYZ",
"S100A4", "MS4A1", "CD8A", "FCGR3A",
"MS4A7", "GNLY", "NKG7", "FCER1A",
"CST3", "PPBP")
p <- SCpubr::do_DotPlot(sample = sample,
features = genes)
p
genes <- list("Naive CD4+ T" = c("IL7R", "CCR7"),
"CD14+ Mono" = c("CD14", "LYZ"),
"Memory CD4+" = c("S100A4"),
"B" = c("MS4A1"),
"CD8+ T" = c("CD8A"),
"FCGR3A+ Mono" = c("FCGR3A", "MS4A7"),
"NK" = c("GNLY", "NKG7"),
"DC" = c("FCER1A", "CST3"),
"Platelet" = c("PPBP"))
p <- SCpubr::do_DotPlot(sample = sample,
features = genes)
p
genes <- list("Naive CD4+ T" = c("IL7R", "CCR7"),
"CD14+ Mono" = c("CD14", "LYZ"),
"Memory CD4+" = c("S100A4"),
"B" = c("MS4A1"),
"CD8+ T" = c("CD8A"),
"FCGR3A+ Mono" = c("FCGR3A", "MS4A7"),
"NK" = c("GNLY", "NKG7"),
"DC" = c("FCER1A", "CST3"),
"Platelet" = c("PPBP"))
p1 <- SCpubr::do_DotPlot(sample = sample,
features = genes,
plot.title = "Not clustered")
p2 <- SCpubr::do_DotPlot(sample = sample,
features = genes,
cluster.idents = TRUE,
plot.title = "Clustered")
p1 / p2
genes <- c("IL7R", "CCR7", "CD14", "LYZ",
"S100A4", "MS4A1", "CD8A", "FCGR3A",
"MS4A7", "GNLY", "NKG7", "FCER1A",
"CST3", "PPBP")
p1 <- SCpubr::do_DotPlot(sample = sample,
features = genes,
plot.title = "Not clustered",
flip = T)
p2 <- SCpubr::do_DotPlot(sample = sample,
features = genes,
cluster.idents = TRUE,
plot.title = "Clustered",
flip = T)
p1 | p2
genes <- c("IL7R", "CCR7", "CD14", "LYZ",
"S100A4", "MS4A1", "CD8A", "FCGR3A",
"MS4A7", "GNLY", "NKG7", "FCER1A",
"CST3", "PPBP")
p1 <- SCpubr::do_DotPlot(sample = sample,
features = genes,
plot.title = "Not clustered",
flip = T)
p2 <- SCpubr::do_DotPlot(sample = sample,
features = genes,
cluster.idents = TRUE,
plot.title = "Clustered",
flip = T,
rotate_x_labels = T)
p1 | p2
genes <- c("IL7R", "CCR7", "CD14", "LYZ",
"S100A4", "MS4A1", "CD8A", "FCGR3A",
"MS4A7", "GNLY", "NKG7", "FCER1A",
"CST3", "PPBP")
p <- SCpubr::do_DotPlot(sample = sample,
features = genes,
colors.use = c("#001219", "#e9d8a6"))
p
SCpubr::do_DotPlot(sample = sample,
features = genes,
cluster.idents = TRUE,
plot.title = "Clustered",
flip = T,
rotate_x_labels = T)
SCpubr::do_DotPlot(sample = sample,
features = genes,
cluster.idents = TRUE,
plot.title = "Clustered",
flip = T,
rotate_x_labels = T)
SCpubr::do_DotPlot(sample = sample,
features = genes,
cluster.idents = TRUE,
plot.title = "Clustered",
flip = T,
rotate_x_labels = T)
p1 <- SCpubr::do_DimPlot(sample = sample,
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
library(magrittr)
p1 <- SCpubr::do_DimPlot(sample = sample,
reduction = "pca",
label = T,
legend = F,
dims = c(1, 2))
p2 <- SCpubr::do_DimPlot(sample = sample,
reduction = "pca",
label = T,
legend = F,
dims = c(3, 4))
p3 <- SCpubr::do_BeeSwarmPlot(sample = sample,
feature_to_rank = "PC_1",
group.by = "seurat_clusters",
continuous_feature = F)
p4 <- SCpubr::do_BeeSwarmPlot(sample = sample,
feature_to_rank = "PC_4",
group.by = "seurat_clusters",
continuous_feature = F)
(p1 | p3) / (p2 | p4)
p1 <- SCpubr::do_DimPlot(sample = sample,
reduction = "pca",
label = T,
legend = F,
dims = c(1, 2))
p2 <- SCpubr::do_DimPlot(sample = sample,
reduction = "pca",
label = T,
legend = F,
dims = c(3, 4))
p3 <- SCpubr::do_BeeSwarmPlot(sample = sample,
feature_to_rank = "PC_1",
group.by = "seurat_clusters",
continuous_feature = F)
p4 <- SCpubr::do_BeeSwarmPlot(sample = sample,
feature_to_rank = "PC_4",
group.by = "seurat_clusters",
continuous_feature = F)
(p1 | p3) / (p2 | p4)
# Clusters to exclude.
clusters_exclude <- c("0", "3", "5", "7", "8", "9")
# Keep the original coloring.
cols.use <- colorspace::qualitative_hcl(length(levels(sample)),
palette = "Dark 3")
names(cols.use) <- levels(sample)
# Only provide the needed colors. If more are provided, an error is thrown.
cols.use <- cols.use[!(names(cols.use) %in% clusters_exclude)]
p1 <- SCpubr::do_DimPlot(sample = sample[, !(sample$seurat_clusters %in% clusters_exclude)],
reduction = "pca",
label = T,
legend = F,
dims = c(3, 4),
colors.use = cols.use)
p2 <- SCpubr::do_BeeSwarmPlot(sample = sample[, !(sample$seurat_clusters %in% clusters_exclude)],
feature_to_rank = "PC_4",
group.by = "seurat_clusters",
continuous_feature = F,
colors.use = cols.use)
p1 | p2
# Clusters to exclude.
clusters_exclude <- c("0", "1", "2", "3", "5", "7", "8", "9")
# Keep the original coloring.
cols.use <- colorspace::qualitative_hcl(length(levels(sample)),
palette = "Dark 3")
names(cols.use) <- levels(sample)
# Only provide the needed colors. If more are provided, an error is thrown.
cols.use <- cols.use[!(names(cols.use) %in% clusters_exclude)]
p1 <- SCpubr::do_DimPlot(sample = sample[, !(sample$seurat_clusters %in% clusters_exclude)],
reduction = "pca",
label = T,
legend = F,
dims = c(3, 4),
colors.use = cols.use)
p2 <- SCpubr::do_BeeSwarmPlot(sample = sample[, !(sample$seurat_clusters %in% clusters_exclude)],
feature_to_rank = "PC_4",
group.by = "seurat_clusters",
continuous_feature = F,
colors.use = cols.use)
p1 | p2
# Set up list of a genes to compute enrichment. Let's use a monocyte signature.
genes.use <- c("CD14", "LYZ")
# Compute enrichment and rename the output.
sample <- Seurat::AddModuleScore(sample,
features = genes.use,
name = "Monocyte_signature")
sample$Monocyte_signature <- sample$Monocyte_signature1
sample$Monocyte_signature1 <- NULL
p1 <- SCpubr::do_DimPlot(sample = sample,
label = T,
legend = F)
p2 <- SCpubr::do_FeaturePlot(sample = sample,
features = "Monocyte_signature")
p3 <- SCpubr::do_BeeSwarmPlot(sample = sample,
feature_to_rank = "Monocyte_signature",
group.by = "seurat_clusters",
continuous_feature = T)
p1 | p2 | p3
# Set up list of a genes to compute enrichment. Let's use a monocyte signature.
genes.use <- c("CD14", "LYZ")
# Compute enrichment and rename the output.
sample <- Seurat::AddModuleScore(sample,
features = genes.use,
name = "Monocyte_signature")
sample$Monocyte_signature <- sample$Monocyte_signature1
sample$Monocyte_signature1 <- NULL
p1 <- SCpubr::do_DimPlot(sample = sample,
label = T,
legend = F)
p2 <- SCpubr::do_FeaturePlot(sample = sample,
features = "Monocyte_signature")
p3 <- SCpubr::do_BeeSwarmPlot(sample = sample,
feature_to_rank = "Monocyte_signature",
group.by = "seurat_clusters",
continuous_feature = T)
p1 | p2 | p3
# Set up list of a genes to compute enrichment. Let's use a monocyte signature.
genes.use <- c("CD14", "LYZ")
# Compute enrichment and rename the output.
sample <- Seurat::AddModuleScore(sample,
features = genes.use,
name = "Monocyte_signature")
sample$Monocyte_signature <- sample$Monocyte_signature1
sample$Monocyte_signature1 <- NULL
p1 <- SCpubr::do_DimPlot(sample = sample,
label = T,
legend = F)
p2 <- SCpubr::do_FeaturePlot(sample = sample,
features = "Monocyte_signature")
p3 <- SCpubr::do_BeeSwarmPlot(sample = sample,
feature_to_rank = "Monocyte_signature",
group.by = "seurat_clusters",
continuous_feature = T,
legend.position = "bottom")
p1 | p2 | p3
# Create a color scale for the unique values in seurat clusters.
colors <- c("0" = "#001219",
"1" = "#005f73",
"2" = "#0a9396",
"3" = "#94d2bd",
"4" = "#e9d8a6",
"5" = "#ee9b00",
"6" = "#ca6702",
"7" = "#bb3e03",
"8" = "#ae2012",
"9" = "#9b2226")
p <- SCpubr::do_BeeSwarmPlot(sample = sample,
feature_to_rank = "Monocyte_signature",
group.by = "seurat_clusters",
colors.use = colors)
p
p1 <- SCpubr::do_BeeSwarmPlot(sample = sample, feature_to_rank = "Monocyte_signature", group.by = "seurat_clusters", continuous_feature = TRUE, fontsize = 10, viridis_color_map = "A", plot.title = "Magma")
p2 <- SCpubr::do_BeeSwarmPlot(sample = sample, feature_to_rank = "Monocyte_signature", group.by = "seurat_clusters", continuous_feature = TRUE, fontsize = 10, viridis_color_map = "B", plot.title = "Inferno")
p3 <- SCpubr::do_BeeSwarmPlot(sample = sample, feature_to_rank = "Monocyte_signature", group.by = "seurat_clusters", continuous_feature = TRUE, fontsize = 10, viridis_color_map = "C", plot.title = "Plasma")
p4 <- SCpubr::do_BeeSwarmPlot(sample = sample, feature_to_rank = "Monocyte_signature", group.by = "seurat_clusters", continuous_feature = TRUE, fontsize = 10, viridis_color_map = "D", plot.title = "Viridis")
p5 <- SCpubr::do_BeeSwarmPlot(sample = sample, feature_to_rank = "Monocyte_signature", group.by = "seurat_clusters", continuous_feature = TRUE, fontsize = 10, viridis_color_map = "E", plot.title = "Cividis")
p6 <- SCpubr::do_BeeSwarmPlot(sample = sample, feature_to_rank = "Monocyte_signature", group.by = "seurat_clusters", continuous_feature = TRUE, fontsize = 10, viridis_color_map = "F", plot.title = "Rocket")
p7 <- SCpubr::do_BeeSwarmPlot(sample = sample, feature_to_rank = "Monocyte_signature", group.by = "seurat_clusters", continuous_feature = TRUE, fontsize = 10, viridis_color_map = "G", plot.title = "Mako")
p8 <- SCpubr::do_BeeSwarmPlot(sample = sample, feature_to_rank = "Monocyte_signature", group.by = "seurat_clusters", continuous_feature = TRUE, fontsize = 10, viridis_color_map = "H", plot.title = "Turbo")
p <- patchwork::wrap_plots(list(p1, p2, p3, p4, p5, p6, p7, p8), ncol = 2, byrow = TRUE)
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "C")
patchwork::wrap_plots(p, ncol = 2)
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "C")
patchwork::wrap_plots(p, ncol = 2)
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "C")
patchwork::wrap_plots(p, ncol = 2)
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "C")
patchwork::wrap_plots(p, ncol = 2)
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
nterms = 15)
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p1 <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
nterms = 15)
p2 <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
nterms = 15,
nchar_wrap = 30)
p <- p1 | p2
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p1 <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
nterms = 15)
p2 <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
nterms = 15,
nchar_wrap = 30)
p <- p1 | p2
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p1 <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
nterms = 15)
p2 <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
nterms = 15,
nchar_wrap = 30)
p <- p1 | p2
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p1 <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
nterms = 15)
p2 <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
nterms = 15,
nchar_wrap = 30)
p <- p1 | p2
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
nterms = 15)
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
colors.use = c("#e9d8a6", "#9b2226"))
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
colors.use = c("#e9d8a6", "#9b2226"))
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "C")
patchwork::wrap_plots(p, ncol = 2)
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
fontsize = 18,
dbs_use = "GO_Biological_Process_2021",
colors.use = c("#e9d8a6", "#9b2226"))
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
fontsize = 22,
dbs_use = "GO_Biological_Process_2021",
colors.use = c("#e9d8a6", "#9b2226"))
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
colors.use = c("#e9d8a6", "#9b2226"))
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
text_labels_size = 4,
dbs_use = "GO_Biological_Process_2021",
colors.use = c("#e9d8a6", "#9b2226"))
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
text_labels_size = 8,
dbs_use = "GO_Biological_Process_2021",
colors.use = c("#e9d8a6", "#9b2226"))
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
text_labels_size = 6,
dbs_use = "GO_Biological_Process_2021",
colors.use = c("#e9d8a6", "#9b2226"))
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
text_labels_size = 6,
dbs_use = "GO_Biological_Process_2021",
colors.use = c("#e9d8a6", "#9b2226"))
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
text_labels_size = 6,
dbs_use = "GO_Biological_Process_2021",
colors.use = c("#e9d8a6", "#9b2226"))
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p1 <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
colors.use = c("#e9d8a6", "#9b2226"))
p2 <- SCpubr::do_TermEnrichmentPlot(genes = genes,
text_labels_size = 6,
dbs_use = "GO_Biological_Process_2021",
colors.use = c("#e9d8a6", "#9b2226"))
p <- p1 | p2
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
colors.use = c("#e9d8a6", "#9b2226"))
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p1 <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
nterms = 15)
p2 <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
nterms = 15,
nchar_wrap = 30)
p <- p1 | p2
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
colors.use = c("#e9d8a6", "#9b2226"))
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
colors.use = c("#e9d8a6", "#9b2226"))
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p1 <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
colors.use = c("#e9d8a6", "#9b2226"))
p2 <- SCpubr::do_TermEnrichmentPlot(genes = genes,
text_labels_size = 6,
dbs_use = "GO_Biological_Process_2021",
colors.use = c("#e9d8a6", "#9b2226"))
p <- p1 | p2
p
# Genes related to breast cancer.
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
nterms = 15)
p
genes <- c("ABCB1", "ABCG2", "AHR", "AKT1", "AR")
p <- SCpubr::do_TermEnrichmentPlot(genes = genes,
dbs_use = "GO_Biological_Process_2021",
nterms = 15)
p
