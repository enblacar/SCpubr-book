p1 / p2
# Select 1000 random cells out of clusters 1, 5 and 7.
cells.use <- sample(colnames(sample[, sample$seurat_clusters %in% c("1", "5", "7")]), 1000)
p1 <- SCpubr::do_DimPlot(sample = sample,
cells.highlight = cells.use)
p2 <- SCpubr::do_DimPlot(sample = sample,
cells.highlight = cells.use,
colors.use = "steelblue")
p1 | p2
# Clusters to exclude.
clusters_exclude <- c("0", "3", "5", "7", "8", "9")
# Keep the original coloring.
cols.use <- colortools::setColors("steelblue",
length(levels(sample)))
names(cols.use) <- levels(sample)
p1 <- SCpubr::do_DimPlot(sample = sample[, !(sample$seurat_clusters %in% clusters_exclude)],
reduction = "pca",
label = T,
legend = F,
dims = c(3, 4),
colors.use = cols.use)
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p <- Seurat::DimPlot(sample)
p
p <- Seurat::DimPlot(sample,
shuffle = T)
p
p <- Seurat::DimPlot(sample,
shuffle = T) +
Seurat::NoAxes()
p
p <- Seurat::DimPlot(sample,
shuffle = T,
pt.size = 0.5) +
Seurat::NoAxes()
p
p <- Seurat::DimPlot(sample,
shuffle = T,
pt.size = 0.5) +
Seurat::NoAxes() +
ggplot2::theme(legend.text = ggplot2::element_text(size = 12,
face = "bold"),
legend.title = ggplot2::element_text(size = 12,
face = "bold"))
p
p <- Seurat::DimPlot(sample,
shuffle = T,
pt.size = 0.5) +
Seurat::NoAxes() +
ggplot2::ggtitle("My awesome SC dataset") +
ggplot2::theme(legend.text = ggplot2::element_text(size = 12,
face = "bold"),
legend.title = ggplot2::element_text(size = 12,
face = "bold"))
p
p <- Seurat::DimPlot(sample,
shuffle = T,
pt.size = 0.5) +
Seurat::NoAxes() +
ggplot2::ggtitle("My awesome SC dataset") +
ggplot2::theme(plot.title = ggplot2::element_text(size = 16,
face = "bold",
hjust = 0.5),
legend.text = ggplot2::element_text(size = 12,
face = "bold"),
legend.title = ggplot2::element_text(size = 12,
face = "bold"))
p
num_clusters <- length(unique(sample$seurat_clusters))
color_scale <- colortools::setColors("#457b9d", num_clusters)
names(color_scale) <- sort(unique(sample$seurat_clusters))
p <- Seurat::DimPlot(sample,
shuffle = T,
pt.size = 0.5,
cols = color_scale) +
Seurat::NoAxes() +
ggplot2::ggtitle("My awesome SC dataset") +
ggplot2::theme(plot.title = ggplot2::element_text(size = 16,
face = "bold",
hjust = 0.5),
legend.text = ggplot2::element_text(size = 12,
face = "bold"),
legend.title = ggplot2::element_text(size = 12,
face = "bold"))
p
p <- SCpubr::do_DimPlot(sample = sample)
p
p <- SCpubr::do_DimPlot(sample = sample,
plot.title = "My awesome SC data set")
p
p <- SCpubr::do_DimPlot(sample = sample,
plot.title = "My awesome SC data set",
legend.position = "left",
legend.ncol = 2)
p
p <- Seurat::DimPlot(sample,
label = T)
p
p <- SCpubr::do_DimPlot(sample = sample,
label = TRUE,
legend = FALSE)
p
# Create a color scale for the unique values in seurat clusters.
colors <- c("0" = "#001219",
"1" = "#005f73",
"2" = "#0a9396",
"3" = "#94d2bd",
"4" = "#e9d8a6",
"5" = "#ee9b00",
"6" = "#ca6702",
"7" = "#bb3e03",
"8" = "#ae2012",
"9" = "#9b2226")
p <- SCpubr::do_DimPlot(sample = sample,
colors.use = colors)
p
# Select 1000 random cells out of clusters 1, 5 and 7.
cells.use <- sample(colnames(sample[, sample$seurat_clusters %in% c("1", "5", "7")]), 1000)
p <- Seurat::DimPlot(sample,
cells.highlight = cells.use)
p
# Select 1000 random cells out of clusters 1, 5 and 7.
cells.use <- sample(colnames(sample[, sample$seurat_clusters %in% c("1", "5", "7")]), 1000)
p1 <- SCpubr::do_DimPlot(sample = sample,
cells.highlight = cells.use)
p2 <- SCpubr::do_DimPlot(sample = sample,
cells.highlight = cells.use,
colors.use = "steelblue")
p1 | p2
# Select 1000 random cells out of clusters 1, 5 and 7.
cells.use <- sample(colnames(sample[, sample$seurat_clusters %in% c("1", "5", "7")]), 1000)
p <- SCpubr::do_DimPlot(sample = sample,
cells.highlight = cells.use,
sizes.highlight = 1)
p
# Using ncol = 5 to maintain some of the proportions.
p <- Seurat::DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5)
p
# Using ncol = 5 to maintain some of the proportions.
# Using legend = F to remove unwanted repeated legends.
p <- SCpubr::do_DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5,
legend = F)
p
# Create a color scale for the unique values in seurat clusters.
colors <- c("0" = "#001219",
"1" = "#005f73",
"2" = "#0a9396",
"3" = "#94d2bd",
"4" = "#e9d8a6",
"5" = "#ee9b00",
"6" = "#ca6702",
"7" = "#bb3e03",
"8" = "#ae2012",
"9" = "#9b2226")
p1 <- SCpubr::do_DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5,
legend = F,
colors.use = colors)
p2 <- SCpubr::do_DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5,
legend = F,
colors.use = "#008080")
p1 / p2
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
# Clusters to exclude.
clusters_exclude <- c("0", "3", "5", "7", "8", "9")
# Keep the original coloring.
cols.use <- colortools::setColors("steelblue",
length(levels(sample)))
names(cols.use) <- levels(sample)
p1 <- SCpubr::do_DimPlot(sample = sample[, !(sample$seurat_clusters %in% clusters_exclude)],
reduction = "pca",
label = T,
legend = F,
dims = c(3, 4),
colors.use = cols.use)
debug(SCpubr::do_DimPlot(sample = sample[, !(sample$seurat_clusters %in% clusters_exclude)],
reduction = "pca",
label = T,
legend = F,
dims = c(3, 4),
colors.use = cols.use))
cols.use[!(names(cols.use) %in% clusters_exclude)]
# Clusters to exclude.
clusters_exclude <- c("0", "3", "5", "7", "8", "9")
# Keep the original coloring.
cols.use <- colortools::setColors("steelblue",
length(levels(sample)))
names(cols.use) <- levels(sample)
# Only provide the needed colors. If more are provided, an error is thrown.
cols.use <- cols.use[!(names(cols.use) %in% clusters_exclude)]
p1 <- SCpubr::do_DimPlot(sample = sample[, !(sample$seurat_clusters %in% clusters_exclude)],
reduction = "pca",
label = T,
legend = F,
dims = c(3, 4),
colors.use = cols.use)
p2 <- SCpubr::do_BeeSwarmPlot(sample = sample[, !(sample$seurat_clusters %in% clusters_exclude)],
feature_to_rank = "PC_4",
group.by = "seurat_clusters",
continuous_feature = F,
colors.use = cols.use)
p1 | p2
# Clusters to exclude.
clusters_exclude <- c("0", "1", "2", "3", "5", "7", "8", "9")
# Keep the original coloring.
cols.use <- colortools::setColors("steelblue", length(levels(sample)))
names(cols.use) <- levels(sample)
# Only provide the needed colors. If more are provided, an error is thrown.
cols.use <- cols.use[!(names(cols.use) %in% clusters_exclude)]
p1 <- SCpubr::do_DimPlot(sample = sample[, !(sample$seurat_clusters %in% clusters_exclude)],
reduction = "pca",
label = T,
legend = F,
dims = c(3, 4),
colors.use = cols.use)
p2 <- SCpubr::do_BeeSwarmPlot(sample = sample[, !(sample$seurat_clusters %in% clusters_exclude)],
feature_to_rank = "PC_4",
group.by = "seurat_clusters",
continuous_feature = F,
colors.use = cols.use)
p1 | p2
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
combine = F)[[3]]
SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
combine = F)[[length(features + 1)]]
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
combine = F)
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
features.use <- c("CD14", "CD8A")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
return_only_joint = T)
p
features.use <- c("CD14", "CD8A")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
return_only_joint = T,
individual.titles = NA)
p
features.use <- c("CD14", "CD8A")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
return_only_joint = T,
individual.titles = "pepe")
p
features.use <- c("CD14", "CD8A")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
return_only_joint = T,
plot.title = "pepe")
p
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
features.use <- c("CD14", "CD8A")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
return_only_joint = T)
p
features.use <- c("CD14", "CD8A")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
return_only_joint = T,
individual.titles = "pepe")
p
features.use <- c("CD14", "CD8A")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
return_only_joint = T,
individual.titles = NA)
p
features.use <- c("CD14", "CD8A")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
return_only_joint = T,
individual.titles = c(NA, NA))
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
features.use <- c("CD14", "CD8A")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
return_only_joint = T,
plot.title = "pepe")
p
features.use <- c("CD14", "CD8A")
p1 <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
return_only_joint = TRUE)
p2 <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
return_only_joint = TRUE,
plot.title = "Joint density CD14-CD8A")
p1 | p2
features.use <- c("CD14", "CD8A")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
return_only_joint = TRUE,
plot.title = "Joint density CD14-CD8A")
p
features.use <- c("CD14", "CD8A")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
return_only_joint = TRUE,
individual.titles = "Joint density CD14-CD8A")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
individual.titles = c("Plot A",
NA,
"Combined density"),
plot.title = "Density analysis")
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
individual.titles = c("Plot A",
NA,
"Combined density"),
plot.title = "Density analysis")
debug(SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
individual.titles = c("Plot A",
NA,
"Combined density"),
plot.title = "Density analysis"))
debug(SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
individual.titles = c("Plot A",
NA,
"Combined density"),
plot.title = "Density analysis"))
!(is.null(return_only_joint)
)
isTRUE(return_only_joint)
isTRUE(NULL)
!(is.null(return_only_joint) & isTRUE(return_only_joint))
!(is.null(return_only_joint)) & isTRUE(return_only_joint)
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p <- SCpubr::do_NebulosaPlot(sample = sample,
features = c("CD14", "CD8A"),
joint = TRUE,
individual.titles = c("Plot A",
NA,
"Combined density"),
plot.title = "Density analysis")
p
p <- SCpubr::do_VlnPlot(sample = sample,
features = c("nCount_RNA"),
rotate_x_labels = TRUE,)
p
SCpubr::do_VlnPlot(sample = sample,
features = c("nCount_RNA", "nFeature_RNA"),
rotate_x_labels = TRUE,
ncol = 1)
table(data)
citation("ggpubr")
citation("patchwork")
citation("SCpubr")
citation("colortools")
sample <- readRDS("/b06x-isilon/b06x-g/G703/eblanco/projects/test_SC_datasets/sc_dataset.rds")
p <- Seurat::DimPlot(sample,
shuffle = T)
p
p <- Seurat::DimPlot(sample,
shuffle = T)
p
ggplot2::ggsave("~/plot.pdf", plot = p, device = "pdf", height = 7, width = 8, dpi = 300)
p <- Seurat::DimPlot(sample,
shuffle = T)
p
ggplot2::ggsave("~/eblanco/projects/plot.pdf", plot = p, device = "pdf", height = 7, width = 8, dpi = 300)
p <- SCpubr::do_DimPlot(sample = sample)
p
ggplot2::ggsave("~/eblanco/projects/plot.pdf", plot = p, device = "pdf", height = 7, width = 8, dpi = 300)
# Using ncol = 5 to maintain some of the proportions.
p <- Seurat::DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5)
p
ggplot2::ggsave("~/eblanco/projects/plot.pdf", plot = p, device = "pdf", height = 5, width = 20, dpi = 300)
# Using ncol = 5 to maintain some of the proportions.
p <- Seurat::DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5)
p
ggplot2::ggsave("~/eblanco/projects/plot.pdf", plot = p, device = "pdf", height = 8, width = 16, dpi = 300)
# Using ncol = 5 to maintain some of the proportions.
# Using legend = F to remove unwanted repeated legends.
p <- SCpubr::do_DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5,
legend = F)
p
ggplot2::ggsave("~/eblanco/projects/plot.pdf", plot = p, device = "pdf", height = 8, width = 16, dpi = 300)
# Using ncol = 5 to maintain some of the proportions.
# Using legend = F to remove unwanted repeated legends.
p <- SCpubr::do_DimPlot(sample,
split.by = "seurat_clusters",
ncol = 5,
legend = F)
p
ggplot2::ggsave("~/eblanco/projects/plot.pdf", plot = p, device = "png", height = 8, width = 16, dpi = 300)
ggplot2::ggsave("~/eblanco/projects/plot.png", plot = p, device = "png", height = 8, width = 16, dpi = 300)
citation("viridis")
p <- Seurat::FeaturePlot(sample,
features = "CD14")
p
ggplot2::ggsave("~/eblanco/projects/plot.png", plot = p, device = "png", height = 8, width = 8, dpi = 300)
p <- SCpubr::do_FeaturePlot(sample = sample,
features = "CD14",
plot.title = "CD14")
p
ggplot2::ggsave("~/eblanco/projects/plot.png", plot = p, device = "png", height = 8, width = 8, dpi = 300)
p <- SCpubr::do_FeaturePlot(sample = sample,
idents.highlight = levels(sample)[!(levels(sample) %in% c("2", "5", "6", "7", "8"))],
features = c("CD14"),
plot.title = "CD14")
p
ggplot2::ggsave("~/eblanco/projects/plot.png", plot = p, device = "png", height = 8, width = 8, dpi = 300)
p <- SCpubr::do_FeaturePlot(sample = sample,
idents.highlight = levels(sample)[!(levels(sample) %in% c("0", "5", "6", "7", "8"))],
features = c("CD14"),
plot.title = "CD14")
p
ggplot2::ggsave("~/eblanco/projects/plot.png", plot = p, device = "png", height = 8, width = 8, dpi = 300)
p <- Seurat::FeaturePlot(sample,
features = "CD14",
split.by = "new_clusters")
p <- Seurat::FeaturePlot(sample,
features = "CD14",
split.by = "seurat_clusters")
p
ggplot2::ggsave("~/eblanco/projects/plot.png", plot = p, device = "png", height = 8, width = 24, dpi = 300)
ggplot2::ggsave("~/eblanco/projects/plot.png", plot = p, device = "png", height = 8, width = 12, dpi = 300)
sample$new_clusters <- as.character(sample$seurat_clusters)
sample$new_clusters[sample$new_clusters %in% c("0", "1", "2", "3")] <- "Cluster 1"
sample$new_clusters[sample$new_clusters %in% c("4", "5", "6")] <- "Cluster 2"
sample$new_clusters[sample$new_clusters %in% c("7", "8", "9")] <- "Cluster 3"
p <- Seurat::FeaturePlot(sample,
features = "CD14",
split.by = "new_clusters",
ncol = 5)
p
ggplot2::ggsave("~/eblanco/projects/plot.png", plot = p, device = "png", height = 8, width = 24, dpi = 300)
p <- SCpubr::do_FeaturePlot(sample = sample,
features = "CD14",
split.by = "new_clusters")
p
ggplot2::ggsave("~/eblanco/projects/plot.png", plot = p, device = "png", height = 8, width = 24, dpi = 300)
?SCpubr::do_FeaturePlot
p <- SCpubr::do_FeaturePlot(sample = sample,
idents.highlight = levels(sample)[!(levels(sample) %in% c("2", "5", "8"))],
features = c("CD14"),
fontsize = 18)
p
ggplot2::ggsave("~/eblanco/projects/plot.png", plot = p, device = "png", height = 8, width = 24, dpi = 300)
ggplot2::ggsave("~/eblanco/projects/plot.png", plot = p, device = "png", height = 8, width = 8, dpi = 300)
p <- SCpubr::do_FeaturePlot(sample = sample,
features = "LYN",
split.by = "new_clusters",
fontsize = 18)
p
ggplot2::ggsave("~/eblanco/projects/plot.png", plot = p, device = "png", height = 8, width = 24, dpi = 300)
p <- SCpubr::do_FeaturePlot(sample = sample,
features = "CD14",
split.by = "new_clusters",
fontsize = 18)
p
ggplot2::ggsave("~/eblanco/projects/plot.png", plot = p, device = "png", height = 8, width = 24, dpi = 300)
p <- SCpubr::do_FeaturePlot(sample = sample,
features = "CD14",
fontsize = 18)
p
ggplot2::ggsave("~/eblanco/projects/plot.png", plot = p, device = "png", height = 8, width = 8, dpi = 300)
p <- SCpubr::do_FeaturePlot(sample = sample,
idents.highlight = levels(sample)[!(levels(sample) %in% c("0", "2", "5", "8"))],
features = c("CD14"),
fontsize = 18)
p
ggplot2::ggsave("~/eblanco/projects/plot.png", plot = p, device = "png", height = 8, width = 8, dpi = 300)
p <- SCpubr::do_FeaturePlot(sample = sample,
idents.highlight = levels(sample)[!(levels(sample) %in% c("0", "2", "5", "6", "7", "8"))],
features = c("CD14"),
fontsize = 18)
p
ggplot2::ggsave("~/eblanco/projects/plot.png", plot = p, device = "png", height = 8, width = 8, dpi = 300)
