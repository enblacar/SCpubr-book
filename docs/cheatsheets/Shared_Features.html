<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.324">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>SCpubr - Shared features across functions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../functions/DimPlots.html" rel="prev">
<link href="..//images/SCpubr_logo_favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<meta property="og:title" content="SCpubr - Shared features across functions">
<meta property="og:description" content="">
<meta property="og:image" content="https://enblacar.github.io/SCpubr-book/cheatsheets/Shared_Features_files/figure-html/unnamed-chunk-5-1.png">
<meta property="og:site-name" content="SCpubr">
<meta property="og:image:height" content="12000">
<meta property="og:image:width" content="15000">
<meta name="twitter:title" content="SCpubr - Shared features across functions">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://enblacar.github.io/SCpubr-book/cheatsheets/Shared_Features_files/figure-html/unnamed-chunk-5-1.png">
<meta name="twitter:image-height" content="12000">
<meta name="twitter:image-width" content="15000">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../cheatsheets/Shared_Features.html">Cheatsheets</a></li><li class="breadcrumb-item"><a href="../cheatsheets/Shared_Features.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Shared features across functions</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">SCpubr <a href="https://github.com/enblacar/SCpubr/blob/main/NEWS.md"><code>v2.0.0</code></a></a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/enblacar/SCpubr/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Getting started</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About this package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../preface/Installation-guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Installation guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../preface/Dataset.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dataset used</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Functions</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../functions/DimPlots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Dim plots</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Cheatsheets</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cheatsheets/Shared_Features.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Shared features across functions</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#basic-parameters" id="toc-basic-parameters" class="nav-link active" data-scroll-target="#basic-parameters">Basic parameters</a></li>
  <li><a href="#change-colors-categorical" id="toc-change-colors-categorical" class="nav-link" data-scroll-target="#change-colors-categorical">Change colors | categorical</a></li>
  <li><a href="#change-colors-continuous" id="toc-change-colors-continuous" class="nav-link" data-scroll-target="#change-colors-continuous">Change colors | continuous</a></li>
  <li>
<a href="#change-colors-divering" id="toc-change-colors-divering" class="nav-link" data-scroll-target="#change-colors-divering">Change colors | divering</a>
  <ul class="collapse">
<li><a href="#flip-the-plots" id="toc-flip-the-plots" class="nav-link" data-scroll-target="#flip-the-plots">Flip the plots</a></li>
  <li><a href="#control-plot-aesthetics" id="toc-control-plot-aesthetics" class="nav-link" data-scroll-target="#control-plot-aesthetics">Control plot aesthetics</a></li>
  <li><a href="#control-legend-aesthetics" id="toc-control-legend-aesthetics" class="nav-link" data-scroll-target="#control-legend-aesthetics">Control legend aesthetics</a></li>
  <li><a href="#modify-plot-titles" id="toc-modify-plot-titles" class="nav-link" data-scroll-target="#modify-plot-titles">Modify plot titles</a></li>
  <li><a href="#control-grid-aesthetics" id="toc-control-grid-aesthetics" class="nav-link" data-scroll-target="#control-grid-aesthetics">Control grid aesthetics</a></li>
  <li><a href="#control-cell-borders" id="toc-control-cell-borders" class="nav-link" data-scroll-target="#control-cell-borders">Control cell borders</a></li>
  <li><a href="#plot-marginal-distributions" id="toc-plot-marginal-distributions" class="nav-link" data-scroll-target="#plot-marginal-distributions">Plot marginal distributions</a></li>
  <li><a href="#plot-density-contours-in-dimensional-reduction-visualizations" id="toc-plot-density-contours-in-dimensional-reduction-visualizations" class="nav-link" data-scroll-target="#plot-density-contours-in-dimensional-reduction-visualizations">Plot density contours in dimensional reduction visualizations</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Shared features across functions</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>In this package, there are a lot of shared functionalities across functions. The idea is to generate a common framework for people to intuitively know what to expect from current and new functions. Several functions will be used here to better illustrate the shared functionalities.</p>
<section id="basic-parameters" class="level2"><h2 class="anchored" data-anchor-id="basic-parameters">Basic parameters</h2>
<p>There are a handful of parameters needed to run mostly any function in <code>SCpubr</code>:</p>
<ul>
<li>
<code>sample</code>: Seurat object to use for plotting.</li>
<li>
<code>group.by</code>: Metadata variable to group the values to plot by.</li>
<li>
<code>split.by</code>: Metadata variable to split the values to plot by.</li>
<li>
<code>features</code>: Genes, metadata columns, dimensional reduction column names to use for plotting.</li>
<li>
<code>input_gene_list</code>: Named list with different gene sets to use for plotting.</li>
<li>
<code>assay</code>: Assay name to pull the data from.</li>
<li>
<code>slot</code>: Slot in <code>assay</code> to pull the data from.</li>
<li>
<code>reduction</code>: Which dimensional reduction to use for plottin.</li>
<li>
<code>dims</code>: A vector with numbers representing which dimensions of the dimensional reduction embedding to use.</li>
<li>
<code>na.value</code>: Color used for <code>NA</code> values.</li>
<li>
<code>raster</code>: Whether or not to rasterize an image.</li>
<li>
<code>raster.dpi</code>: Resolution of the rasterization.</li>
</ul></section><section id="change-colors-categorical" class="level2"><h2 class="anchored" data-anchor-id="change-colors-categorical">Change colors | categorical</h2>
<p><code>SCpubr</code> has a built-in custom color palette (used throughout this book) for <code>categorical variables</code>. However, it is very often the case that we do want our own color system in the plots. This is always achieved by using the <code>colors.use</code> parameter. The input to this parameter can vary depending of the function, but it is always one for the following three:</p>
<ul>
<li>A vector of <code>named values</code>. The names correspond to each of the unique values that the categorical variable to plot has, and the values are the colors corresponding to each of those values.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>            <span class="st">"B"</span> <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>            <span class="st">"C"</span> <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>A <code>named list</code> of vectors of <code>named values</code>. In more complex scenarios, we have many different categorical color palettes. For this, the names of the list will correspond to the names of the categorical variables stored in the <code>metadata</code> of the <code>Seurat object</code>, and the values will be the vectors of <code>named values</code>.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Variable 1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>                                <span class="st">"B"</span> <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>                                <span class="st">"C"</span> <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span>,</span>
<span>               <span class="st">"Varibale 2"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"D"</span> <span class="op">=</span> <span class="st">"pink"</span>,</span>
<span>                                <span class="st">"E"</span> <span class="op">=</span> <span class="st">"purple"</span>,</span>
<span>                                <span class="st">"F"</span> <span class="op">=</span> <span class="st">"brown"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With this, here are some examples of how to use it:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a color scale for the unique values in seurat clusters.</span></span>
<span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"#001219"</span>,</span>
<span>            <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#005f73"</span>,</span>
<span>            <span class="st">"2"</span> <span class="op">=</span> <span class="st">"#0a9396"</span>,</span>
<span>            <span class="st">"3"</span> <span class="op">=</span> <span class="st">"#94d2bd"</span>,</span>
<span>            <span class="st">"4"</span> <span class="op">=</span> <span class="st">"#e9d8a6"</span>,</span>
<span>            <span class="st">"5"</span> <span class="op">=</span> <span class="st">"#ee9b00"</span>,</span>
<span>            <span class="st">"6"</span> <span class="op">=</span> <span class="st">"#ca6702"</span>,</span>
<span>            <span class="st">"7"</span> <span class="op">=</span> <span class="st">"#bb3e03"</span>,</span>
<span>            <span class="st">"8"</span> <span class="op">=</span> <span class="st">"#ae2012"</span>,</span>
<span>            <span class="st">"9"</span> <span class="op">=</span> <span class="st">"#9b2226"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_DimPlot.html">do_DimPlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                        colors.use <span class="op">=</span> <span class="va">colors</span>,</span>
<span>                        font.size <span class="op">=</span> <span class="fl">24</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="Shared_Features_files/figure-html/unnamed-chunk-5-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Using a vector of named values.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a color scale for the unique values in seurat clusters.</span></span>
<span><span class="va">colors1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"#001219"</span>,</span>
<span>             <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#005f73"</span>,</span>
<span>             <span class="st">"2"</span> <span class="op">=</span> <span class="st">"#0a9396"</span>,</span>
<span>             <span class="st">"3"</span> <span class="op">=</span> <span class="st">"#94d2bd"</span>,</span>
<span>             <span class="st">"4"</span> <span class="op">=</span> <span class="st">"#e9d8a6"</span>,</span>
<span>             <span class="st">"5"</span> <span class="op">=</span> <span class="st">"#ee9b00"</span>,</span>
<span>             <span class="st">"6"</span> <span class="op">=</span> <span class="st">"#ca6702"</span>,</span>
<span>             <span class="st">"7"</span> <span class="op">=</span> <span class="st">"#bb3e03"</span>,</span>
<span>             <span class="st">"8"</span> <span class="op">=</span> <span class="st">"#ae2012"</span>,</span>
<span>             <span class="st">"9"</span> <span class="op">=</span> <span class="st">"#9b2226"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">colors2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="st">"#669bbc"</span>,</span>
<span>             <span class="st">"B"</span> <span class="op">=</span> <span class="st">"#003049"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">colors3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"10K_pbmc"</span> <span class="op">=</span> <span class="st">"#83c5be"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">colors.use</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"seurat_clusters"</span> <span class="op">=</span> <span class="va">colors1</span>,</span>
<span>                   <span class="st">"annotation"</span> <span class="op">=</span> <span class="va">colors2</span>,</span>
<span>                   <span class="st">"orig.ident"</span> <span class="op">=</span> <span class="va">colors3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_SCExpressionHeatmap.html">do_SCExpressionHeatmap</a></span><span class="op">(</span><span class="va">sample</span>,</span>
<span>                                    features <span class="op">=</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/VariableFeatures.html">VariableFeatures</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span>
<span>                                    metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"seurat_clusters"</span>, </span>
<span>                                                 <span class="st">"annotation"</span>, </span>
<span>                                                 <span class="st">"orig.ident"</span><span class="op">)</span>,</span>
<span>                                    metadata.colors <span class="op">=</span> <span class="va">colors.use</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="Shared_Features_files/figure-html/unnamed-chunk-6-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Using a vector of named values.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="change-colors-continuous" class="level2"><h2 class="anchored" data-anchor-id="change-colors-continuous">Change colors | continuous</h2>
<p>For continuous variables, we do have a more complex system. First of all, <code>SCpubr</code> has implemented both <code>RColorBrewer</code> and <code>viridis</code> palettes, and use them interchangeably depending on the function.</p>
<ul>
<li>
<a href="https://search.r-project.org/CRAN/refmans/viridisLite/html/viridis.html">Viridis palettes</a>: Accepts both the long names and the shortened ones (i.e: A, B, C).</li>
<li>
<a href="https://r-graph-gallery.com/38-rcolorbrewers-palettes.html">RColorBrewer palettes</a>: Accepts the long names.</li>
</ul>
<p>To choose whether to use <code>viridis</code> or <code>RColorBrewer</code> palettes, you need to set up <code>use_viridis = TRUE/FALSE</code>. To indicate the color palette you want to use, there are two parameters:</p>
<ul>
<li>
<code>viridis.palette</code>: For <code>viridis</code> palettes.</li>
<li>
<code>sequential.palette</code>: For <code>RColorBrewer</code> palettes.</li>
</ul>
<p>And finally, you can also choose the <code>direction</code> of the scale. This is, whether you want to use the darker colors as lower values or not. For this, we have two more parameters:</p>
<ul>
<li>
<code>viridis.direction</code>: For <code>viridis</code> palettes.</li>
<li>
<code>sequential.direction</code>: For <code>RColorBrewer</code> palettes.</li>
</ul>
<p>It is easier to understand with some examples:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             viridis.palette <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                             viridis.direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             viridis.palette <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                             viridis.direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             viridis.palette <span class="op">=</span> <span class="st">"C"</span>,</span>
<span>                             viridis.direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             viridis.palette <span class="op">=</span> <span class="st">"D"</span>,</span>
<span>                             viridis.direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             viridis.palette <span class="op">=</span> <span class="st">"E"</span>,</span>
<span>                             viridis.direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p6</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             viridis.palette <span class="op">=</span> <span class="st">"F"</span>,</span>
<span>                             viridis.direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p7</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             viridis.palette <span class="op">=</span> <span class="st">"G"</span>,</span>
<span>                             viridis.direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p8</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             viridis.palette <span class="op">=</span> <span class="st">"H"</span>,</span>
<span>                             viridis.direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p3</span> <span class="op">|</span> <span class="va">p4</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p5</span> <span class="op">|</span> <span class="va">p6</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p7</span> <span class="op">|</span> <span class="va">p8</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="Shared_Features_files/figure-html/unnamed-chunk-7-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Modify viridis palettes, also use different directions.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             sequential.palette <span class="op">=</span> <span class="st">"YlGnBu"</span>,</span>
<span>                             sequential.direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             sequential.palette <span class="op">=</span> <span class="st">"YlOrBr"</span>,</span>
<span>                             sequential.direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             sequential.palette <span class="op">=</span> <span class="st">"YlOrRd"</span>,</span>
<span>                             sequential.direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             sequential.palette <span class="op">=</span> <span class="st">"Reds"</span>,</span>
<span>                             sequential.direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             sequential.palette <span class="op">=</span> <span class="st">"Purples"</span>,</span>
<span>                             sequential.direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p6</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             sequential.palette <span class="op">=</span> <span class="st">"Blues"</span>,</span>
<span>                             sequential.direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p7</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             sequential.palette <span class="op">=</span> <span class="st">"Oranges"</span>,</span>
<span>                             sequential.direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p8</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             sequential.palette <span class="op">=</span> <span class="st">"Greys"</span>,</span>
<span>                             sequential.direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p3</span> <span class="op">|</span> <span class="va">p4</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p5</span> <span class="op">|</span> <span class="va">p6</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p7</span> <span class="op">|</span> <span class="va">p8</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="Shared_Features_files/figure-html/unnamed-chunk-8-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Modify sequential palettes, also use different directions.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="change-colors-divering" class="level1"><h1>Change colors | divering</h1>
<p>Finally, there is a special case of sequential palettes in which there is a clear empashis on the two ends of the scale. This is a very usual case in scaled data or data that has a center and data data deviates from it. Such data can be generated in <code>SCpubr</code> by using <code>enforce_symmetry = TRUE</code> in many of the functions.</p>
<p>In such cases, the color palette used is chosen among the diverging palettes in <code>RColorBrewer</code> and can be chosen using <code>diverging.palette</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             diverging.palette <span class="op">=</span> <span class="st">"Spectral"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             diverging.palette <span class="op">=</span> <span class="st">"RdYlBu"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             diverging.palette <span class="op">=</span> <span class="st">"RdYlGn"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             diverging.palette <span class="op">=</span> <span class="st">"RdBu"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             diverging.palette <span class="op">=</span> <span class="st">"RdGy"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p6</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             diverging.palette <span class="op">=</span> <span class="st">"PuOr"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p7</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             diverging.palette <span class="op">=</span> <span class="st">"PiYG"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p8</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span><span class="va">sample</span>, </span>
<span>                             features <span class="op">=</span> <span class="st">"PC_1"</span>,</span>
<span>                             pt.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             use_viridis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             diverging.palette <span class="op">=</span> <span class="st">"BrBG"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p3</span> <span class="op">|</span> <span class="va">p4</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p5</span> <span class="op">|</span> <span class="va">p6</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p7</span> <span class="op">|</span> <span class="va">p8</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="Shared_Features_files/figure-html/unnamed-chunk-9-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Use diverging palettes.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<section id="flip-the-plots" class="level2"><h2 class="anchored" data-anchor-id="flip-the-plots">Flip the plots</h2>
<p>In many cases, it is possible to completely switch the plot axes. Sometimes information can be more easily conveyed by using a X/Y setup rather than Y/X. To switch the axes, you can use <code>flip = TRUE</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                         group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                         split.by <span class="op">=</span> <span class="st">"annotation"</span>,</span>
<span>                         position <span class="op">=</span> <span class="st">"fill"</span>,</span>
<span>                         flip <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                         group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                         split.by <span class="op">=</span> <span class="st">"annotation"</span>,</span>
<span>                         position <span class="op">=</span> <span class="st">"fill"</span>,</span>
<span>                         flip <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="Shared_Features_files/figure-html/unnamed-chunk-10-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Flip the axes</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="control-plot-aesthetics" class="level2"><h2 class="anchored" data-anchor-id="control-plot-aesthetics">Control plot aesthetics</h2>
<p>Pretty much mirroring the style of <code><a href="https://ggplot2.tidyverse.org/reference/theme.html">ggplot2::theme()</a></code>, <code>SCpubr</code> offers a wide range of parameters to adjust the way text elements in the plots are displayed:</p>
<ul>
<li>
<code>font.size</code>: Controls the general size of the plot. Different elements will have higher or lower font size to keep them coherent.</li>
<li>
<code>font.type</code>: Controls the type of font used, can be one of: sans, serif, mono.</li>
<li>
<code>plot.title.face</code>: Controls the style of the font of the element. Can be one of: plain, italic, bold or bold.italic.</li>
<li>
<code>plot.subtitle.face</code>: Controls the style of the font of the element. Can be one of: plain, italic, bold or bold.italic.</li>
<li>
<code>plot.caption.face</code>: Controls the style of the font of the element. Can be one of: plain, italic, bold or bold.italic.</li>
<li>
<code>axis.title.face</code>: Controls the style of the font of the element. Can be one of: plain, italic, bold or bold.italic.</li>
<li>
<code>axis.text.face</code>: Controls the style of the font of the element. Can be one of: plain, italic, bold or bold.italic.</li>
<li>
<code>legend.title.face</code>: Controls the style of the font of the element. Can be one of: plain, italic, bold or bold.italic.</li>
<li>
<code>legend.text.face</code>: Controls the style of the font of the element. Can be one of: plain, italic, bold or bold.italic.</li>
<li>
<code>strip.text.face</code>: Controls the style of the font of the element. Can be one of: plain, italic, bold or bold.italic.</li>
</ul></section><section id="control-legend-aesthetics" class="level2"><h2 class="anchored" data-anchor-id="control-legend-aesthetics">Control legend aesthetics</h2>
<p>Apart from the parameters above, one can control other aspects of the legend with:</p>
<ul>
<li>
<code>legend.position</code>: Either top, bottom, left, right or none to remove it entirely.</li>
<li>
<code>legend.title.position</code>: Position of the legend title. Can be one of: top, bottom, right, left.</li>
<li>
<code>legend.icon.size</code>: Size of the elementes in the legend.</li>
<li>
<code>legend.ncol</code>and <code>legend.nrow</code>: How many rows and columns the legend should have (in categorical variables).</li>
<li>
<code>legend.byrow</code>: Whether the legend should be filled by rows (<code>TRUE</code>) or columns (<code>FALSE</code>).</li>
<li>
<code>legend.type</code>: Whether to have a normal-looking legend (<code>normal</code>) or a bigger, more spacious colorbar (<code>colorbar</code>).</li>
<li>
<code>legend.tickcolor</code>: Controls the color of the ticks in the legend (continuous variables).</li>
<li>
<code>legend.framecolor</code>: Controls the color of the border in the legend (continuous variables).</li>
<li>
<code>legend.length</code>: Controls the length of the legend (continuous variables).</li>
<li>
<code>legend.width</code>: Controls the height of the legend (continuous variables).</li>
<li>
<code>legend.framewidth</code>: Controls the width of the border line in the legend (continuous variables).</li>
<li>
<code>legend.tickwidth</code>: Controls the width of the ticks in the legend (continuous variables).</li>
</ul>
<p>Finally, and as a separate note, for continuous legends, one can choose the number of breaks the legend has (might vary slightly), by using <code>number.breaks</code> parameter.</p>
</section><section id="modify-plot-titles" class="level2"><h2 class="anchored" data-anchor-id="modify-plot-titles">Modify plot titles</h2>
<p>When applicable (some functions might restrict the access to these parameters), the different titles of the plot can be modified by using the following parameters:</p>
<ul>
<li>
<code>plot.title</code>: Title of the plot.</li>
<li>
<code>plot.subtitle</code>: Subtitle of the plot.</li>
<li>
<code>plot.caption</code>: Caption of the plot.</li>
<li>
<code>xlab</code>: X axis title.</li>
<li>
<code>ylab</code>: Y axis title.</li>
<li>
<code>legend.title</code>: Title of the legend.</li>
</ul></section><section id="control-grid-aesthetics" class="level2"><h2 class="anchored" data-anchor-id="control-grid-aesthetics">Control grid aesthetics</h2>
<p>In some plots, it is also possible to draw the grid lines to help guiding the user across the information displayed on them. The following parameters control the grid aesthetics:</p>
<ul>
<li>
<code>plot.grid</code>: Whether to show the grid or not.</li>
<li>
<code>grid.color</code>: Color of the grid lines.</li>
<li>
<code>grid.type</code>: Type of lines used in the grid. Can be one of: blank, solid, dashed, dotted, dotdash, longdash, twodash.</li>
</ul></section><section id="control-cell-borders" class="level2"><h2 class="anchored" data-anchor-id="control-cell-borders">Control cell borders</h2>
<p>A very nice addition than enhances visibility of any plot where cells are drawn as dots is to add a black border around them. However, just changing the shape to a dot with border results in a very clogged visualization. It is more interesting to add another lagyer of black cells underneath the real plotting layer, so that only the cells on the edges will be visible, thus forming an outline border.</p>
<p>While this greatly increases the plot size, it is a tradeoff one can consider when making a final figure for a publication. This behavior can be accessed via the following parameters:</p>
<ul>
<li>
<code>plot_cell_borders</code>: Whether to plot the cell borders.</li>
<li>
<code>border.size</code>: Size of the dots used for the cell borders.</li>
<li>
<code>border.color</code>: Color of the dots used for the cell borders.</li>
<li>
<code>border.density</code>: Controls how many cells are used to generate the borders. A value between 0 and 1. It computes a 2D kernel density of the cells in the dimensional reduction embedding and based on this cells falling below the <code>border.density</code> quantilye are excluded. This helps decreasing the added weight to the plot when <code>plot_cell_borders = TRUE</code>, but might result in an uneven border for the cells.</li>
</ul></section><section id="plot-marginal-distributions" class="level2"><h2 class="anchored" data-anchor-id="plot-marginal-distributions">Plot marginal distributions</h2>
<p>In some cases, it is also possible to plot marginal distributions of the density of the values in a scatter plot across a given axis. This is used by some functions in <code>SCpubr</code> and the functionality can be accessed by:</p>
<ul>
<li>
<code>plot_marginal_distributions</code>: Whether to plot marginal distributions or not.</li>
<li>
<code>marginal.type</code>: Type of distribution to plot. Can be one of: density, histogram, boxplot, violin, densigram.</li>
<li>
<code>marginal.size</code>: Size ratio between the main and marginal plots.</li>
<li>
<code>marginal.groups</code>: Metadata variable to use to group the values by when computing the marginal distribution.</li>
</ul></section><section id="plot-density-contours-in-dimensional-reduction-visualizations" class="level2"><h2 class="anchored" data-anchor-id="plot-density-contours-in-dimensional-reduction-visualizations">Plot density contours in dimensional reduction visualizations</h2>
<p>Strictly pertaining to dimensional reduction visualizations, one can also plot density contour lines in these plots:</p>
<ul>
<li>
<code>plot_density_contour</code>: Whether to plot the density contours or not.</li>
<li>
<code>contour.position</code>: Whether to place the contour layer on top or bottom of the rest of the layers (this will make some of the lines visible or not).</li>
<li>
<code>contour.color</code>: Color of the lines that draw the contour.</li>
<li>
<code>contour.lineend</code>: Controls the line style of the line ends. One of: round, butt, square.</li>
<li>
<code>contour.linejoin</code>: Controls the line style of the line joins. One of: round, mitre, bevel.</li>
<li>
<code>contour_expand_axes</code>: Whether to increase the limits of the X and Y axes to make the contours fit the plot. This is a number between 0 and 1 and represents how much in proportion the axes should be expanded.</li>
</ul>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../functions/DimPlots.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Dim plots</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Written by <strong>Enrique Blanco Carmona</strong></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a></div>
  </div>
</footer>


</body></html>