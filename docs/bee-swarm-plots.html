<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>4 Bee Swarm plots | SCpubr</title>
<meta name="author" content="Enrique Blanco Carmona">
<meta name="description" content="This one is a very interesting plot. It stems from the idea that we can order (rank) the cells in a given variable. This variable has to be a continuous variable, for a better representation. The...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="4 Bee Swarm plots | SCpubr">
<meta property="og:type" content="book">
<meta property="og:url" content="https://enblacar.github.io/SCpubr-book/bee-swarm-plots.html">
<meta property="og:image" content="https://enblacar.github.io/SCpubr-book/images/SCpubr_logo.png">
<meta property="og:description" content="This one is a very interesting plot. It stems from the idea that we can order (rank) the cells in a given variable. This variable has to be a continuous variable, for a better representation. The...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="4 Bee Swarm plots | SCpubr">
<meta name="twitter:description" content="This one is a very interesting plot. It stems from the idea that we can order (rank) the cells in a given variable. This variable has to be a continuous variable, for a better representation. The...">
<meta name="twitter:image" content="https://enblacar.github.io/SCpubr-book/images/SCpubr_logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link rel="shortcut icon" href="images/SCpubr_logo_favicon.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a id="toc_title" href="index.html" title="">SCpubr</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <div class="book-extra"></div>
      <nav id="left-panel" aria-label="Table of contents"><ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About this package</a></li>
<li><a class="" href="installation-guide.html">Installation guide</a></li>
<li><a class="" href="dataset-used.html">Dataset used</a></li>
<li><a class="" href="dim-plots.html"><span class="header-section-number">1</span> Dim plots</a></li>
<li><a class="" href="feature-plots.html"><span class="header-section-number">2</span> Feature plots</a></li>
<li><a class="" href="nebulosa-plots.html"><span class="header-section-number">3</span> Nebulosa plots</a></li>
<li><a class="active" href="bee-swarm-plots.html"><span class="header-section-number">4</span> Bee Swarm plots</a></li>
<li><a class="" href="violin-plots.html"><span class="header-section-number">5</span> Violin plots</a></li>
<li><a class="" href="dot-plots.html"><span class="header-section-number">6</span> Dot plots</a></li>
<li><a class="" href="bar-plots.html"><span class="header-section-number">7</span> Bar plots</a></li>
<li><a class="" href="troubleshooting.html">Troubleshooting</a></li>
<li><a class="" href="citation.html">Citation</a></li>
</ul>

        <div class="book-extra">
          <!-- Duplicated this entry to point to the package repo. -->
          <p class="mb-2"><a id="package-repo" href="https://github.com/enblacar/SCpubr">View package source <i class="fab fa-github"></i></a></p>
          <p><a id="book-repo" href="https://github.com/enblacar/SCpubr-book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="bee-swarm-plots" class="section level1" number="4">
<h1>
<span class="header-section-number">4</span> Bee Swarm plots<a class="anchor" aria-label="anchor" href="#bee-swarm-plots"><i class="fas fa-link"></i></a>
</h1>
<p>This one is a very interesting plot. It stems from the idea that we can order (rank) the cells in a given variable. This variable has to be a continuous variable, for a better representation. The order goes from lowest to maximum value. Then, the cells are grouped into any other variable of interest and displayed in a scatter plot fashion. This is achieved by using the <a href="https://github.com/eclarke/ggbeeswarm">ggbeeswarm package</a>. The idea of using the <code><a href="https://rdrr.io/pkg/ggbeeswarm/man/geom_quasirandom.html">ggbeeswarm::geom_quasirandom()</a></code> geometry provided by this package and implement it for single-cell analyses came from <a href="https://broadinstitute.github.io/2019_scWorkshop/functional-pseudotime-analysis.html#diffusion-map-pseudotime">this tutorial from the Broad Institute</a>.</p>
<div id="using-categorical-variables" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Using categorical variables<a class="anchor" aria-label="anchor" href="#using-categorical-variables"><i class="fas fa-link"></i></a>
</h2>
<p>Let’s say we want to focus on how much each cluster is driven by the PC_1 and PC_2. The first thought is to just use <code>SCpubr::do_Dimplot()</code> to plot the PCA embedding instead of the UMAP. We also query PC_3 and PC_4 to have a not-so-clear example.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_DimPlot.html">do_DimPlot</a></span><span class="op">(</span><span class="va">sample</span>, 
                         reduction <span class="op">=</span> <span class="st">"pca"</span>, 
                         label <span class="op">=</span> <span class="cn">T</span>, 
                         legend <span class="op">=</span> <span class="cn">F</span>, 
                         dims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> 
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_DimPlot.html">do_DimPlot</a></span><span class="op">(</span><span class="va">sample</span>, 
                         reduction <span class="op">=</span> <span class="st">"pca"</span>, 
                         label <span class="op">=</span> <span class="cn">T</span>, 
                         legend <span class="op">=</span> <span class="cn">F</span>, 
                         dims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> 

<span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="06-BeeSwarmPlots_files/figure-html/unnamed-chunk-2-1.png" alt="Plotting PCA embeddings with SCpubr::do_DimPlot()" width="100%" height="100%"><p class="caption">
Figure 1.1: Plotting PCA embeddings with SCpubr::do_DimPlot()
</p>
</div>
<p>With this, we get right away a decent overview. Clusters 0, 5, 7 and 8 separate on PC_1 from the rest. However, in many cases this will not be clear, such as the image on the right. This is where Bee Swarm plots come in handy. This is implemented in <code><a href="https://rdrr.io/pkg/SCpubr/man/do_BeeSwarmPlot.html">SCpubr::do_BeeSwarmPlot()</a></code>. This function needs the user to provide:
- The variable to rank to <code>feature_to_rank</code>.
- The groups to divide the plot into to <code>group.by</code>.
- Whether the output should be colored with a categorical or continuous scale, with <code>continuous_feature</code>.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_DimPlot.html">do_DimPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                         reduction <span class="op">=</span> <span class="st">"pca"</span>, 
                         label <span class="op">=</span> <span class="cn">T</span>, 
                         legend <span class="op">=</span> <span class="cn">F</span>, 
                         dims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_DimPlot.html">do_DimPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                         reduction <span class="op">=</span> <span class="st">"pca"</span>, 
                         label <span class="op">=</span> <span class="cn">T</span>, 
                         legend <span class="op">=</span> <span class="cn">F</span>, 
                         dims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> 

<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BeeSwarmPlot.html">do_BeeSwarmPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                              feature_to_rank <span class="op">=</span> <span class="st">"PC_1"</span>, 
                              group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>, 
                              continuous_feature <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>

<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BeeSwarmPlot.html">do_BeeSwarmPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                              feature_to_rank <span class="op">=</span> <span class="st">"PC_4"</span>, 
                              group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>, 
                              continuous_feature <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>

<span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p3</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p2</span> <span class="op">|</span> <span class="va">p4</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="06-BeeSwarmPlots_files/figure-html/unnamed-chunk-3-1.png" alt="SCpubr Bee Swarm plots with categorical variables." width="100%" height="100%"><p class="caption">
Figure 1.2: SCpubr Bee Swarm plots with categorical variables.
</p>
</div>
<p>Here, we have selected PC_1 and PC_4. We can observe how the X axis of the Bee Swarm plot displays the ordering (rank) of all of the cells across the selected feature. Focusing on PC_1, we can see that cluster 0 is completely shifted to the right on PC_1, with is nicely displayed in the Bee Swarm plot by having all of the cells also ranked high (the higher the rank, the bigger the “value” of the feature to rank, in this case, the PC_1 value). In the case of PC_4, the Bee Swarm plot nicely shows which clusters lay on the upper, lower or middle part of the PC_4.</p>
<p>A very important thing to note in these kind of plots is that no cells will have the same rank. This is, imagine a scenario like PC_4, but we artificially remove clusters 0, 3, 5, 7, 8, 9, leaving only those forming a “straight line” in PC_4. The nature of this plot will also separate the remaining clusters:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Clusters to exclude.</span>
<span class="va">clusters_exclude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"3"</span>, <span class="st">"5"</span>, <span class="st">"7"</span>, <span class="st">"8"</span>, <span class="st">"9"</span><span class="op">)</span>

<span class="co"># Keep the original coloring.</span>
<span class="va">cols.use</span> <span class="op">&lt;-</span> <span class="fu">colortools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/colortools/man/setColors.html">setColors</a></span><span class="op">(</span><span class="st">"steelblue"</span>, 
                                  <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">cols.use</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span>

<span class="co"># Only provide the needed colors. If more are provided, an error is thrown.</span>
<span class="va">cols.use</span> <span class="op">&lt;-</span> <span class="va">cols.use</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">cols.use</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">clusters_exclude</span><span class="op">)</span><span class="op">]</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_DimPlot.html">do_DimPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span><span class="op">[</span>, <span class="op">!</span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">seurat_clusters</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">clusters_exclude</span><span class="op">)</span><span class="op">]</span>, 
                         reduction <span class="op">=</span> <span class="st">"pca"</span>, 
                         label <span class="op">=</span> <span class="cn">T</span>, 
                         legend <span class="op">=</span> <span class="cn">F</span>, 
                         dims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, 
                         colors.use <span class="op">=</span> <span class="va">cols.use</span><span class="op">)</span> 
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BeeSwarmPlot.html">do_BeeSwarmPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span><span class="op">[</span>, <span class="op">!</span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">seurat_clusters</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">clusters_exclude</span><span class="op">)</span><span class="op">]</span>, 
                              feature_to_rank <span class="op">=</span> <span class="st">"PC_4"</span>, 
                              group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>, 
                              continuous_feature <span class="op">=</span> <span class="cn">F</span>, 
                              colors.use <span class="op">=</span> <span class="va">cols.use</span><span class="op">)</span>

<span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="06-BeeSwarmPlots_files/figure-html/unnamed-chunk-4-1.png" alt="SCpubr Bee Swarm plots with similar values." width="100%" height="100%"><p class="caption">
Figure 1.3: SCpubr Bee Swarm plots with similar values.
</p>
</div>
<p>See, we still clearly see two groups, formed by clusters 1 and 2, and clusters 4 and 6. We could even remove clusters 1 and 2 and still see a similar effect.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Clusters to exclude.</span>
<span class="va">clusters_exclude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"5"</span>, <span class="st">"7"</span>, <span class="st">"8"</span>, <span class="st">"9"</span><span class="op">)</span>

<span class="co"># Keep the original coloring.</span>
<span class="va">cols.use</span> <span class="op">&lt;-</span> <span class="fu">colortools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/colortools/man/setColors.html">setColors</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">cols.use</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span>

<span class="co"># Only provide the needed colors. If more are provided, an error is thrown.</span>
<span class="va">cols.use</span> <span class="op">&lt;-</span> <span class="va">cols.use</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">cols.use</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">clusters_exclude</span><span class="op">)</span><span class="op">]</span>


<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_DimPlot.html">do_DimPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span><span class="op">[</span>, <span class="op">!</span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">seurat_clusters</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">clusters_exclude</span><span class="op">)</span><span class="op">]</span>, 
                         reduction <span class="op">=</span> <span class="st">"pca"</span>, 
                         label <span class="op">=</span> <span class="cn">T</span>, 
                         legend <span class="op">=</span> <span class="cn">F</span>, 
                         dims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, 
                         colors.use <span class="op">=</span> <span class="va">cols.use</span><span class="op">)</span> 
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BeeSwarmPlot.html">do_BeeSwarmPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span><span class="op">[</span>, <span class="op">!</span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">seurat_clusters</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">clusters_exclude</span><span class="op">)</span><span class="op">]</span>, 
                              feature_to_rank <span class="op">=</span> <span class="st">"PC_4"</span>, 
                              group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>, 
                              continuous_feature <span class="op">=</span> <span class="cn">F</span>, 
                              colors.use <span class="op">=</span> <span class="va">cols.use</span><span class="op">)</span>

<span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="06-BeeSwarmPlots_files/figure-html/unnamed-chunk-5-1.png" alt="SCpubr Bee Swarm plots with almost identical values." width="100%" height="100%"><p class="caption">
Figure 1.4: SCpubr Bee Swarm plots with almost identical values.
</p>
</div>
<p>As can be seen here, both clusters now span all X axis. The cells have still ranked, therefore showing a cloud of dots. With this, we would just want that, as with any data visualization technique, each plot comes with a set of benefits and caveats. This visualization suffers from trying to plot highly similar values. Therefore, it is key to <strong>understand the nature of the variable you want to rank</strong> beforehand.</p>
</div>
<div id="using-continuous-variables" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Using continuous variables<a class="anchor" aria-label="anchor" href="#using-continuous-variables"><i class="fas fa-link"></i></a>
</h2>
<p>There are also scenarios in which we want to rank the cells to a continuous variable, but instead of showing colors for each group (which is anyway depicted in the Y axis), we want to introduce a continuous color scale. This is specially interesting to assess enrichment of clusters towards a given set of features.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Set up list of a genes to compute enrichment. Let's use a monocyte signature.</span>
<span class="va">genes.use</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CD14"</span>, <span class="st">"LYZ"</span><span class="op">)</span>

<span class="co"># Compute enrichment and rename the output.</span>
<span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/AddModuleScore.html">AddModuleScore</a></span><span class="op">(</span><span class="va">sample</span>, 
                                 features <span class="op">=</span> <span class="va">genes.use</span>, 
                                 name <span class="op">=</span> <span class="st">"Monocyte_signature"</span><span class="op">)</span>
<span class="va">sample</span><span class="op">$</span><span class="va">Monocyte_signature</span> <span class="op">&lt;-</span> <span class="va">sample</span><span class="op">$</span><span class="va">Monocyte_signature1</span>
<span class="va">sample</span><span class="op">$</span><span class="va">Monocyte_signature1</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_DimPlot.html">do_DimPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                         label <span class="op">=</span> <span class="cn">T</span>, 
                         legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">do_FeaturePlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                             features <span class="op">=</span> <span class="st">"Monocyte_signature"</span><span class="op">)</span> 
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BeeSwarmPlot.html">do_BeeSwarmPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                              feature_to_rank <span class="op">=</span> <span class="st">"Monocyte_signature"</span>, 
                              group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>, 
                              continuous_feature <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span> <span class="op">|</span> <span class="va">p3</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="06-BeeSwarmPlots_files/figure-html/unnamed-chunk-6-1.png" alt="Using continuous color scale in SCpubr::do_BeeSwarmPlot()." width="100%" height="100%"><p class="caption">
Figure 1.5: Using continuous color scale in SCpubr::do_BeeSwarmPlot().
</p>
</div>
<p>By using this combination of figures, we can also assess that the monocyte signature seems to be predominantly enriched in clusters 0 and 7.</p>
</div>
<div id="change-default-colors-in-categorical-variables" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Change default colors in categorical variables<a class="anchor" aria-label="anchor" href="#change-default-colors-in-categorical-variables"><i class="fas fa-link"></i></a>
</h2>
<p>Same as with other categorical representations, we can modify the default color palette by providing a custom one to <code>colors.use</code>. This has to be a named vector of HEX values with the names of the groups as names of the values:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a color scale for the unique values in seurat clusters.</span>
<span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"#001219"</span>,
            <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#005f73"</span>,
            <span class="st">"2"</span> <span class="op">=</span> <span class="st">"#0a9396"</span>,
            <span class="st">"3"</span> <span class="op">=</span> <span class="st">"#94d2bd"</span>,
            <span class="st">"4"</span> <span class="op">=</span> <span class="st">"#e9d8a6"</span>,
            <span class="st">"5"</span> <span class="op">=</span> <span class="st">"#ee9b00"</span>,
            <span class="st">"6"</span> <span class="op">=</span> <span class="st">"#ca6702"</span>,
            <span class="st">"7"</span> <span class="op">=</span> <span class="st">"#bb3e03"</span>,
            <span class="st">"8"</span> <span class="op">=</span> <span class="st">"#ae2012"</span>,
            <span class="st">"9"</span> <span class="op">=</span> <span class="st">"#9b2226"</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BeeSwarmPlot.html">do_BeeSwarmPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                             feature_to_rank <span class="op">=</span> <span class="st">"Monocyte_signature"</span>, 
                             group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>,
                             colors.use <span class="op">=</span> <span class="va">colors</span><span class="op">)</span>
<span class="va">p</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-7"></span>
<img src="06-BeeSwarmPlots_files/figure-html/unnamed-chunk-7-1.png" alt="SCpubr, modifying default colors in a Bee Swarm plot" width="100%" height="100%"><p class="caption">
Figure 1.6: SCpubr, modifying default colors in a Bee Swarm plot
</p>
</div>
</div>
<div id="modify-color-maps-for-continuous-variables" class="section level2" number="4.4">
<h2>
<span class="header-section-number">4.4</span> Modify color maps for continuous variables<a class="anchor" aria-label="anchor" href="#modify-color-maps-for-continuous-variables"><i class="fas fa-link"></i></a>
</h2>
<p>Same as in <code><a href="https://rdrr.io/pkg/SCpubr/man/do_FeaturePlot.html">SCpubr::do_FeaturePlot()</a></code>, it is also change the color map of the plot to one of the eight possible ones defined in <a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html">viridis</a>. This is achieved by using <code>viridis_color_map</code> parameter and the color map name or code (capital letter). Options are:</p>
<ul>
<li>A - magma color map.</li>
<li>B - inferno color map.</li>
<li>C - plasma color map.</li>
<li>D - viridis color map.</li>
<li>E - cividis color map.</li>
<li>F - rocket color map.</li>
<li>G - mako color map.</li>
<li>H - turbo color map.</li>
</ul>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BeeSwarmPlot.html">do_BeeSwarmPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, feature_to_rank <span class="op">=</span> <span class="st">"Monocyte_signature"</span>, group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>, continuous_feature <span class="op">=</span> <span class="cn">TRUE</span>, fontsize <span class="op">=</span> <span class="fl">10</span>, viridis_color_map <span class="op">=</span> <span class="st">"A"</span>, plot.title <span class="op">=</span> <span class="st">"Magma"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BeeSwarmPlot.html">do_BeeSwarmPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, feature_to_rank <span class="op">=</span> <span class="st">"Monocyte_signature"</span>, group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>, continuous_feature <span class="op">=</span> <span class="cn">TRUE</span>, fontsize <span class="op">=</span> <span class="fl">10</span>, viridis_color_map <span class="op">=</span> <span class="st">"B"</span>, plot.title <span class="op">=</span> <span class="st">"Inferno"</span><span class="op">)</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BeeSwarmPlot.html">do_BeeSwarmPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, feature_to_rank <span class="op">=</span> <span class="st">"Monocyte_signature"</span>, group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>, continuous_feature <span class="op">=</span> <span class="cn">TRUE</span>, fontsize <span class="op">=</span> <span class="fl">10</span>, viridis_color_map <span class="op">=</span> <span class="st">"C"</span>, plot.title <span class="op">=</span> <span class="st">"Plasma"</span><span class="op">)</span>
<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BeeSwarmPlot.html">do_BeeSwarmPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, feature_to_rank <span class="op">=</span> <span class="st">"Monocyte_signature"</span>, group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>, continuous_feature <span class="op">=</span> <span class="cn">TRUE</span>, fontsize <span class="op">=</span> <span class="fl">10</span>, viridis_color_map <span class="op">=</span> <span class="st">"D"</span>, plot.title <span class="op">=</span> <span class="st">"Viridis"</span><span class="op">)</span>
<span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BeeSwarmPlot.html">do_BeeSwarmPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, feature_to_rank <span class="op">=</span> <span class="st">"Monocyte_signature"</span>, group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>, continuous_feature <span class="op">=</span> <span class="cn">TRUE</span>, fontsize <span class="op">=</span> <span class="fl">10</span>, viridis_color_map <span class="op">=</span> <span class="st">"E"</span>, plot.title <span class="op">=</span> <span class="st">"Cividis"</span><span class="op">)</span>
<span class="va">p6</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BeeSwarmPlot.html">do_BeeSwarmPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, feature_to_rank <span class="op">=</span> <span class="st">"Monocyte_signature"</span>, group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>, continuous_feature <span class="op">=</span> <span class="cn">TRUE</span>, fontsize <span class="op">=</span> <span class="fl">10</span>, viridis_color_map <span class="op">=</span> <span class="st">"F"</span>, plot.title <span class="op">=</span> <span class="st">"Rocket"</span><span class="op">)</span>
<span class="va">p7</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BeeSwarmPlot.html">do_BeeSwarmPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, feature_to_rank <span class="op">=</span> <span class="st">"Monocyte_signature"</span>, group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>, continuous_feature <span class="op">=</span> <span class="cn">TRUE</span>, fontsize <span class="op">=</span> <span class="fl">10</span>, viridis_color_map <span class="op">=</span> <span class="st">"G"</span>, plot.title <span class="op">=</span> <span class="st">"Mako"</span><span class="op">)</span>
<span class="va">p8</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BeeSwarmPlot.html">do_BeeSwarmPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, feature_to_rank <span class="op">=</span> <span class="st">"Monocyte_signature"</span>, group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>, continuous_feature <span class="op">=</span> <span class="cn">TRUE</span>, fontsize <span class="op">=</span> <span class="fl">10</span>, viridis_color_map <span class="op">=</span> <span class="st">"H"</span>, plot.title <span class="op">=</span> <span class="st">"Turbo"</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html">wrap_plots</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, <span class="va">p4</span>, <span class="va">p5</span>, <span class="va">p6</span>, <span class="va">p7</span>, <span class="va">p8</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">p</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="06-BeeSwarmPlots_files/figure-html/unnamed-chunk-8-1.png" alt="SCpubr Nebulosa plot modifying viridis color maps." width="100%" height="100%"><p class="caption">
Figure 1.7: SCpubr Nebulosa plot modifying viridis color maps.
</p>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="nebulosa-plots.html"><span class="header-section-number">3</span> Nebulosa plots</a></div>
<div class="next"><a href="violin-plots.html"><span class="header-section-number">5</span> Violin plots</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><form role="search" class="mt-4 mb-4">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>
      <div class="book-extra">
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#bee-swarm-plots"><span class="header-section-number">4</span> Bee Swarm plots</a></li>
<li><a class="nav-link" href="#using-categorical-variables"><span class="header-section-number">4.1</span> Using categorical variables</a></li>
<li><a class="nav-link" href="#using-continuous-variables"><span class="header-section-number">4.2</span> Using continuous variables</a></li>
<li><a class="nav-link" href="#change-default-colors-in-categorical-variables"><span class="header-section-number">4.3</span> Change default colors in categorical variables</a></li>
<li><a class="nav-link" href="#modify-color-maps-for-continuous-variables"><span class="header-section-number">4.4</span> Modify color maps for continuous variables</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<!-- Modified page for chapter. --><li><a id="book-source" href="https://github.com/enblacar/SCpubr-book/blob/main/06-BeeSwarmPlots.Rmd">View chapter source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/enblacar/SCpubr-book/edit/main/06-BeeSwarmPlots.Rmd">Edit this chapter <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    
  </div>

</nav>
</div>
</div> <!-- .container -->




</div>
</body>
<!-- Moved the footer outside of the body to make it span all page width. --><footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p class="text-center">Written by <strong>Enrique Blanco Carmona</strong> on 08 March, 2022.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p class="text-center">This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</html>
