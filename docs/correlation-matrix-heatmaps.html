<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>10 Correlation matrix heatmaps | SCpubr</title>
<meta name="author" content="Enrique Blanco Carmona">
<meta name="description" content="A common analysis to perform with your single cell data is to assess how much different subsets of your data are correlated between them. For this, correlation matrices are used, typically...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="10 Correlation matrix heatmaps | SCpubr">
<meta property="og:type" content="book">
<meta property="og:url" content="https://enblacar.github.io/SCpubr-book/correlation-matrix-heatmaps.html">
<meta property="og:image" content="https://enblacar.github.io/SCpubr-book/images/SCpubr_logo.png">
<meta property="og:description" content="A common analysis to perform with your single cell data is to assess how much different subsets of your data are correlated between them. For this, correlation matrices are used, typically...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="10 Correlation matrix heatmaps | SCpubr">
<meta name="twitter:description" content="A common analysis to perform with your single cell data is to assess how much different subsets of your data are correlated between them. For this, correlation matrices are used, typically...">
<meta name="twitter:image" content="https://enblacar.github.io/SCpubr-book/images/SCpubr_logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link rel="shortcut icon" href="images/SCpubr_logo_favicon.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a id="toc_title" href="index.html" title="">SCpubr</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <div class="book-extra"></div>
      <nav id="left-panel" aria-label="Table of contents"><ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About this package</a></li>
<li><a class="" href="installation-guide.html">Installation guide</a></li>
<li><a class="" href="dataset-used.html">Dataset used</a></li>
<li><a class="" href="dim-plots.html"><span class="header-section-number">1</span> Dim plots</a></li>
<li><a class="" href="feature-plots.html"><span class="header-section-number">2</span> Feature plots</a></li>
<li><a class="" href="nebulosa-plots.html"><span class="header-section-number">3</span> Nebulosa plots</a></li>
<li><a class="" href="bee-swarm-plots.html"><span class="header-section-number">4</span> Bee Swarm plots</a></li>
<li><a class="" href="violin-plots.html"><span class="header-section-number">5</span> Violin plots</a></li>
<li><a class="" href="dot-plots.html"><span class="header-section-number">6</span> Dot plots</a></li>
<li><a class="" href="bar-plots.html"><span class="header-section-number">7</span> Bar plots</a></li>
<li><a class="" href="term-enrichment-plots.html"><span class="header-section-number">8</span> Term Enrichment Plots</a></li>
<li><a class="" href="enrichment-score-heatmaps.html"><span class="header-section-number">9</span> Enrichment score heatmaps</a></li>
<li><a class="active" href="correlation-matrix-heatmaps.html"><span class="header-section-number">10</span> Correlation matrix heatmaps</a></li>
<li><a class="" href="cellular-state-plots.html"><span class="header-section-number">11</span> Cellular State Plots</a></li>
<li><a class="" href="rasterized-figures.html">Rasterized figures</a></li>
<li><a class="" href="save-the-figures.html">Save the figures</a></li>
<li><a class="" href="troubleshooting.html">Troubleshooting</a></li>
<li><a class="" href="citation.html">Citation</a></li>
</ul>

        <div class="book-extra">
          <!-- Duplicated this entry to point to the package repo. -->
          <p class="mb-2"><a id="package-repo" href="https://github.com/enblacar/SCpubr">View package source <i class="fab fa-github"></i></a></p>
          <p><a id="book-repo" href="https://github.com/enblacar/SCpubr-book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="correlation-matrix-heatmaps" class="section level1" number="10">
<h1>
<span class="header-section-number">10</span> Correlation matrix heatmaps<a class="anchor" aria-label="anchor" href="#correlation-matrix-heatmaps"><i class="fas fa-link"></i></a>
</h1>
<p>A common analysis to perform with your single cell data is to assess how much different subsets of your data are correlated between them. For this, correlation matrices are used, typically displayed as heatmaps. This is implemented in <code><a href="https://rdrr.io/pkg/SCpubr/man/do_CorrelationPlot.html">SCpubr::do_CorrelationPlot()</a></code>. Right now, it only works for a single use case: computing the correlation matrix of the highly variable genes between the desired groups. Further use cases will be implemented in the future.</p>
<div id="using-highly-variable-genes" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> Using Highly Variable Genes<a class="anchor" aria-label="anchor" href="#using-highly-variable-genes"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Default values.</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_CorrelationPlot.html">do_CorrelationPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span><span class="op">)</span>
<span class="va">p</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="12-CorrelationPlots_files/figure-html/unnamed-chunk-2-1.png" alt="SCpubr::do_CorrelationPlot with default parameters." width="100%" height="100%"><p class="caption">
Figure 1.1: SCpubr::do_CorrelationPlot with default parameters.
</p>
</div>
<p>By default, it computes the correlation over the current identities in the object. This can be changed by providing another metadata variable to <code>group.by</code>.</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Custom grouping.</span>
<span class="va">sample</span><span class="op">$</span><span class="va">custom_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">seurat_clusters</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"3"</span>, <span class="st">"5"</span>, <span class="st">"7"</span>, <span class="st">"9"</span><span class="op">)</span>, <span class="st">"Group A"</span>, <span class="st">"Group B"</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_CorrelationPlot.html">do_CorrelationPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, group.by <span class="op">=</span> <span class="st">"custom_group"</span><span class="op">)</span>
<span class="va">p</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="12-CorrelationPlots_files/figure-html/unnamed-chunk-3-1.png" alt="SCpubr::do_CorrelationPlot with custom grouping." width="100%" height="100%"><p class="caption">
Figure 1.2: SCpubr::do_CorrelationPlot with custom grouping.
</p>
</div>
<p>Axes labels can also be rotated.</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Rotated axis labels.</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_CorrelationPlot.html">do_CorrelationPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,
                                column_names_rot <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">p</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="12-CorrelationPlots_files/figure-html/unnamed-chunk-4-1.png" alt="SCpubr::do_CorrelationPlot with rotated axis labels." width="100%" height="100%"><p class="caption">
Figure 1.3: SCpubr::do_CorrelationPlot with rotated axis labels.
</p>
</div>
</div>
<div id="changing-the-cell-size-in-the-heatmap.-1" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> Changing the cell size in the heatmap.<a class="anchor" aria-label="anchor" href="#changing-the-cell-size-in-the-heatmap.-1"><i class="fas fa-link"></i></a>
</h2>
<p>Same as with Enrichment Heatmaps, the aspect ratio of the tiles in the heatmap is fixed so that cells are squares, and not rectangles. This can be changed modifying <code>cell_size</code> parameter. This is set to 5 by default.</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Increase cell size.</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_CorrelationPlot.html">do_CorrelationPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,
                                column_names_rot <span class="op">=</span> <span class="fl">0</span>,
                                cell_size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>
<span class="va">p</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="12-CorrelationPlots_files/figure-html/unnamed-chunk-5-1.png" alt="SCpubr::do_CorrelationPlot with rotated axis labels." width="100%" height="100%"><p class="caption">
Figure 1.4: SCpubr::do_CorrelationPlot with rotated axis labels.
</p>
</div>
</div>
<div id="changing-the-color-scale" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> Changing the color scale<a class="anchor" aria-label="anchor" href="#changing-the-color-scale"><i class="fas fa-link"></i></a>
</h2>
<p>Color scale can be modified using <code>colors.use</code> parameter.</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Modified color scale.</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_CorrelationPlot.html">do_CorrelationPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,
                                column_names_rot <span class="op">=</span> <span class="fl">0</span>,
                                colors.use <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="12-CorrelationPlots_files/figure-html/unnamed-chunk-6-1.png" alt="SCpubr::do_CorrelationPlot with rotated axis labels and modified color scale." width="100%" height="100%"><p class="caption">
Figure 1.5: SCpubr::do_CorrelationPlot with rotated axis labels and modified color scale.
</p>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="enrichment-score-heatmaps.html"><span class="header-section-number">9</span> Enrichment score heatmaps</a></div>
<div class="next"><a href="cellular-state-plots.html"><span class="header-section-number">11</span> Cellular State Plots</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><form role="search" class="mt-4 mb-4">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>
      <div class="book-extra">
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#correlation-matrix-heatmaps"><span class="header-section-number">10</span> Correlation matrix heatmaps</a></li>
<li><a class="nav-link" href="#using-highly-variable-genes"><span class="header-section-number">10.1</span> Using Highly Variable Genes</a></li>
<li><a class="nav-link" href="#changing-the-cell-size-in-the-heatmap.-1"><span class="header-section-number">10.2</span> Changing the cell size in the heatmap.</a></li>
<li><a class="nav-link" href="#changing-the-color-scale"><span class="header-section-number">10.3</span> Changing the color scale</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<!-- Modified page for chapter. --><li><a id="book-source" href="https://github.com/enblacar/SCpubr-book/blob/main/12-CorrelationPlots.Rmd">View chapter source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/enblacar/SCpubr-book/edit/main/12-CorrelationPlots.Rmd">Edit this chapter <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    
  </div>

</nav>
</div>
</div> <!-- .container -->




</div>
</body>
<!-- Moved the footer outside of the body to make it span all page width. --><footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p class="text-center">Written by <strong>Enrique Blanco Carmona</strong> on 02 July, 2022.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p class="text-center">This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</html>
