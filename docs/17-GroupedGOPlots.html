<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.226">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>SCpubr - 16&nbsp; Grouped GO Term analysis plots</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./17-FunctionalEnrichmentPlots.html" rel="next">
<link href="./16-GroupwiseDEPlots.html" rel="prev">
<link href=".//images/SCpubr_logo_favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<meta property="og:title" content="SCpubr - 16&nbsp; Grouped GO Term analysis plots">
<meta property="og:description" content="More often than not in a Single-Cell Transcriptomics analysis, one comes across a list of genes.">
<meta property="og:site-name" content="SCpubr">
<meta name="twitter:title" content="SCpubr - 16&nbsp; Grouped GO Term analysis plots">
<meta name="twitter:description" content="More often than not in a Single-Cell Transcriptomics analysis, one comes across a list of genes.">
<meta name="twitter:card" content="summary">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Grouped GO Term analysis plots</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">SCpubr </a><a href="https://github.com/enblacar/SCpubr/blob/main/NEWS.md"><code>v1.1.2</code></a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/enblacar/SCpubr/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">Getting started</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">About this package</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Installation-guide.html" class="sidebar-item-text sidebar-link">Installation guide</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-Dataset.html" class="sidebar-item-text sidebar-link">Dataset used</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Basic plots</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-DimPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Dim plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-FeaturePlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Feature plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-NebulosaPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Nebulosa plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-BeeSwarmPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bee Swarm plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-ViolinPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Violin plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-RidgePlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ridge plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-DotPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Dot plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-BarPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Bar plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-BoxPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Box plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-GeyserPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Geyser plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-AlluvialPlot.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Alluvial plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-SankeyPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Sankey plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-ChordDiagramPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Chord Diagram plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-VolcanoPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Volcano plots</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Advanced plots</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-GroupwiseDEPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Group-wise DE analysis plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-GroupedGOPlots.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Grouped GO Term analysis plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-FunctionalEnrichmentPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Functional Annotation Analysis plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-TermEnrichmentPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Term Enrichment Plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-ExpressionHeatmaps.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Expression heatmaps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-EnrichmentHeatmaps.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Enrichment score heatmaps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-CorrelationHeatmaps.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Correlation matrix heatmaps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-CellularStatesPlot.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Cellular State Plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-LigandReceptorPlot.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Ligand-Receptor analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-CopyNumberVariantPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Copy Number Variant analysis plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-PathwayActivityPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Pathway Activity inference analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-TFActivityPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">TF Activity inference analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-AzimuthAnalysisPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Azimuth reference mapping reports</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-PseudotimeAnalysisPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Pseudotime analysis</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">Miscellaneous</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./93-ColorPalettes.html" class="sidebar-item-text sidebar-link">Color palettes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./94-CommonFeatures.html" class="sidebar-item-text sidebar-link">Common features across plots</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./95-SaveFigures.html" class="sidebar-item-text sidebar-link">Save the figures</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./96-Citation.html" class="sidebar-item-text sidebar-link">Citation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./97-NEWS.html" class="sidebar-item-text sidebar-link">News</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-Acknowledgements.html" class="sidebar-item-text sidebar-link">Acknowledgements</a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#basic-usage" id="toc-basic-usage" class="nav-link active" data-scroll-target="#basic-usage"><span class="toc-section-number">16.1</span>  Basic usage</a></li>
  <li><a href="#control-the-clustering-of-the-rows-and-columns" id="toc-control-the-clustering-of-the-rows-and-columns" class="nav-link" data-scroll-target="#control-the-clustering-of-the-rows-and-columns"><span class="toc-section-number">16.2</span>  Control the clustering of the rows and columns</a></li>
  <li><a href="#limit-the-number-of-terms-reported" id="toc-limit-the-number-of-terms-reported" class="nav-link" data-scroll-target="#limit-the-number-of-terms-reported"><span class="toc-section-number">16.3</span>  Limit the number of terms reported</a></li>
  <li><a href="#flip-the-output-heatmap" id="toc-flip-the-output-heatmap" class="nav-link" data-scroll-target="#flip-the-output-heatmap"><span class="toc-section-number">16.4</span>  Flip the output heatmap</a></li>
  <li><a href="#restrict-the-ontology-levels" id="toc-restrict-the-ontology-levels" class="nav-link" data-scroll-target="#restrict-the-ontology-levels"><span class="toc-section-number">16.5</span>  Restrict the ontology levels</a></li>
  <li><a href="#select-other-go-ontologies" id="toc-select-other-go-ontologies" class="nav-link" data-scroll-target="#select-other-go-ontologies"><span class="toc-section-number">16.6</span>  Select other GO ontologies</a></li>
  <li><a href="#reverse-the-order-of-the-heatmaps" id="toc-reverse-the-order-of-the-heatmaps" class="nav-link" data-scroll-target="#reverse-the-order-of-the-heatmaps"><span class="toc-section-number">16.7</span>  Reverse the order of the heatmaps</a></li>
  <li><a href="#increase-the-gap-between-heatmaps" id="toc-increase-the-gap-between-heatmaps" class="nav-link" data-scroll-target="#increase-the-gap-between-heatmaps"><span class="toc-section-number">16.8</span>  Increase the gap between heatmaps</a></li>
  <li><a href="#increase-the-cell-size-of-the-heatmap" id="toc-increase-the-cell-size-of-the-heatmap" class="nav-link" data-scroll-target="#increase-the-cell-size-of-the-heatmap"><span class="toc-section-number">16.9</span>  Increase the cell size of the heatmap</a></li>
  <li><a href="#modify-default-colors" id="toc-modify-default-colors" class="nav-link" data-scroll-target="#modify-default-colors"><span class="toc-section-number">16.10</span>  Modify default colors</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/enblacar/SCpubr/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">
<span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Grouped GO Term analysis plots</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>More often than not in a Single-Cell Transcriptomics analysis, one comes across a list of genes. This might be the result of computing Differentially Expressed genes, running Non-Negative Matrix Factorization, for instance. In order to get a sense of what the role that the genes in the list play, we can make use of <a href="https://bioconductor.org/packages/release/bioc/html/clusterProfiler.html"><strong>clusterProfiler</strong></a> package. This package has, among other incredible functions, one called <code>groupGO()</code>, which outputs a matrix of the GO terms associated with the genes in the list, across the different GO ontologies and levels.</p>
<p><code>SCpubr</code>makes use of these output matrices and represent them as heatmaps with the <code><a href="https://rdrr.io/pkg/SCpubr/man/do_GroupedGOTermPlot.html">SCpubr::do_GroupedGOTermPlot()</a></code> function.</p>
<section id="basic-usage" class="level2" data-number="16.1"><h2 data-number="16.1" class="anchored" data-anchor-id="basic-usage">
<span class="header-section-number">16.1</span> Basic usage</h2>
<p>The basic usage of this function will compute all the GO terms associated with the genes for the <strong>Biological Process</strong> ontology, and return all the matrices for all the levels as well as the individual heatmaps for each level plus a combined one with all of them. All of this is returned <strong>as a list</strong> object, that we can then navigate to obtain the plot/matrix that we want. We will also need a <strong>database</strong> object, such as the one provided by the <a href="https://bioconductor.org/packages/release/data/annotation/html/org.Hs.eg.db.html"><strong>org.Hs.eg.db</strong></a> package.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">genes.use</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CENPK"</span>, <span class="st">"CENPE"</span>, <span class="st">"BRCA1"</span>, <span class="st">"VWF"</span>, <span class="st">"CD8A"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute the grouped GO terms.</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GroupedGOTermPlot.html">do_GroupedGOTermPlot</a></span><span class="op">(</span>genes <span class="op">=</span> <span class="va">genes.use</span>,</span>
<span>                                    org.db <span class="op">=</span> <span class="va">org.Hs.eg.db</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here is how the one of the output matrices looks like:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Retrieve one of the output matrices.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">Matrices</span><span class="op">$</span><span class="va">BP</span><span class="op">$</span><span class="va">`Lv. 3`</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    ID</span></span>
<span><span class="co">#&gt; GO:0050794 GO:0050794</span></span>
<span><span class="co">#&gt; GO:0048518 GO:0048518</span></span>
<span><span class="co">#&gt; GO:0050789 GO:0050789</span></span>
<span><span class="co">#&gt; GO:0007049 GO:0007049</span></span>
<span><span class="co">#&gt; GO:0007059 GO:0007059</span></span>
<span><span class="co">#&gt; GO:0007154 GO:0007154</span></span>
<span><span class="co">#&gt;                                          Description Count</span></span>
<span><span class="co">#&gt; GO:0050794            Regulation of cellular process     4</span></span>
<span><span class="co">#&gt; GO:0048518 Positive regulation of biological process     4</span></span>
<span><span class="co">#&gt; GO:0050789          Regulation of biological process     4</span></span>
<span><span class="co">#&gt; GO:0007049                                Cell cycle     3</span></span>
<span><span class="co">#&gt; GO:0007059                    Chromosome segregation     3</span></span>
<span><span class="co">#&gt; GO:0007154                        Cell communication     3</span></span>
<span><span class="co">#&gt;            GeneRatio               geneID</span></span>
<span><span class="co">#&gt; GO:0050794       4/5 CENPE/BRCA1/VWF/CD8A</span></span>
<span><span class="co">#&gt; GO:0048518       4/5 CENPE/BRCA1/VWF/CD8A</span></span>
<span><span class="co">#&gt; GO:0050789       4/5 CENPE/BRCA1/VWF/CD8A</span></span>
<span><span class="co">#&gt; GO:0007049       3/5    CENPK/CENPE/BRCA1</span></span>
<span><span class="co">#&gt; GO:0007059       3/5    CENPK/CENPE/BRCA1</span></span>
<span><span class="co">#&gt; GO:0007154       3/5       BRCA1/VWF/CD8A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And this is the output combined heatmap:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plot the output combined heatmap.</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">Plots</span><span class="op">$</span><span class="va">BP</span><span class="op">$</span><span class="va">Combined</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="17-GroupedGOPlots_files/figure-html/unnamed-chunk-4-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Combined heatmap.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Please note:
</div>
</div>
<div class="callout-body-container callout-body">
<p>This function might take a while to compute, specially for the <strong>Biological Process</strong> ontology. If you are running it interactively, consider passing <code>verbose = TRUE</code> to see the process.</p>
</div>
</div>
</section><section id="control-the-clustering-of-the-rows-and-columns" class="level2" data-number="16.2"><h2 data-number="16.2" class="anchored" data-anchor-id="control-the-clustering-of-the-rows-and-columns">
<span class="header-section-number">16.2</span> Control the clustering of the rows and columns</h2>
<p>By default, both rows and columns are clustered to group the terms together. If one wants to customize this behaviour, we just need to pass <code>cluster_cols = FALSE</code> or <code>cluster_rows = FALSE</code> to the function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compute the grouped GO terms.</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GroupedGOTermPlot.html">do_GroupedGOTermPlot</a></span><span class="op">(</span>genes <span class="op">=</span> <span class="va">genes.use</span>,</span>
<span>                                    org.db <span class="op">=</span> <span class="va">org.Hs.eg.db</span>,</span>
<span>                                    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                    cluster_cols <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the output combined heatmap.</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">Plots</span><span class="op">$</span><span class="va">BP</span><span class="op">$</span><span class="va">Combined</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="17-GroupedGOPlots_files/figure-html/unnamed-chunk-5-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Control the clustering of rows and columns.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="limit-the-number-of-terms-reported" class="level2" data-number="16.3"><h2 data-number="16.3" class="anchored" data-anchor-id="limit-the-number-of-terms-reported">
<span class="header-section-number">16.3</span> Limit the number of terms reported</h2>
<p>By default, the terms displays have to be shared in between three of the genes if the provided list of genes has more than four genes. However, we can control this behavior using <code>min.overlap</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compute the grouped GO terms.</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GroupedGOTermPlot.html">do_GroupedGOTermPlot</a></span><span class="op">(</span>genes <span class="op">=</span> <span class="va">genes.use</span>,</span>
<span>                                    org.db <span class="op">=</span> <span class="va">org.Hs.eg.db</span>,</span>
<span>                                    min.overlap <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the output combined heatmap.</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">Plots</span><span class="op">$</span><span class="va">BP</span><span class="op">$</span><span class="va">Combined</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="17-GroupedGOPlots_files/figure-html/unnamed-chunk-6-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Limit the number of terms reported.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="flip-the-output-heatmap" class="level2" data-number="16.4"><h2 data-number="16.4" class="anchored" data-anchor-id="flip-the-output-heatmap">
<span class="header-section-number">16.4</span> Flip the output heatmap</h2>
<p>We might as well be interested in having a vertically-aligned heatmap instead. This can be achieved by using <code>flip = FALSE</code> (as the default version is already flipped).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compute the grouped GO terms.</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GroupedGOTermPlot.html">do_GroupedGOTermPlot</a></span><span class="op">(</span>genes <span class="op">=</span> <span class="va">genes.use</span>,</span>
<span>                                    org.db <span class="op">=</span> <span class="va">org.Hs.eg.db</span>,</span>
<span>                                    min.overlap <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                                    flip <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the output combined heatmap.</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">Plots</span><span class="op">$</span><span class="va">BP</span><span class="op">$</span><span class="va">Combined</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="17-GroupedGOPlots_files/figure-html/unnamed-chunk-7-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Flip the output heatmap.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="restrict-the-ontology-levels" class="level2" data-number="16.5"><h2 data-number="16.5" class="anchored" data-anchor-id="restrict-the-ontology-levels">
<span class="header-section-number">16.5</span> Restrict the ontology levels</h2>
<p>If we are sure of which ontology levels we want to display the terms, we can restrict the output to those by using <code>levels.use</code>. This works in combination with <code>min.overlap</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compute the grouped GO terms.</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GroupedGOTermPlot.html">do_GroupedGOTermPlot</a></span><span class="op">(</span>genes <span class="op">=</span> <span class="va">genes.use</span>,</span>
<span>                                    org.db <span class="op">=</span> <span class="va">org.Hs.eg.db</span>,</span>
<span>                                    min.overlap <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                                    levels.use <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the output combined heatmap.</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">Plots</span><span class="op">$</span><span class="va">BP</span><span class="op">$</span><span class="va">Combined</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="17-GroupedGOPlots_files/figure-html/unnamed-chunk-8-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Restrict the ontology levels.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="select-other-go-ontologies" class="level2" data-number="16.6"><h2 data-number="16.6" class="anchored" data-anchor-id="select-other-go-ontologies">
<span class="header-section-number">16.6</span> Select other GO ontologies</h2>
<p>We can retrieve terms for other GO ontologies by using <code>GO_ontology</code> parameter with either:</p>
<ul>
<li>
<strong>BP</strong>: For <strong>B</strong>iological <strong>P</strong>rocess.</li>
<li>
<strong>MF</strong>: For <strong>M</strong>olecular <strong>F</strong>unction.</li>
<li>
<strong>CC</strong>: For <strong>C</strong>ellular <strong>C</strong>omponent.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compute the grouped GO terms.</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GroupedGOTermPlot.html">do_GroupedGOTermPlot</a></span><span class="op">(</span>genes <span class="op">=</span> <span class="va">genes.use</span>,</span>
<span>                                    org.db <span class="op">=</span> <span class="va">org.Hs.eg.db</span>,</span>
<span>                                    min.overlap <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                    GO_ontology <span class="op">=</span> <span class="st">"MF"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the output combined heatmap.</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">Plots</span><span class="op">$</span><span class="va">MF</span><span class="op">$</span><span class="va">Combined</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="17-GroupedGOPlots_files/figure-html/unnamed-chunk-9-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Use other GO ontologies.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="reverse-the-order-of-the-heatmaps" class="level2" data-number="16.7"><h2 data-number="16.7" class="anchored" data-anchor-id="reverse-the-order-of-the-heatmaps">
<span class="header-section-number">16.7</span> Reverse the order of the heatmaps</h2>
<p>As can be noticed, the heatmaps are ordered <strong>in inverse order</strong>. This is due to the fact that <a href=""><strong>ComplexHeatmap</strong></a> arranges the alignment of heatmaps using one as a <strong>principal</strong> heatmap. By using the normal ordering, the rows are columns, that are clustered, will be done based on the <strong>low-level</strong> terms instead of the most specific ones. However, this behaviour can be reverted using <code>reverse.levels = FALSE</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compute the grouped GO terms.</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GroupedGOTermPlot.html">do_GroupedGOTermPlot</a></span><span class="op">(</span>genes <span class="op">=</span> <span class="va">genes.use</span>,</span>
<span>                                    org.db <span class="op">=</span> <span class="va">org.Hs.eg.db</span>,</span>
<span>                                    min.overlap <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                                    levels.use <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                                    reverse.levels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the output combined heatmap.</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">Plots</span><span class="op">$</span><span class="va">BP</span><span class="op">$</span><span class="va">Combined</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="17-GroupedGOPlots_files/figure-html/unnamed-chunk-10-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Reverse the order of the heatmaps.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="increase-the-gap-between-heatmaps" class="level2" data-number="16.8"><h2 data-number="16.8" class="anchored" data-anchor-id="increase-the-gap-between-heatmaps">
<span class="header-section-number">16.8</span> Increase the gap between heatmaps</h2>
<p>By default, this is set to 0.5 cm by the <code>heatmap_gap</code> parameter.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compute the grouped GO terms.</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GroupedGOTermPlot.html">do_GroupedGOTermPlot</a></span><span class="op">(</span>genes <span class="op">=</span> <span class="va">genes.use</span>,</span>
<span>                                    org.db <span class="op">=</span> <span class="va">org.Hs.eg.db</span>,</span>
<span>                                    min.overlap <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                                    levels.use <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                                    heatmap_gap <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the output combined heatmap.</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">Plots</span><span class="op">$</span><span class="va">BP</span><span class="op">$</span><span class="va">Combined</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="17-GroupedGOPlots_files/figure-html/unnamed-chunk-11-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Increase the gap between heatmaps.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="increase-the-cell-size-of-the-heatmap" class="level2" data-number="16.9"><h2 data-number="16.9" class="anchored" data-anchor-id="increase-the-cell-size-of-the-heatmap">
<span class="header-section-number">16.9</span> Increase the cell size of the heatmap</h2>
<p>We can modify the tile size of the heatamaps by using <code>cell_size</code> paramter:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compute the grouped GO terms.</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GroupedGOTermPlot.html">do_GroupedGOTermPlot</a></span><span class="op">(</span>genes <span class="op">=</span> <span class="va">genes.use</span>,</span>
<span>                                    org.db <span class="op">=</span> <span class="va">org.Hs.eg.db</span>,</span>
<span>                                    min.overlap <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                                    levels.use <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                                    cell_size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the output combined heatmap.</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">Plots</span><span class="op">$</span><span class="va">BP</span><span class="op">$</span><span class="va">Combined</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="17-GroupedGOPlots_files/figure-html/unnamed-chunk-12-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Modify the tile size.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="modify-default-colors" class="level2" data-number="16.10"><h2 data-number="16.10" class="anchored" data-anchor-id="modify-default-colors">
<span class="header-section-number">16.10</span> Modify default colors</h2>
<p>Finally, we can modify the default colors of the heatmap by using <code>colors.use</code> and provide two colors. The first will map to the absent values and the second to the present values.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compute the grouped GO terms.</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GroupedGOTermPlot.html">do_GroupedGOTermPlot</a></span><span class="op">(</span>genes <span class="op">=</span> <span class="va">genes.use</span>,</span>
<span>                                    org.db <span class="op">=</span> <span class="va">org.Hs.eg.db</span>,</span>
<span>                                    min.overlap <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                                    levels.use <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                                    colors.use <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lightblue"</span>, <span class="st">"navyblue"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the output combined heatmap.</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">Plots</span><span class="op">$</span><span class="va">BP</span><span class="op">$</span><span class="va">Combined</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="17-GroupedGOPlots_files/figure-html/unnamed-chunk-13-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Modify the colors.</figcaption><p></p>
</figure>
</div>
</div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./16-GroupwiseDEPlots.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Group-wise DE analysis plots</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./17-FunctionalEnrichmentPlots.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Functional Annotation Analysis plots</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Written by <strong>Enrique Blanco Carmona</strong></div>   
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>