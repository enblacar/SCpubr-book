<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>7 Bar plots | SCpubr</title>
<meta name="author" content="Enrique Blanco Carmona">
<meta name="description" content="Bar plots are another well known data representation. They are a very handy resource to plot summary statistics for the QC part of any single-cell analysis. Consequently, they are part of SCpubr,...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="7 Bar plots | SCpubr">
<meta property="og:type" content="book">
<meta property="og:url" content="https://enblacar.github.io/SCpubr-book/bar-plots.html">
<meta property="og:image" content="https://enblacar.github.io/SCpubr-book/images/SCpubr_logo.png">
<meta property="og:description" content="Bar plots are another well known data representation. They are a very handy resource to plot summary statistics for the QC part of any single-cell analysis. Consequently, they are part of SCpubr,...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="7 Bar plots | SCpubr">
<meta name="twitter:description" content="Bar plots are another well known data representation. They are a very handy resource to plot summary statistics for the QC part of any single-cell analysis. Consequently, they are part of SCpubr,...">
<meta name="twitter:image" content="https://enblacar.github.io/SCpubr-book/images/SCpubr_logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link rel="shortcut icon" href="images/SCpubr_logo_favicon.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a id="toc_title" href="index.html" title="">SCpubr</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <div class="book-extra"></div>
      <nav id="left-panel" aria-label="Table of contents"><ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About this package</a></li>
<li><a class="" href="installation-guide.html">Installation guide</a></li>
<li><a class="" href="dataset-used.html">Dataset used</a></li>
<li><a class="" href="dim-plots.html"><span class="header-section-number">1</span> Dim plots</a></li>
<li><a class="" href="feature-plots.html"><span class="header-section-number">2</span> Feature plots</a></li>
<li><a class="" href="nebulosa-plots.html"><span class="header-section-number">3</span> Nebulosa plots</a></li>
<li><a class="" href="bee-swarm-plots.html"><span class="header-section-number">4</span> Bee Swarm plots</a></li>
<li><a class="" href="violin-plots.html"><span class="header-section-number">5</span> Violin plots</a></li>
<li><a class="" href="dot-plots.html"><span class="header-section-number">6</span> Dot plots</a></li>
<li><a class="active" href="bar-plots.html"><span class="header-section-number">7</span> Bar plots</a></li>
<li><a class="" href="term-enrichment-plots.html"><span class="header-section-number">8</span> Term Enrichment Plots</a></li>
<li><a class="" href="enrichment-score-heatmaps.html"><span class="header-section-number">9</span> Enrichment score heatmaps</a></li>
<li><a class="" href="correlation-matrix-heatmaps.html"><span class="header-section-number">10</span> Correlation matrix heatmaps</a></li>
<li><a class="" href="cellular-state-plots.html"><span class="header-section-number">11</span> Cellular State Plots</a></li>
<li><a class="" href="common-features-across-plots.html">Common features across plots</a></li>
<li><a class="" href="rasterized-figures.html">Rasterized figures</a></li>
<li><a class="" href="save-the-figures.html">Save the figures</a></li>
<li><a class="" href="troubleshooting.html">Troubleshooting</a></li>
<li><a class="" href="citation.html">Citation</a></li>
</ul>

        <div class="book-extra">
          <!-- Duplicated this entry to point to the package repo. -->
          <p class="mb-2"><a id="package-repo" href="https://github.com/enblacar/SCpubr">View package source <i class="fab fa-github"></i></a></p>
          <p><a id="book-repo" href="https://github.com/enblacar/SCpubr-book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="bar-plots" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Bar plots<a class="anchor" aria-label="anchor" href="#bar-plots"><i class="fas fa-link"></i></a>
</h1>
<p>Bar plots are another well known data representation. They are a very handy resource to plot summary statistics for the QC part of any single-cell analysis. Consequently, they are part of <code>SCpubr</code>, available on <code><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">SCpubr::do_BarPlot()</a></code>. Let’s say we are interested into plotting the different number of cells in each cluster.</p>
<div id="basic-usage-5" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage-5"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"seurat_clusters"</span>, 
                         legend <span class="op">=</span> <span class="cn">F</span>, 
                         plot.title <span class="op">=</span> <span class="st">"Number of cells per cluster"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"seurat_clusters"</span>, 
                         legend <span class="op">=</span> <span class="cn">F</span>, 
                         plot.title <span class="op">=</span> <span class="st">"Number of cells per cluster"</span>, 
                         horizontal <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="09-BarPlots_files/figure-html/unnamed-chunk-2-1.png" alt="SCpubr Bar plots, plotting single variables" width="100%" height="100%"><p class="caption">
Figure 1.1: SCpubr Bar plots, plotting single variables
</p>
</div>
<p>Using <code><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">SCpubr::do_BarPlot()</a></code> with only <code>features</code> yields a simple bar plot which is ordered by descending value. We can also set up the direction of the bars with <code>horizontal = TRUE/FALSE</code>, which by default is set to be vertical There are some underlying assumptions that are being taken to generate these plots:</p>
<ul>
<li>The values in <code>features</code> need to be metadata variables, stored in <code>object@meta.data</code>. This a design choice, as data need to be grouped using <code>dplyr</code> and <code>tidyr</code>. This will also later apply to values provided to <code>group.by</code>.</li>
<li>The feature provided need to have a clear and rather small number of groups. A good estimate on how to assess this is by querying the feature with <code>table</code>, as in <code>table(sample@meta.data[, feature])</code>.</li>
</ul>
<p>Focusing on the last point, this would happen if we were to choose a feature with a high number of unique values:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                        features <span class="op">=</span> <span class="st">"nCount_RNA"</span>, 
                        legend <span class="op">=</span> <span class="cn">F</span>, 
                        plot.title <span class="op">=</span> <span class="st">"Number of UMIs?"</span>,
                        horizontal <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="va">p</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="09-BarPlots_files/figure-html/unnamed-chunk-3-1.png" alt="SCpubr Bar plots, choosing the wrong variable" width="100%" height="100%"><p class="caption">
Figure 1.2: SCpubr Bar plots, choosing the wrong variable
</p>
</div>
<p>This happens, precisely, because of the high amount of unique values for <code>nCount_RNA</code>. These type of continuous values is best suited for other data visualizations like a <code>histogram</code>.</p>
</div>
<div id="grouping-by-a-second-variable" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Grouping by a second variable<a class="anchor" aria-label="anchor" href="#grouping-by-a-second-variable"><i class="fas fa-link"></i></a>
</h2>
<p>Let’s expand on the previous example on the number of cells per cluster. What if we were interested not only on that, but we would like to profile <strong>how many cells from each cluster are present in each of the unique samples present in the Seurat object</strong>? For this, we need to provide <code><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">SCpubr::do_BarPlot()</a></code> with a second parameter, <code>group.by</code>, that tackles how we want the feature to be grouped:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># We only have one value in orig.ident. Let's modify it so that it resembles a multi-sample Seurat object.</span>
<span class="va">sample</span><span class="op">$</span><span class="va">modified_orig.ident</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sample_A"</span>, <span class="st">"Sample_B"</span>, <span class="st">"Sample_C"</span><span class="op">)</span>, 
                                     size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span>, 
                                     replace <span class="op">=</span> <span class="cn">T</span>, 
                                     prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span><span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,
                         plot.title <span class="op">=</span> <span class="st">"Number of cells per sample"</span>,
                         position <span class="op">=</span> <span class="st">"stack"</span>,
                         legend <span class="op">=</span> <span class="cn">T</span>,
                         horizontal <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span><span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"modified_orig.ident"</span>, 
                         group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>,
                         plot.title <span class="op">=</span> <span class="st">"Number of cells per cluster and sample"</span>,
                         position <span class="op">=</span> <span class="st">"stack"</span>,
                         legend <span class="op">=</span> <span class="cn">T</span>,
                         horizontal <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="09-BarPlots_files/figure-html/unnamed-chunk-4-1.png" alt="SCpubr Bar plots, introducing a variable to group values by" width="100%" height="100%"><p class="caption">
Figure 1.3: SCpubr Bar plots, introducing a variable to group values by
</p>
</div>
<p>As we can see, this nicely yields as many number of bars as unique values in the <code>feature</code>, and this bars are segmented by as many times as unique values in <code>group.by</code>. At first, this is hard to grasp, but it helps thinking of these two parameters, when used together, as:</p>
<ul>
<li>
<code>feature</code>: What I want to show as different bars.</li>
<li>
<code>group.by</code>: Secondary variable on which the bars generated by <code>feature</code> can be further subdivided.</li>
</ul>
<p>Another interesting parameter introduced in the last example is <code>position</code>. Position can be either <code>stack</code> or <code>fill</code>. The difference between them is that <code>position = "stack"</code> will yield the total number of cells for each of the unique values in <code>feature</code>, while <code>position = "fill"</code> will bring all bars to the same height and will split each bar into the proportions within each bar of the different groups (only one if <code>group.by = NULL</code> and as many groups if <code>group.by</code> is used). Therefore, it becomes highly recommended to use <code>position = "stack"</code> when <code>group.by</code> is not used and <code>position = "fill"</code> otherwise. This is also warned by the package. If you want to silence the warnings, use <code>verbose = FALSE</code>.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># We are going to use the previously generated sample assignment.</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span><span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,
                         plot.title <span class="op">=</span> <span class="st">"Without group.by - position = stack"</span>,
                         position <span class="op">=</span> <span class="st">"stack"</span>,
                         legend <span class="op">=</span> <span class="cn">T</span>,
                         horizontal <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span><span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,
                         plot.title <span class="op">=</span> <span class="st">"Without group.by - position = fill"</span>,
                         position <span class="op">=</span> <span class="st">"fill"</span>,
                         legend <span class="op">=</span> <span class="cn">T</span>,
                         horizontal <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>

<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span><span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,
                         group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>,
                         plot.title <span class="op">=</span> <span class="st">"With group.by - position = stack"</span>,
                         position <span class="op">=</span> <span class="st">"stack"</span>,
                         legend <span class="op">=</span> <span class="cn">T</span>,
                         horizontal <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>

<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span><span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,
                         group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>,
                         plot.title <span class="op">=</span> <span class="st">"With group.by - position = fill"</span>,
                         position <span class="op">=</span> <span class="st">"fill"</span>,
                         legend <span class="op">=</span> <span class="cn">T</span>,
                         horizontal <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p3</span> <span class="op">|</span> <span class="va">p4</span><span class="op">)</span>
<span class="va">p</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="09-BarPlots_files/figure-html/unnamed-chunk-5-1.png" alt="SCpubr Bar plots, difference between position" width="100%" height="100%"><p class="caption">
Figure 1.4: SCpubr Bar plots, difference between position
</p>
</div>
</div>
<div id="reordering-columns-based-on-a-single-entity" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Reordering columns based on a single entity<a class="anchor" aria-label="anchor" href="#reordering-columns-based-on-a-single-entity"><i class="fas fa-link"></i></a>
</h2>
<p>One advanced use of bar plots, but a very useful one is to reorder the columns based on a single entity in a descending order. This works only when <code>group.by</code> is set up and best when <code>position = "fill"</code>. For instance, imagine the scenario in which we are heavily interested in cluster 1, and want to reorder the columns based on it. This is achieved by providing <code>order.by</code> parameter to <code><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">SCpubr::do_BarPlot()</a></code>. The value in <code>order.by</code> has to be necessary one of the unique values in <code>group.by</code>. Therefore, as a best practice, one would want to generate the bar plots without using <code>order.by</code> and then decide. Let’s also, for the sake of this example, modify the proportions of cluster 1 so that it becomes really evident. This is how it looks:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Modify proportions. </span>
<span class="va">sample</span><span class="op">$</span><span class="va">modified_seurat_clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">sample</span><span class="op">$</span><span class="va">seurat_clusters</span><span class="op">)</span>
<span class="va">sample</span><span class="op">$</span><span class="va">modified_seurat_clusters</span><span class="op">[</span><span class="va">sample</span><span class="op">$</span><span class="va">modified_orig.ident</span> <span class="op">==</span> <span class="st">"Sample_A"</span> <span class="op">&amp;</span> <span class="va">sample</span><span class="op">$</span><span class="va">modified_seurat_clusters</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>, <span class="st">"7"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"1"</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span><span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,
                         group.by <span class="op">=</span> <span class="st">"modified_seurat_clusters"</span>,
                         plot.title <span class="op">=</span> <span class="st">"Number of cells per sample"</span>,
                         order.by <span class="op">=</span> <span class="st">"1"</span>,
                         position <span class="op">=</span> <span class="st">"stack"</span>,
                         legend <span class="op">=</span> <span class="cn">T</span>,
                         horizontal <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span><span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"modified_orig.ident"</span>, 
                         group.by <span class="op">=</span> <span class="st">"modified_seurat_clusters"</span>,
                         plot.title <span class="op">=</span> <span class="st">"Number of cells per cluster and sample"</span>,
                         order.by <span class="op">=</span> <span class="st">"1"</span>,
                         position <span class="op">=</span> <span class="st">"fill"</span>,
                         legend <span class="op">=</span> <span class="cn">T</span>,
                         horizontal <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="09-BarPlots_files/figure-html/unnamed-chunk-6-1.png" alt="SCpubr Bar plots, reordering the colums using order.by" width="100%" height="100%"><p class="caption">
Figure 1.5: SCpubr Bar plots, reordering the colums using order.by
</p>
</div>
</div>
<div id="adding-the-exact-values-to-the-bars" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> Adding the exact values to the bars<a class="anchor" aria-label="anchor" href="#adding-the-exact-values-to-the-bars"><i class="fas fa-link"></i></a>
</h2>
<p>Sometimes, we are interested not only in displaying the bars but also reporting the exact number for each bar. This can be achieved by using <code>add.summary_labels = TRUE</code>:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"seurat_clusters"</span>, 
                         legend <span class="op">=</span> <span class="cn">FALSE</span>,
                         add.summary_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"seurat_clusters"</span>, 
                         legend <span class="op">=</span> <span class="cn">FALSE</span>,
                         horizontal <span class="op">=</span> <span class="cn">TRUE</span>,
                         add.summary_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-7"></span>
<img src="09-BarPlots_files/figure-html/unnamed-chunk-7-1.png" alt="SCpubr, Adding labels to bars" width="100%" height="100%"><p class="caption">
Figure 1.6: SCpubr, Adding labels to bars
</p>
</div>
<p>The size of the labels can be adjusted by using <code>size.labels</code>. The default value is 3. This value changes the size quite drastically. Modification by low ammounts is reccomended.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"seurat_clusters"</span>, 
                         legend <span class="op">=</span> <span class="cn">FALSE</span>,
                         add.summary_labels <span class="op">=</span> <span class="cn">TRUE</span>,
                         size.labels <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"seurat_clusters"</span>, 
                         legend <span class="op">=</span> <span class="cn">FALSE</span>,
                         horizontal <span class="op">=</span> <span class="cn">TRUE</span>,
                         add.summary_labels <span class="op">=</span> <span class="cn">TRUE</span>,
                         size.labels <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="09-BarPlots_files/figure-html/unnamed-chunk-8-1.png" alt="SCpubr, Modifying the size of the labels in the bars" width="100%" height="100%"><p class="caption">
Figure 1.7: SCpubr, Modifying the size of the labels in the bars
</p>
</div>
<p>When using in combination with <code>group.by</code>, it also adds the value on top of each bar:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"seurat_clusters"</span>,
                         group.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,
                         legend <span class="op">=</span> <span class="cn">TRUE</span>,
                         add.summary_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"seurat_clusters"</span>,
                         group.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span>, 
                         legend <span class="op">=</span> <span class="cn">TRUE</span>,
                         horizontal <span class="op">=</span> <span class="cn">TRUE</span>,
                         add.summary_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-9"></span>
<img src="09-BarPlots_files/figure-html/unnamed-chunk-9-1.png" alt="SCpubr, Adding labels to bars when grouped by another variable" width="100%" height="100%"><p class="caption">
Figure 1.8: SCpubr, Adding labels to bars when grouped by another variable
</p>
</div>
<p>If we are also interested in adding labels to each of the bar sugroups, we can do so by using <code>add.subgroup_labels = TRUE</code>:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"seurat_clusters"</span>,
                         group.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,
                         legend <span class="op">=</span> <span class="cn">TRUE</span>,
                         add.summary_labels <span class="op">=</span> <span class="cn">TRUE</span>,
                         add.subgroup_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"seurat_clusters"</span>,
                         group.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span>, 
                         legend <span class="op">=</span> <span class="cn">TRUE</span>,
                         horizontal <span class="op">=</span> <span class="cn">TRUE</span>,
                         add.summary_labels <span class="op">=</span> <span class="cn">TRUE</span>,
                         add.subgroup_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="09-BarPlots_files/figure-html/unnamed-chunk-10-1.png" alt="SCpubr, Adding labels to bars and subgroups when grouped by another variable" width="100%" height="100%"><p class="caption">
Figure 1.9: SCpubr, Adding labels to bars and subgroups when grouped by another variable
</p>
</div>
<p>As can be observed, this type of labelling is very situational and highly depends on the overall structure of the bars and whether it is feasible to plot that many labels. In order to ease this cluttering, one can pass <code>repel.subroup_labels = TRUE</code> to avoid overlapping of the group labels (the colored ones inside the bars).</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"seurat_clusters"</span>,
                         group.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,
                         legend <span class="op">=</span> <span class="cn">TRUE</span>,
                         add.summary_labels <span class="op">=</span> <span class="cn">TRUE</span>,
                         add.subgroup_labels <span class="op">=</span> <span class="cn">TRUE</span>,
                         repel.subgroup_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"seurat_clusters"</span>,
                         group.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span>, 
                         legend <span class="op">=</span> <span class="cn">TRUE</span>,
                         horizontal <span class="op">=</span> <span class="cn">TRUE</span>,
                         add.summary_labels <span class="op">=</span> <span class="cn">TRUE</span>,
                         add.subgroup_labels <span class="op">=</span> <span class="cn">TRUE</span>,
                         repel.subgroup_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-11"></span>
<img src="09-BarPlots_files/figure-html/unnamed-chunk-11-1.png" alt="SCpubr, Relocating group labels" width="100%" height="100%"><p class="caption">
Figure 1.10: SCpubr, Relocating group labels
</p>
</div>
<p>If we also want the summary labels (the ones in black at the top of each bar) to relocate, we can use <code>repel.summary_labels = TRUE</code>. This combination of parameters were designed to grant the user freedom to keep either of the two groups of labels centered and to make either group appear or disappear (as each bar plot will have a different scenario and sometimes it might be a viable option).</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"seurat_clusters"</span>,
                         group.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,
                         legend <span class="op">=</span> <span class="cn">TRUE</span>,
                         add.summary_labels <span class="op">=</span> <span class="cn">TRUE</span>,
                         add.subgroup_labels <span class="op">=</span> <span class="cn">TRUE</span>,
                         repel.summary_labels <span class="op">=</span> <span class="cn">TRUE</span>,
                         repel.subgroup_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, 
                         features <span class="op">=</span> <span class="st">"seurat_clusters"</span>,
                         group.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,
                         legend <span class="op">=</span> <span class="cn">TRUE</span>,
                         horizontal <span class="op">=</span> <span class="cn">TRUE</span>,
                         add.summary_labels <span class="op">=</span> <span class="cn">TRUE</span>,
                         add.subgroup_labels <span class="op">=</span> <span class="cn">TRUE</span>,
                         repel.summary_labels <span class="op">=</span> <span class="cn">TRUE</span>,
                         repel.subgroup_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-12"></span>
<img src="09-BarPlots_files/figure-html/unnamed-chunk-12-1.png" alt="SCpubr, Adding relocating all bars" width="100%" height="100%"><p class="caption">
Figure 1.11: SCpubr, Adding relocating all bars
</p>
</div>
<p>From the time being, the labelling feature is only available on <code>position = "stack"</code>.</p>
</div>
<div id="retrieving-the-data-matrix" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> Retrieving the data matrix<a class="anchor" aria-label="anchor" href="#retrieving-the-data-matrix"><i class="fas fa-link"></i></a>
</h2>
<p>Many times, not only we are interested in actually displaying the data, but we do also want to store the data matrix. This is a common case for supplementary material in publications. To assess this, one can set <code>return_data_matrix = TRUE</code>, which will output a list containing both the plot and the data matrix (long and wide format). This does also work when several features are queried at the same time. Both for <code>position = "fill"</code> and <code>position = "stack"</code> the output will be the same, the total counts.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_BarPlot.html">do_BarPlot</a></span><span class="op">(</span><span class="va">sample</span>, 
                             features <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,
                             group.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>,
                             legend <span class="op">=</span> <span class="cn">TRUE</span>,
                             horizontal <span class="op">=</span> <span class="cn">FALSE</span>,
                             return_data_matrix <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># Retrieve plot.</span>
<span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">output</span><span class="op">$</span><span class="va">plot</span>

<span class="co"># Retrieve data in long format.</span>
<span class="va">data.long</span> <span class="op">&lt;-</span> <span class="va">output</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="st">"modified_orig.ident"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">long</span>

<span class="co"># Retrieve data in wide format.</span>
<span class="va">data.wide</span> <span class="op">&lt;-</span> <span class="va">output</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="st">"modified_orig.ident"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">wide</span>

<span class="co"># Show data in long format.</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data.long</span>, <span class="fl">15</span><span class="op">)</span>, booktabs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>font_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
modified_orig.ident
</th>
<th style="text-align:left;">
seurat_clusters
</th>
<th style="text-align:right;">
n
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Sample_B
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
2678
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_B
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1893
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_B
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
935
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_B
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
768
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_A
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
767
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_B
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
704
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_A
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
532
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_B
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
416
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_C
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
387
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_B
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
341
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_A
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
258
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_C
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
256
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_B
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
227
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_A
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
223
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_A
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
221
</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Show data in wide format.</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data.wide</span>, <span class="fl">15</span><span class="op">)</span>, booktabs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>font_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
seurat_clusters
</th>
<th style="text-align:right;">
Sample_B
</th>
<th style="text-align:right;">
Sample_A
</th>
<th style="text-align:right;">
Sample_C
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
2678
</td>
<td style="text-align:right;">
767
</td>
<td style="text-align:right;">
387
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
1893
</td>
<td style="text-align:right;">
532
</td>
<td style="text-align:right;">
256
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
935
</td>
<td style="text-align:right;">
258
</td>
<td style="text-align:right;">
117
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
768
</td>
<td style="text-align:right;">
223
</td>
<td style="text-align:right;">
136
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
704
</td>
<td style="text-align:right;">
221
</td>
<td style="text-align:right;">
111
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
416
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
57
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
341
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
44
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
227
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
36
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
17
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
14
</td>
</tr>
</tbody>
</table></div>
<p>Each type of data matrix is beneficial for different purposes. Long data is the desired format if you want to store the data matrix for future use in plotting. Wide data, in turn, is easier to understand right away.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="dot-plots.html"><span class="header-section-number">6</span> Dot plots</a></div>
<div class="next"><a href="term-enrichment-plots.html"><span class="header-section-number">8</span> Term Enrichment Plots</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><form role="search" class="mt-4 mb-4">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>
      <div class="book-extra">
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#bar-plots"><span class="header-section-number">7</span> Bar plots</a></li>
<li><a class="nav-link" href="#basic-usage-5"><span class="header-section-number">7.1</span> Basic usage</a></li>
<li><a class="nav-link" href="#grouping-by-a-second-variable"><span class="header-section-number">7.2</span> Grouping by a second variable</a></li>
<li><a class="nav-link" href="#reordering-columns-based-on-a-single-entity"><span class="header-section-number">7.3</span> Reordering columns based on a single entity</a></li>
<li><a class="nav-link" href="#adding-the-exact-values-to-the-bars"><span class="header-section-number">7.4</span> Adding the exact values to the bars</a></li>
<li><a class="nav-link" href="#retrieving-the-data-matrix"><span class="header-section-number">7.5</span> Retrieving the data matrix</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<!-- Modified page for chapter. --><li><a id="book-source" href="https://github.com/enblacar/SCpubr-book/blob/main/09-BarPlots.Rmd">View chapter source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/enblacar/SCpubr-book/edit/main/09-BarPlots.Rmd">Edit this chapter <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    
  </div>

</nav>
</div>
</div> <!-- .container -->




</div>
</body>
<!-- Moved the footer outside of the body to make it span all page width. --><footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p class="text-center">Written by <strong>Enrique Blanco Carmona</strong> on 12 July, 2022.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p class="text-center">This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</html>
