<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>9 Geyser plots | SCpubr</title>
<meta name="author" content="Enrique Blanco Carmona">
<meta name="description" content="Geyser plots are a kind of scatter plots characterized by plotting a continuous variable on the Y axis and splitting the dots by a categorical variable on the X axis. This normally results in the...">
<meta name="generator" content="bookdown 0.28 with bs4_book()">
<meta property="og:title" content="9 Geyser plots | SCpubr">
<meta property="og:type" content="book">
<meta property="og:url" content="https://enblacar.github.io/SCpubr-book/geyser-plots.html">
<meta property="og:image" content="https://enblacar.github.io/SCpubr-book/images/logo.png">
<meta property="og:description" content="Geyser plots are a kind of scatter plots characterized by plotting a continuous variable on the Y axis and splitting the dots by a categorical variable on the X axis. This normally results in the...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="9 Geyser plots | SCpubr">
<meta name="twitter:description" content="Geyser plots are a kind of scatter plots characterized by plotting a continuous variable on the Y axis and splitting the dots by a categorical variable on the X axis. This normally results in the...">
<meta name="twitter:image" content="https://enblacar.github.io/SCpubr-book/images/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link rel="shortcut icon" href="images/SCpubr_logo_favicon.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a id="toc_title" href="index.html" title="">SCpubr</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <div class="book-extra"></div>
      <nav id="left-panel" aria-label="Table of contents"><ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About this package</a></li>
<li><a class="" href="installation-guide.html">Installation guide</a></li>
<li><a class="" href="dataset-used.html">Dataset used</a></li>
<li><a class="" href="dim-plots.html"><span class="header-section-number">1</span> Dim plots</a></li>
<li><a class="" href="feature-plots.html"><span class="header-section-number">2</span> Feature plots</a></li>
<li><a class="" href="nebulosa-plots.html"><span class="header-section-number">3</span> Nebulosa plots</a></li>
<li><a class="" href="bee-swarm-plots.html"><span class="header-section-number">4</span> Bee Swarm plots</a></li>
<li><a class="" href="violin-plots.html"><span class="header-section-number">5</span> Violin plots</a></li>
<li><a class="" href="ridge-plots.html"><span class="header-section-number">6</span> Ridge plots</a></li>
<li><a class="" href="dot-plots.html"><span class="header-section-number">7</span> Dot plots</a></li>
<li><a class="" href="bar-plots.html"><span class="header-section-number">8</span> Bar plots</a></li>
<li><a class="active" href="geyser-plots.html"><span class="header-section-number">9</span> Geyser plots</a></li>
<li><a class="" href="volcano-plots.html"><span class="header-section-number">10</span> Volcano plots</a></li>
<li><a class="" href="sankey-and-alluvial-plots.html"><span class="header-section-number">11</span> Sankey and alluvial plots</a></li>
<li><a class="" href="chord-diagram-plots.html"><span class="header-section-number">12</span> Chord Diagram plots</a></li>
<li><a class="" href="group-wise-de-analysis-plots.html"><span class="header-section-number">13</span> Group-wise DE analysis plots</a></li>
<li><a class="" href="term-enrichment-plots.html"><span class="header-section-number">14</span> Term Enrichment Plots</a></li>
<li><a class="" href="enrichment-score-heatmaps.html"><span class="header-section-number">15</span> Enrichment score heatmaps</a></li>
<li><a class="" href="correlation-matrix-heatmaps.html"><span class="header-section-number">16</span> Correlation matrix heatmaps</a></li>
<li><a class="" href="cellular-state-plots.html"><span class="header-section-number">17</span> Cellular State Plots</a></li>
<li><a class="" href="ligand-receptor-analysis.html"><span class="header-section-number">18</span> Ligand-Receptor analysis</a></li>
<li><a class="" href="copy-number-variant-analysis-plots.html"><span class="header-section-number">19</span> Copy Number Variant analysis plots</a></li>
<li><a class="" href="pathway-activity-inference-analysis.html"><span class="header-section-number">20</span> Pathway Activity inference analysis</a></li>
<li><a class="" href="tf-activity-inference-analysis.html"><span class="header-section-number">21</span> TF Activity inference analysis</a></li>
<li><a class="" href="pseudotime-analysis.html"><span class="header-section-number">22</span> Pseudotime analysis</a></li>
<li><a class="" href="color-palettes.html"><span class="header-section-number">23</span> Color palettes</a></li>
<li><a class="" href="common-features-across-plots.html">Common features across plots</a></li>
<li><a class="" href="rasterized-figures.html">Rasterized figures</a></li>
<li><a class="" href="save-the-figures.html">Save the figures</a></li>
<li><a class="" href="troubleshooting.html">Troubleshooting</a></li>
<li><a class="" href="citation.html">Citation</a></li>
</ul>

        <div class="book-extra">
          <!-- Duplicated this entry to point to the package repo. -->
          <p class="mb-2"><a id="package-repo" href="https://github.com/enblacar/SCpubr">View package source <i class="fab fa-github"></i></a></p>
          <p><a id="book-repo" href="https://github.com/enblacar/SCpubr-book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="geyser-plots" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Geyser plots<a class="anchor" aria-label="anchor" href="#geyser-plots"><i class="fas fa-link"></i></a>
</h1>
<p>Geyser plots are a kind of scatter plots characterized by plotting a continuous variable on the Y axis and splitting the dots by a categorical variable on the X axis. This normally results in the dots collapsing on a single line along the Y axis, but with jittering they can spread out, depicting a shape that resemble that of a Geyser. Furthermore, to better understand the distribution of data along the Y axis, distribution intervals are plotted on top of the Geyser plots. The dot depitcs the median of the data, while the end of the thick and thin lines represent 66% and 95% of the data in the group, respectively.</p>
<p>These plots are just an alternate way of representing what can be achieved with a violin plot. However, this version allows for a more aesthetic view while also allowing the user to further plot another extra variable on the dots, coloring with a continuous or a categorical scale.</p>
<div id="basic-usage-7" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage-7"><i class="fas fa-link"></i></a>
</h2>
<p>The most basic version of this plot uses only the X and Y variables, while the color of the cells is assigned to either of the two. We can achieve this by using <code><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">SCpubr::do_GeyserPlot()</a></code> and stating the kind of color scale we want with <code>scale_type</code> (either continuous or categorical).</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Geyser plot with categorical color scale.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"nCount_RNA"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"categorical"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geyser plot with continuous color scale.</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"nCount_RNA"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="11-GeyserPlots_files/figure-html/unnamed-chunk-2-1.png" alt="SCpubr do_GeyserPlot regular use." width="100%" height="100%"><p class="caption">
Figure 1.1: SCpubr do_GeyserPlot regular use.
</p>
</div>
</div>
<div id="ordering-by-mean-values" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Ordering by mean values<a class="anchor" aria-label="anchor" href="#ordering-by-mean-values"><i class="fas fa-link"></i></a>
</h2>
<p>First thing that one notice, is that the geysers are ordered from highest to lowest mean values. This can be nullified by using <code>order_by_mean = FALSE</code>. In this case, the geysers will order based on alphabetical order or on the levels if the variable chosen is a factor.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Geyser plot with categorical color scale without ordering by mean.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"nCount_RNA"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"categorical"</span>,</span>
<span>                            order_by_mean <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geyser plot with continuous color scale without ordering by mean.</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"nCount_RNA"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            order_by_mean <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="11-GeyserPlots_files/figure-html/unnamed-chunk-3-1.png" alt="SCpubr do_GeyserPlot without ordering by the mean." width="100%" height="100%"><p class="caption">
Figure 1.2: SCpubr do_GeyserPlot without ordering by the mean.
</p>
</div>
</div>
<div id="plotting-symmetrical-scales" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> Plotting symmetrical scales<a class="anchor" aria-label="anchor" href="#plotting-symmetrical-scales"><i class="fas fa-link"></i></a>
</h2>
<p>Depending on the case, it might be the case in which we want to plot a continuous variable that spans both in positive and negative values. Although not necessary, there are cases in which this binary nature of the values has a biological meaning and we, therefore, assign two gradient of colors (typically blue for negative values and red for positive values) to better visualize this nature of the data. We can achieve this by using <code>enforce_symmetry = TRUE</code>.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Geyser plot with continuous color scale.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            enforce_symmetry <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geyser plot with continuous and symmetrical color scale.</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="11-GeyserPlots_files/figure-html/unnamed-chunk-4-1.png" alt="SCpubr do_GeyserPlot plotting a symmetrical scale." width="100%" height="100%"><p class="caption">
Figure 1.3: SCpubr do_GeyserPlot plotting a symmetrical scale.
</p>
</div>
</div>
<div id="select-the-groups-displayed-on-the-x-axis" class="section level2" number="9.4">
<h2>
<span class="header-section-number">9.4</span> Select the groups displayed on the X axis<a class="anchor" aria-label="anchor" href="#select-the-groups-displayed-on-the-x-axis"><i class="fas fa-link"></i></a>
</h2>
<p>Furhtermore, we can select the groups displayed on the X axis with <code>group.by</code> parameter. It defaults to the current identities in the sample if not provided. That is also the reason why the X axis title is called “Groups”. The titles can be modified by usind <code>xlab</code> and <code>ylab</code>, respectively.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Geyser plot with categorical color scale default X axis grouping.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"categorical"</span>,</span>
<span>                            group.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            xlab <span class="op">=</span> <span class="st">"Seurat clusters"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geyser plot with categorical color scale and custom grouping.</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"categorical"</span>,</span>
<span>                            group.by <span class="op">=</span> <span class="st">"orig.ident"</span>,</span>
<span>                            xlab <span class="op">=</span> <span class="st">"Individual sample"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="11-GeyserPlots_files/figure-html/unnamed-chunk-5-1.png" alt="SCpubr do_GeyserPlot plotting different groups." width="100%" height="100%"><p class="caption">
Figure 1.4: SCpubr do_GeyserPlot plotting different groups.
</p>
</div>
</div>
<div id="split-the-plot-by-groups" class="section level2" number="9.5">
<h2>
<span class="header-section-number">9.5</span> Split the plot by groups<a class="anchor" aria-label="anchor" href="#split-the-plot-by-groups"><i class="fas fa-link"></i></a>
</h2>
<p>Apart from selecting the grouping, we can effectively split the plot by another categorical variable. This can be achieved by using <code>split.by</code>.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We only have one value in orig.ident. Let's modify it so that it resembles a multi-sample Seurat object.</span></span>
<span><span class="va">sample</span><span class="op">$</span><span class="va">modified_orig.ident</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sample_A"</span>, <span class="st">"Sample_B"</span>, <span class="st">"Sample_C"</span><span class="op">)</span>, </span>
<span>                                     size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span>, </span>
<span>                                     replace <span class="op">=</span> <span class="cn">T</span>, </span>
<span>                                     prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geyser plot with categorical color scale split by seurat clusters.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"categorical"</span>,</span>
<span>                            group.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,</span>
<span>                            split.by <span class="op">=</span> <span class="st">"seurat_clusters"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geyser plot with continuous color scale split by seurat clusters.</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            group.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,</span>
<span>                            split.by <span class="op">=</span> <span class="st">"seurat_clusters"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="11-GeyserPlots_files/figure-html/unnamed-chunk-6-1.png" alt="SCpubr do_GeyserPlot splitting by groups." width="100%" height="100%"><p class="caption">
Figure 1.5: SCpubr do_GeyserPlot splitting by groups.
</p>
</div>
</div>
<div id="rotating-x-axis-labels" class="section level2" number="9.6">
<h2>
<span class="header-section-number">9.6</span> Rotating X axis labels<a class="anchor" aria-label="anchor" href="#rotating-x-axis-labels"><i class="fas fa-link"></i></a>
</h2>
<p>As with the example above, X axis labels might overlap one with another. This can be changed by using <code>rotate_x_axis_labels = FALSE</code>,</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Geyser plot with categorical color scale split by seurat clusters rotating labels.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"categorical"</span>,</span>
<span>                            group.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,</span>
<span>                            split.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                            rotate_x_axis_labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geyser plot with continuous color scale split by seurat clusters rotating labels.</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            group.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,</span>
<span>                            split.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                            rotate_x_axis_labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-7"></span>
<img src="11-GeyserPlots_files/figure-html/unnamed-chunk-7-1.png" alt="SCpubr do_GeyserPlot rotating X axis labels." width="100%" height="100%"><p class="caption">
Figure 1.6: SCpubr do_GeyserPlot rotating X axis labels.
</p>
</div>
</div>
<div id="adding-a-third-variable" class="section level2" number="9.7">
<h2>
<span class="header-section-number">9.7</span> Adding a third variable<a class="anchor" aria-label="anchor" href="#adding-a-third-variable"><i class="fas fa-link"></i></a>
</h2>
<p>You might have noticed, that so far these plots effectively “waste” one axis: either the continuous color scale and the Y axis depict the same, or the X axis and the categorical color scale do it. For this we can add a third variable using <code>color.by</code> parameter.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Geyser plot with categorical color scale using color.by.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"categorical"</span>,</span>
<span>                            color.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geyser plot with continuous color scale using color.by.</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            color.by <span class="op">=</span> <span class="st">"nCount_RNA"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="11-GeyserPlots_files/figure-html/unnamed-chunk-8-1.png" alt="SCpubr do_GeyserPlot adding a third variable." width="100%" height="100%"><p class="caption">
Figure 1.7: SCpubr do_GeyserPlot adding a third variable.
</p>
</div>
<p>This behaviour can also be applied when using <code>split.by</code>.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Geyser plot with categorical color scale using color.by and split.by.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"categorical"</span>,</span>
<span>                            group.by <span class="op">=</span> <span class="st">"orig.ident"</span>,</span>
<span>                            split.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                            color.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geyser plot with continuous color scale using color.by and split.by.</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            color.by <span class="op">=</span> <span class="st">"nCount_RNA"</span>,</span>
<span>                            group.by <span class="op">=</span> <span class="st">"orig.ident"</span>,</span>
<span>                            split.by <span class="op">=</span> <span class="st">"seurat_clusters"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-9"></span>
<img src="11-GeyserPlots_files/figure-html/unnamed-chunk-9-1.png" alt="SCpubr do_GeyserPlot adding a third variable and using split.by." width="100%" height="100%"><p class="caption">
Figure 1.8: SCpubr do_GeyserPlot adding a third variable and using split.by.
</p>
</div>
</div>
<div id="control-the-jitter-of-the-dots" class="section level2" number="9.8">
<h2>
<span class="header-section-number">9.8</span> Control the jitter of the dots<a class="anchor" aria-label="anchor" href="#control-the-jitter-of-the-dots"><i class="fas fa-link"></i></a>
</h2>
<p>If one wants to increase or reduce the degree in which the dots disperse across the X axis, <code>jitter</code> parameter can be used, alongside a number in between 0 and 0.5.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Geyser plot with different jitter.</span></span>
<span><span class="va">p0</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            jitter <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            jitter <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            jitter <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            jitter <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            jitter <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            jitter <span class="op">=</span> <span class="fl">0.49</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p0</span> <span class="op">/</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span> <span class="op">/</span> <span class="va">p3</span> <span class="op">/</span> <span class="va">p4</span> <span class="op">/</span> <span class="va">p5</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="11-GeyserPlots_files/figure-html/unnamed-chunk-10-1.png" alt="SCpubr do_GeyserPlot controlling the jittering." width="100%" height="100%"><p class="caption">
Figure 1.9: SCpubr do_GeyserPlot controlling the jittering.
</p>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="bar-plots.html"><span class="header-section-number">8</span> Bar plots</a></div>
<div class="next"><a href="volcano-plots.html"><span class="header-section-number">10</span> Volcano plots</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><form role="search" class="mt-4 mb-4">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>
      <div class="book-extra">
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#geyser-plots"><span class="header-section-number">9</span> Geyser plots</a></li>
<li><a class="nav-link" href="#basic-usage-7"><span class="header-section-number">9.1</span> Basic usage</a></li>
<li><a class="nav-link" href="#ordering-by-mean-values"><span class="header-section-number">9.2</span> Ordering by mean values</a></li>
<li><a class="nav-link" href="#plotting-symmetrical-scales"><span class="header-section-number">9.3</span> Plotting symmetrical scales</a></li>
<li><a class="nav-link" href="#select-the-groups-displayed-on-the-x-axis"><span class="header-section-number">9.4</span> Select the groups displayed on the X axis</a></li>
<li><a class="nav-link" href="#split-the-plot-by-groups"><span class="header-section-number">9.5</span> Split the plot by groups</a></li>
<li><a class="nav-link" href="#rotating-x-axis-labels"><span class="header-section-number">9.6</span> Rotating X axis labels</a></li>
<li><a class="nav-link" href="#adding-a-third-variable"><span class="header-section-number">9.7</span> Adding a third variable</a></li>
<li><a class="nav-link" href="#control-the-jitter-of-the-dots"><span class="header-section-number">9.8</span> Control the jitter of the dots</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<!-- Modified page for chapter. --><li><a id="book-source" href="https://github.com/enblacar/SCpubr-book/blob/main/11-GeyserPlots.Rmd">View chapter source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/enblacar/SCpubr-book/edit/main/11-GeyserPlots.Rmd">Edit this chapter <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    
  </div>

</nav>
</div>
</div> <!-- .container -->




</div>
</body>
<!-- Moved the footer outside of the body to make it span all page width. --><footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p class="text-center">Written by <strong>Enrique Blanco Carmona</strong> on 04 October, 2022.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p class="text-center">This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</html>
