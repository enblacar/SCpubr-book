<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>9 Geyser plots | SCpubr</title>
<meta name="author" content="Enrique Blanco Carmona">
<meta name="description" content="Geyser plots are a kind of scatter plots characterized by plotting a continuous variable on the Y axis and splitting the dots by a categorical variable on the X axis. This normally results in the...">
<meta name="generator" content="bookdown 0.28 with bs4_book()">
<meta property="og:title" content="9 Geyser plots | SCpubr">
<meta property="og:type" content="book">
<meta property="og:url" content="https://enblacar.github.io/SCpubr-book/geyser-plots.html">
<meta property="og:image" content="https://enblacar.github.io/SCpubr-book/images/logo.png">
<meta property="og:description" content="Geyser plots are a kind of scatter plots characterized by plotting a continuous variable on the Y axis and splitting the dots by a categorical variable on the X axis. This normally results in the...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="9 Geyser plots | SCpubr">
<meta name="twitter:description" content="Geyser plots are a kind of scatter plots characterized by plotting a continuous variable on the Y axis and splitting the dots by a categorical variable on the X axis. This normally results in the...">
<meta name="twitter:image" content="https://enblacar.github.io/SCpubr-book/images/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link rel="shortcut icon" href="images/SCpubr_logo_favicon.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a id="toc_title" href="index.html" title="">SCpubr</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <div class="book-extra"></div>
      <nav id="left-panel" aria-label="Table of contents"><ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About this package</a></li>
<li><a class="" href="installation-guide.html">Installation guide</a></li>
<li><a class="" href="dataset-used.html">Dataset used</a></li>
<li><a class="" href="dim-plots.html"><span class="header-section-number">1</span> Dim plots</a></li>
<li><a class="" href="feature-plots.html"><span class="header-section-number">2</span> Feature plots</a></li>
<li><a class="" href="nebulosa-plots.html"><span class="header-section-number">3</span> Nebulosa plots</a></li>
<li><a class="" href="bee-swarm-plots.html"><span class="header-section-number">4</span> Bee Swarm plots</a></li>
<li><a class="" href="violin-plots.html"><span class="header-section-number">5</span> Violin plots</a></li>
<li><a class="" href="ridge-plots.html"><span class="header-section-number">6</span> Ridge plots</a></li>
<li><a class="" href="dot-plots.html"><span class="header-section-number">7</span> Dot plots</a></li>
<li><a class="" href="bar-plots.html"><span class="header-section-number">8</span> Bar plots</a></li>
<li><a class="active" href="geyser-plots.html"><span class="header-section-number">9</span> Geyser plots</a></li>
<li><a class="" href="group-wise-de-analysis-plots.html"><span class="header-section-number">10</span> Group-wise DE analysis plots</a></li>
<li><a class="" href="term-enrichment-plots.html"><span class="header-section-number">11</span> Term Enrichment Plots</a></li>
<li><a class="" href="enrichment-score-heatmaps.html"><span class="header-section-number">12</span> Enrichment score heatmaps</a></li>
<li><a class="" href="correlation-matrix-heatmaps.html"><span class="header-section-number">13</span> Correlation matrix heatmaps</a></li>
<li><a class="" href="cellular-state-plots.html"><span class="header-section-number">14</span> Cellular State Plots</a></li>
<li><a class="" href="ligand-receptor-analysis.html"><span class="header-section-number">15</span> Ligand-Receptor analysis</a></li>
<li><a class="" href="copy-number-variant-analysis-plots.html"><span class="header-section-number">16</span> Copy Number Variant analysis plots</a></li>
<li><a class="" href="pathway-activity-inference-analysis.html"><span class="header-section-number">17</span> Pathway Activity inference analysis</a></li>
<li><a class="" href="tf-activity-inference-analysis.html"><span class="header-section-number">18</span> TF Activity inference analysis</a></li>
<li><a class="" href="pseudotime-analysis.html"><span class="header-section-number">19</span> Pseudotime analysis</a></li>
<li><a class="" href="color-palettes.html"><span class="header-section-number">20</span> Color palettes</a></li>
<li><a class="" href="common-features-across-plots.html">Common features across plots</a></li>
<li><a class="" href="rasterized-figures.html">Rasterized figures</a></li>
<li><a class="" href="save-the-figures.html">Save the figures</a></li>
<li><a class="" href="troubleshooting.html">Troubleshooting</a></li>
<li><a class="" href="citation.html">Citation</a></li>
</ul>

        <div class="book-extra">
          <!-- Duplicated this entry to point to the package repo. -->
          <p class="mb-2"><a id="package-repo" href="https://github.com/enblacar/SCpubr">View package source <i class="fab fa-github"></i></a></p>
          <p><a id="book-repo" href="https://github.com/enblacar/SCpubr-book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="geyser-plots" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Geyser plots<a class="anchor" aria-label="anchor" href="#geyser-plots"><i class="fas fa-link"></i></a>
</h1>
<p>Geyser plots are a kind of scatter plots characterized by plotting a continuous variable on the Y axis and splitting the dots by a categorical variable on the X axis. This normally results in the dots collapsing on a single line along the Y axis, but with jittering they can spread out, depicting a shape that resemble that of a Geyser. Furthermore, to better understand the distribution of data along the Y axis, distribution intervals are plotted on top of the Geyser plots. The dot depitcs the median of the data, while the end of the thick and thin lines represent 66% and 95% of the data in the group, respectively.</p>
<p>These plots are just an alternate way of representing what can be achieved with a violin plot. However, this version allows for a more aesthetic view while also allowing the user to further plot another extra variable on the dots, coloring with a continuous or a categorical scale.</p>
<div id="basic-usage-7" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage-7"><i class="fas fa-link"></i></a>
</h2>
<p>The most basic version of this plot uses only the X and Y variables, while the color of the cells is assigned to either of the two. We can achieve this by using <code><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">SCpubr::do_GeyserPlot()</a></code> and stating the kind of color scale we want with <code>scale_type</code> (either continuous or categorical).</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Geyser plot with categorical color scale.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"nCount_RNA"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"categorical"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geyser plot with continuous color scale.</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"nCount_RNA"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="11-GeyserPlots_files/figure-html/unnamed-chunk-2-1.png" alt="SCpubr do_GeyserPlot regular use." width="100%" height="100%"><p class="caption">
Figure 1.1: SCpubr do_GeyserPlot regular use.
</p>
</div>
</div>
<div id="ordering-by-mean-values" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Ordering by mean values<a class="anchor" aria-label="anchor" href="#ordering-by-mean-values"><i class="fas fa-link"></i></a>
</h2>
<p>First thing that one notice, is that the geysers are ordered from highest to lowest mean values. This can be nullified by using <code>order_by_mean = FALSE</code>. In this case, the geysers will order based on alphabetical order or on the levels if the variable chosen is a factor.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Geyser plot with categorical color scale without ordering by mean.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"nCount_RNA"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"categorical"</span>,</span>
<span>                            order_by_mean <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geyser plot with continuous color scale without ordering by mean.</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"nCount_RNA"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            order_by_mean <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="11-GeyserPlots_files/figure-html/unnamed-chunk-3-1.png" alt="SCpubr do_GeyserPlot without ordering by the mean." width="100%" height="100%"><p class="caption">
Figure 1.2: SCpubr do_GeyserPlot without ordering by the mean.
</p>
</div>
</div>
<div id="plotting-symmetrical-scales" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> Plotting symmetrical scales<a class="anchor" aria-label="anchor" href="#plotting-symmetrical-scales"><i class="fas fa-link"></i></a>
</h2>
<p>Depending on the case, it might be the case in which we want to plot a continuous variable that spans both in positive and negative values. Although not necessary, there are cases in which this binary nature of the values has a biological meaning and we, therefore, assign two gradient of colors (typically blue for negative values and red for positive values) to better visualize this nature of the data. We can achieve this by using <code>enforce_symmetry = TRUE</code>.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Geyser plot with continuous color scale.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            enforce_symmetry <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geyser plot with continuous and symmetrical color scale.</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="11-GeyserPlots_files/figure-html/unnamed-chunk-4-1.png" alt="SCpubr do_GeyserPlot plotting a symmetrical scale." width="100%" height="100%"><p class="caption">
Figure 1.3: SCpubr do_GeyserPlot plotting a symmetrical scale.
</p>
</div>
</div>
<div id="select-the-groups-displayed-on-the-x-axis" class="section level2" number="9.4">
<h2>
<span class="header-section-number">9.4</span> Select the groups displayed on the X axis<a class="anchor" aria-label="anchor" href="#select-the-groups-displayed-on-the-x-axis"><i class="fas fa-link"></i></a>
</h2>
<p>Furhtermore, we can select the groups displayed on the X axis with <code>group.by</code> parameter. It defaults to the current identities in the sample if not provided. That is also the reason why the X axis title is called “Groups”. The titles can be modified by usind <code>xlab</code> and <code>ylab</code>, respectively.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Geyser plot with categorical color scale default X axis grouping.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"categorical"</span>,</span>
<span>                            group.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                            xlab <span class="op">=</span> <span class="st">"Seurat clusters"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geyser plot with categorical color scale and custom grouping.</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"categorical"</span>,</span>
<span>                            group.by <span class="op">=</span> <span class="st">"orig.ident"</span>,</span>
<span>                            xlab <span class="op">=</span> <span class="st">"Individual sample"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="11-GeyserPlots_files/figure-html/unnamed-chunk-5-1.png" alt="SCpubr do_GeyserPlot plotting different groups." width="100%" height="100%"><p class="caption">
Figure 1.4: SCpubr do_GeyserPlot plotting different groups.
</p>
</div>
</div>
<div id="split-the-plot-by-groups" class="section level2" number="9.5">
<h2>
<span class="header-section-number">9.5</span> Split the plot by groups<a class="anchor" aria-label="anchor" href="#split-the-plot-by-groups"><i class="fas fa-link"></i></a>
</h2>
<p>Apart from selecting the grouping, we can effectively split the plot by another categorical variable. This can be achieved by using <code>split.by</code>.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We only have one value in orig.ident. Let's modify it so that it resembles a multi-sample Seurat object.</span></span>
<span><span class="va">sample</span><span class="op">$</span><span class="va">modified_orig.ident</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sample_A"</span>, <span class="st">"Sample_B"</span>, <span class="st">"Sample_C"</span><span class="op">)</span>, </span>
<span>                                     size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span>, </span>
<span>                                     replace <span class="op">=</span> <span class="cn">T</span>, </span>
<span>                                     prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geyser plot with categorical color scale split by seurat clusters.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"categorical"</span>,</span>
<span>                            group.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,</span>
<span>                            split.by <span class="op">=</span> <span class="st">"seurat_clusters"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geyser plot with continuous color scale split by seurat clusters.</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            group.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,</span>
<span>                            split.by <span class="op">=</span> <span class="st">"seurat_clusters"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="11-GeyserPlots_files/figure-html/unnamed-chunk-6-1.png" alt="SCpubr do_GeyserPlot splitting by groups." width="100%" height="100%"><p class="caption">
Figure 1.5: SCpubr do_GeyserPlot splitting by groups.
</p>
</div>
</div>
<div id="rotating-x-axis-labels" class="section level2" number="9.6">
<h2>
<span class="header-section-number">9.6</span> Rotating X axis labels<a class="anchor" aria-label="anchor" href="#rotating-x-axis-labels"><i class="fas fa-link"></i></a>
</h2>
<p>As with the example above, X axis labels might overlap one with another. This can be changed by using <code>rotate_x_axis_labels = FALSE</code>,</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Geyser plot with categorical color scale split by seurat clusters rotating labels.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"categorical"</span>,</span>
<span>                            group.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,</span>
<span>                            split.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                            rotate_x_axis_labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geyser plot with continuous color scale split by seurat clusters rotating labels.</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            group.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span>,</span>
<span>                            split.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                            rotate_x_axis_labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-7"></span>
<img src="11-GeyserPlots_files/figure-html/unnamed-chunk-7-1.png" alt="SCpubr do_GeyserPlot rotating X axis labels." width="100%" height="100%"><p class="caption">
Figure 1.6: SCpubr do_GeyserPlot rotating X axis labels.
</p>
</div>
</div>
<div id="adding-a-third-variable" class="section level2" number="9.7">
<h2>
<span class="header-section-number">9.7</span> Adding a third variable<a class="anchor" aria-label="anchor" href="#adding-a-third-variable"><i class="fas fa-link"></i></a>
</h2>
<p>You might have noticed, that so far these plots effectively “waste” one axis: either the continuous color scale and the Y axis depict the same, or the X axis and the categorical color scale do it. For this we can add a third variable using <code>color.by</code> parameter.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Geyser plot with categorical color scale using color.by.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"categorical"</span>,</span>
<span>                            color.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geyser plot with continuous color scale using color.by.</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            color.by <span class="op">=</span> <span class="st">"nCount_RNA"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="11-GeyserPlots_files/figure-html/unnamed-chunk-8-1.png" alt="SCpubr do_GeyserPlot adding a third variable." width="100%" height="100%"><p class="caption">
Figure 1.7: SCpubr do_GeyserPlot adding a third variable.
</p>
</div>
<p>This behaviour can also be applied when using <code>split.by</code>.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Geyser plot with categorical color scale using color.by and split.by.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"categorical"</span>,</span>
<span>                            group.by <span class="op">=</span> <span class="st">"orig.ident"</span>,</span>
<span>                            split.by <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                            color.by <span class="op">=</span> <span class="st">"modified_orig.ident"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Geyser plot with continuous color scale using color.by and split.by.</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_GeyserPlot.html">do_GeyserPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                            features <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                            scale_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                            enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            color.by <span class="op">=</span> <span class="st">"nCount_RNA"</span>,</span>
<span>                            group.by <span class="op">=</span> <span class="st">"orig.ident"</span>,</span>
<span>                            split.by <span class="op">=</span> <span class="st">"seurat_clusters"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-9"></span>
<img src="11-GeyserPlots_files/figure-html/unnamed-chunk-9-1.png" alt="SCpubr do_GeyserPlot adding a third variable and using split.by." width="100%" height="100%"><p class="caption">
Figure 1.8: SCpubr do_GeyserPlot adding a third variable and using split.by.
</p>
</div>
</div>
<div id="control-the-jitter-of-the-dots" class="section level2" number="9.8">
<h2>
<span class="header-section-number">9.8</span> Control the jitter of the dots<a class="anchor" aria-label="anchor" href="#control-the-jitter-of-the-dots"><i class="fas fa-link"></i></a>
</h2>
<p>If one wants to increase or reduce the degree in which the dots disperse across the X axis, <code>jitter</code> parameter can be used, alongside a number in between ]0 - 0.5[. ] &lt;- “C”
sample<span class="math inline">\(assignment[sample\)</span>seurat_clusters %in% c(“10”, “5”)] &lt;- “D”
sample<span class="math inline">\(assignment[sample\)</span>seurat_clusters %in% c(“8”, “9”)] &lt;- “E”</p>
<p>p &lt;- SCpubr::do_ChordDiagramPlot(sample = sample,
from = “seurat_clusters”,
to = “assignment”)</p>
<p>p</p>
<pre><code> &lt;span class="border-0"&gt;&lt;img src="images/example_chord1.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"/&gt; &lt;p class="caption"&gt;Basic Chord Diagram.&lt;/p&gt;&lt;/span&gt;

## Control the gaps between and within groups
We can modify the gaps between `from` and `to`, provided that there are not so many elements that this can not be accomplished. For this, we use `big_gap`:

```r
p &lt;- SCpubr::do_ChordDiagramPlot(sample = sample,
                                 from = "seurat_clusters",
                                 to = "assignment",
                                 big.gap = 40)

p</code></pre>
<span class="border-0"><img src="images/example_chord2.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"><p class="caption">
Chord Diagram with increased big gap.
</p>
<p></p></span>
<p>Similarly, we can also modify the gaps between the groups inside <code>from</code> and <code>to</code> with <code>small_gap</code>:</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_ChordDiagramPlot.html">do_ChordDiagramPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                 from <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                                 to <span class="op">=</span> <span class="st">"assignment"</span>,</span>
<span>                                 small.gap <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<span class="border-0"><img src="images/example_chord3.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"><p class="caption">
Chord Diagram with increased small gap.
</p>
<p></p></span>
</div>
<div id="control-the-alignment-of-the-diagram" class="section level2" number="9.9">
<h2>
<span class="header-section-number">9.9</span> Control the alignment of the diagram<a class="anchor" aria-label="anchor" href="#control-the-alignment-of-the-diagram"><i class="fas fa-link"></i></a>
</h2>
<p>We can force the alignment of the starting poing of the Chord diagram using the <code>alignment</code> parameter:</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_ChordDiagramPlot.html">do_ChordDiagramPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                 from <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                                 to <span class="op">=</span> <span class="st">"assignment"</span>,</span>
<span>                                 alignment <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/save_Plot.html">save_Plot</a></span><span class="op">(</span><span class="va">p</span>, figure_path <span class="op">=</span> <span class="st">"./images/"</span>, file_name <span class="op">=</span> <span class="st">"example_chord4"</span>, output_format <span class="op">=</span> <span class="st">"png"</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<span class="border-0"><img src="images/example_chord4.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"><p class="caption">
Chord Diagram starting horizontally.
</p>
<p></p></span>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_ChordDiagramPlot.html">do_ChordDiagramPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                 from <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                                 to <span class="op">=</span> <span class="st">"assignment"</span>,</span>
<span>                                 alignment <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/save_Plot.html">save_Plot</a></span><span class="op">(</span><span class="va">p</span>, figure_path <span class="op">=</span> <span class="st">"./images/"</span>, file_name <span class="op">=</span> <span class="st">"example_chord5"</span>, output_format <span class="op">=</span> <span class="st">"png"</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<span class="border-0"><img src="images/example_chord5.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"><p class="caption">
Chord Diagram starting vertically.
</p>
<p></p></span>
</div>
<div id="control-the-directions-of-the-links" class="section level2" number="9.10">
<h2>
<span class="header-section-number">9.10</span> Control the directions of the links<a class="anchor" aria-label="anchor" href="#control-the-directions-of-the-links"><i class="fas fa-link"></i></a>
</h2>
<p>Also, we can define the direction of the interaction by providing different values to <code>directional</code>:
- 0: The links have no direction.
- 1: The links go from <code>from</code> to <code>to</code>.
- -1: The links go from <code>to</code> to <code>from</code>.
- 2: The links are bidrectional.</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We need to set direction.type to diffHeight only as arrows are, by nature, directional.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_ChordDiagramPlot.html">do_ChordDiagramPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                 from <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                                 to <span class="op">=</span> <span class="st">"assignment"</span>,</span>
<span>                                 directional <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                 direction.type <span class="op">=</span> <span class="st">"diffHeight"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/save_Plot.html">save_Plot</a></span><span class="op">(</span><span class="va">p</span>, figure_path <span class="op">=</span> <span class="st">"./images/"</span>, file_name <span class="op">=</span> <span class="st">"example_chord6"</span>, output_format <span class="op">=</span> <span class="st">"png"</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<span class="border-0"><img src="images/example_chord6.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"><p class="caption">
Chord Diagram with links without any direction.
</p>
<p></p></span>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_ChordDiagramPlot.html">do_ChordDiagramPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                 from <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                                 to <span class="op">=</span> <span class="st">"assignment"</span>,</span>
<span>                                 directional <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/save_Plot.html">save_Plot</a></span><span class="op">(</span><span class="va">p</span>, figure_path <span class="op">=</span> <span class="st">"./images/"</span>, file_name <span class="op">=</span> <span class="st">"example_chord7"</span>, output_format <span class="op">=</span> <span class="st">"png"</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<span class="border-0"><img src="images/example_chord7.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"><p class="caption">
Chord Diagram with links going from “from” to “to”.
</p>
<p></p></span>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_ChordDiagramPlot.html">do_ChordDiagramPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                 from <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                                 to <span class="op">=</span> <span class="st">"assignment"</span>,</span>
<span>                                 directional <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/save_Plot.html">save_Plot</a></span><span class="op">(</span><span class="va">p</span>, figure_path <span class="op">=</span> <span class="st">"./images/"</span>, file_name <span class="op">=</span> <span class="st">"example_chord8"</span>, output_format <span class="op">=</span> <span class="st">"png"</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<span class="border-0"><img src="images/example_chord8.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"><p class="caption">
Chord Diagram with links going from “to” to “from”.
</p>
<p></p></span>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We need to set direction.type to diffHeight only as arrows are, by nature, directional.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_ChordDiagramPlot.html">do_ChordDiagramPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                 from <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                                 to <span class="op">=</span> <span class="st">"assignment"</span>,</span>
<span>                                 directional <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                 direction.type <span class="op">=</span> <span class="st">"diffHeight"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/save_Plot.html">save_Plot</a></span><span class="op">(</span><span class="va">p</span>, figure_path <span class="op">=</span> <span class="st">"./images/"</span>, file_name <span class="op">=</span> <span class="st">"example_chord9"</span>, output_format <span class="op">=</span> <span class="st">"png"</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<span class="border-0"><img src="images/example_chord9.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"><p class="caption">
Chord Diagram with links going in both directions.
</p>
<p></p></span>
</div>
<div id="add-padding-to-the-labels" class="section level2" number="9.11">
<h2>
<span class="header-section-number">9.11</span> Add padding to the labels<a class="anchor" aria-label="anchor" href="#add-padding-to-the-labels"><i class="fas fa-link"></i></a>
</h2>
<p>One can add more padding to the labels by using <code>padding_labels</code>. The number provided is the amount of whitespaces padding the label.</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add more padding to the labels.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_ChordDiagramPlot.html">do_ChordDiagramPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                 from <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                                 to <span class="op">=</span> <span class="st">"assignment"</span>,</span>
<span>                                 padding_labels <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/save_Plot.html">save_Plot</a></span><span class="op">(</span><span class="va">p</span>, figure_path <span class="op">=</span> <span class="st">"./images/"</span>, file_name <span class="op">=</span> <span class="st">"example_chord10"</span>, output_format <span class="op">=</span> <span class="st">"png"</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<span class="border-0"><img src="images/example_chord10.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"><p class="caption">
Chord Diagram with extra padding.
</p>
<p></p></span>
</div>
<div id="scale-the-nodes" class="section level2" number="9.12">
<h2>
<span class="header-section-number">9.12</span> Scale the nodes<a class="anchor" aria-label="anchor" href="#scale-the-nodes"><i class="fas fa-link"></i></a>
</h2>
<p>If we want to show the nodes with equal size, links reflecting a proportion instead, we can set <code>scale = TRUE</code>.</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Scale the size of the nodes.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_ChordDiagramPlot.html">do_ChordDiagramPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                 from <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                                 to <span class="op">=</span> <span class="st">"assignment"</span>,</span>
<span>                                 scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                 padding_labels <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/save_Plot.html">save_Plot</a></span><span class="op">(</span><span class="va">p</span>, figure_path <span class="op">=</span> <span class="st">"./images/"</span>, file_name <span class="op">=</span> <span class="st">"example_chord11"</span>, output_format <span class="op">=</span> <span class="st">"png"</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<span class="border-0"><img src="images/example_chord11.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"><p class="caption">
Chord Diagram with scaled nodes.
</p>
<p></p></span>
</div>
<div id="self-linking" class="section level2" number="9.13">
<h2>
<span class="header-section-number">9.13</span> Self linking<a class="anchor" aria-label="anchor" href="#self-linking"><i class="fas fa-link"></i></a>
</h2>
<p>We can also control whether we want to allow self linking between the nodes or not. For this, we can set <code>self.link = 2</code> to allow them or <code>self.link = 1</code> to prevent them.</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prevent self linking.</span></span>
<span><span class="va">sample</span><span class="op">$</span><span class="va">seurat_clusters2</span> <span class="op">&lt;-</span> <span class="va">sample</span><span class="op">$</span><span class="va">seurat_clusters</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_ChordDiagramPlot.html">do_ChordDiagramPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                 from <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                                 to <span class="op">=</span> <span class="st">"seurat_clusters2"</span>,</span>
<span>                                 self.link <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                 scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/save_Plot.html">save_Plot</a></span><span class="op">(</span><span class="va">p</span>, figure_path <span class="op">=</span> <span class="st">"./images/"</span>, file_name <span class="op">=</span> <span class="st">"example_chord12"</span>, output_format <span class="op">=</span> <span class="st">"png"</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<span class="border-0"><img src="images/example_chord12.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"><p class="caption">
Chord Diagram with prevented self linking.
</p>
<p></p></span>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Allow self linking.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_ChordDiagramPlot.html">do_ChordDiagramPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                 from <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                                 to <span class="op">=</span> <span class="st">"seurat_clusters2"</span>,</span>
<span>                                 self.link <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                 scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/save_Plot.html">save_Plot</a></span><span class="op">(</span><span class="va">p</span>, figure_path <span class="op">=</span> <span class="st">"./images/"</span>, file_name <span class="op">=</span> <span class="st">"example_chord13"</span>, output_format <span class="op">=</span> <span class="st">"png"</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<span class="border-0"><img src="images/example_chord13.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"><p class="caption">
Chord Diagram with allowed self linking.
</p>
<p></p></span>
</div>
<div id="control-the-appearance-of-the-arrows" class="section level2" number="9.14">
<h2>
<span class="header-section-number">9.14</span> Control the appearance of the arrows<a class="anchor" aria-label="anchor" href="#control-the-appearance-of-the-arrows"><i class="fas fa-link"></i></a>
</h2>
<p>The arrows can be modified by using <code>link.arr.type</code> parameter:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set triangle arrows.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_ChordDiagramPlot.html">do_ChordDiagramPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                 from <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                                 to <span class="op">=</span> <span class="st">"assignment"</span>,</span>
<span>                                 link.arr.type <span class="op">=</span> <span class="st">"triangle"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/save_Plot.html">save_Plot</a></span><span class="op">(</span><span class="va">p</span>, figure_path <span class="op">=</span> <span class="st">"./images/"</span>, file_name <span class="op">=</span> <span class="st">"example_chord14"</span>, output_format <span class="op">=</span> <span class="st">"png"</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<span class="border-0"><img src="images/example_chord14.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"><p class="caption">
Chord Diagram with triangle arrows.
</p>
<p></p></span>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set big arrows.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_ChordDiagramPlot.html">do_ChordDiagramPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                 from <span class="op">=</span> <span class="st">"seurat_clusters"</span>,</span>
<span>                                 to <span class="op">=</span> <span class="st">"assignment"</span>,</span>
<span>                                 link.arr.type <span class="op">=</span> <span class="st">"big.arrow"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/save_Plot.html">save_Plot</a></span><span class="op">(</span><span class="va">p</span>, figure_path <span class="op">=</span> <span class="st">"./images/"</span>, file_name <span class="op">=</span> <span class="st">"example_chord15"</span>, output_format <span class="op">=</span> <span class="st">"png"</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<span class="border-0"><img src="images/example_chord15.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"><p class="caption">
Chord Diagram with big arrows.
</p>
<p></p></span>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="bar-plots.html"><span class="header-section-number">8</span> Bar plots</a></div>
<div class="next"><a href="group-wise-de-analysis-plots.html"><span class="header-section-number">10</span> Group-wise DE analysis plots</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><form role="search" class="mt-4 mb-4">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>
      <div class="book-extra">
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#geyser-plots"><span class="header-section-number">9</span> Geyser plots</a></li>
<li><a class="nav-link" href="#basic-usage-7"><span class="header-section-number">9.1</span> Basic usage</a></li>
<li><a class="nav-link" href="#ordering-by-mean-values"><span class="header-section-number">9.2</span> Ordering by mean values</a></li>
<li><a class="nav-link" href="#plotting-symmetrical-scales"><span class="header-section-number">9.3</span> Plotting symmetrical scales</a></li>
<li><a class="nav-link" href="#select-the-groups-displayed-on-the-x-axis"><span class="header-section-number">9.4</span> Select the groups displayed on the X axis</a></li>
<li><a class="nav-link" href="#split-the-plot-by-groups"><span class="header-section-number">9.5</span> Split the plot by groups</a></li>
<li><a class="nav-link" href="#rotating-x-axis-labels"><span class="header-section-number">9.6</span> Rotating X axis labels</a></li>
<li><a class="nav-link" href="#adding-a-third-variable"><span class="header-section-number">9.7</span> Adding a third variable</a></li>
<li><a class="nav-link" href="#control-the-jitter-of-the-dots"><span class="header-section-number">9.8</span> Control the jitter of the dots</a></li>
<li><a class="nav-link" href="#control-the-alignment-of-the-diagram"><span class="header-section-number">9.9</span> Control the alignment of the diagram</a></li>
<li><a class="nav-link" href="#control-the-directions-of-the-links"><span class="header-section-number">9.10</span> Control the directions of the links</a></li>
<li><a class="nav-link" href="#add-padding-to-the-labels"><span class="header-section-number">9.11</span> Add padding to the labels</a></li>
<li><a class="nav-link" href="#scale-the-nodes"><span class="header-section-number">9.12</span> Scale the nodes</a></li>
<li><a class="nav-link" href="#self-linking"><span class="header-section-number">9.13</span> Self linking</a></li>
<li><a class="nav-link" href="#control-the-appearance-of-the-arrows"><span class="header-section-number">9.14</span> Control the appearance of the arrows</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<!-- Modified page for chapter. --><li><a id="book-source" href="https://github.com/enblacar/SCpubr-book/blob/main/14-ChordDiagramPlots.Rmd">View chapter source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/enblacar/SCpubr-book/edit/main/14-ChordDiagramPlots.Rmd">Edit this chapter <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    
  </div>

</nav>
</div>
</div> <!-- .container -->




<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</div>
</body>
<!-- Moved the footer outside of the body to make it span all page width. --><footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p class="text-center">Written by <strong>Enrique Blanco Carmona</strong> on 01 October, 2022.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p class="text-center">This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</html>
