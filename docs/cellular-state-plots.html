<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>18 Cellular State Plots | SCpubr</title>
<meta name="author" content="Enrique Blanco Carmona">
<meta name="description" content="These plots are, on their bare basis, scatter plots. As of today, I am not completely sure if this is the correct name for the plot, but I will follow the name provided to such plot in Neftel, et...">
<meta name="generator" content="bookdown 0.28 with bs4_book()">
<meta property="og:title" content="18 Cellular State Plots | SCpubr">
<meta property="og:type" content="book">
<meta property="og:url" content="https://enblacar.github.io/SCpubr-book/cellular-state-plots.html">
<meta property="og:image" content="https://enblacar.github.io/SCpubr-book/images/logo.png">
<meta property="og:description" content="These plots are, on their bare basis, scatter plots. As of today, I am not completely sure if this is the correct name for the plot, but I will follow the name provided to such plot in Neftel, et...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="18 Cellular State Plots | SCpubr">
<meta name="twitter:description" content="These plots are, on their bare basis, scatter plots. As of today, I am not completely sure if this is the correct name for the plot, but I will follow the name provided to such plot in Neftel, et...">
<meta name="twitter:image" content="https://enblacar.github.io/SCpubr-book/images/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link rel="shortcut icon" href="images/SCpubr_logo_favicon.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a id="toc_title" href="index.html" title="">SCpubr</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <div class="book-extra"></div>
      <nav id="left-panel" aria-label="Table of contents"><ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About this package</a></li>
<li><a class="" href="installation-guide.html">Installation guide</a></li>
<li><a class="" href="dataset-used.html">Dataset used</a></li>
<li><a class="" href="dim-plots.html"><span class="header-section-number">1</span> Dim plots</a></li>
<li><a class="" href="feature-plots.html"><span class="header-section-number">2</span> Feature plots</a></li>
<li><a class="" href="nebulosa-plots.html"><span class="header-section-number">3</span> Nebulosa plots</a></li>
<li><a class="" href="bee-swarm-plots.html"><span class="header-section-number">4</span> Bee Swarm plots</a></li>
<li><a class="" href="violin-plots.html"><span class="header-section-number">5</span> Violin plots</a></li>
<li><a class="" href="ridge-plots.html"><span class="header-section-number">6</span> Ridge plots</a></li>
<li><a class="" href="dot-plots.html"><span class="header-section-number">7</span> Dot plots</a></li>
<li><a class="" href="bar-plots.html"><span class="header-section-number">8</span> Bar plots</a></li>
<li><a class="" href="box-plots.html"><span class="header-section-number">9</span> Box plots</a></li>
<li><a class="" href="geyser-plots.html"><span class="header-section-number">10</span> Geyser plots</a></li>
<li><a class="" href="sankey-and-alluvial-plots.html"><span class="header-section-number">11</span> Sankey and alluvial plots</a></li>
<li><a class="" href="chord-diagram-plots.html"><span class="header-section-number">12</span> Chord Diagram plots</a></li>
<li><a class="" href="volcano-plots.html"><span class="header-section-number">13</span> Volcano plots</a></li>
<li><a class="" href="group-wise-de-analysis-plots.html"><span class="header-section-number">14</span> Group-wise DE analysis plots</a></li>
<li><a class="" href="term-enrichment-plots.html"><span class="header-section-number">15</span> Term Enrichment Plots</a></li>
<li><a class="" href="enrichment-score-heatmaps.html"><span class="header-section-number">16</span> Enrichment score heatmaps</a></li>
<li><a class="" href="correlation-matrix-heatmaps.html"><span class="header-section-number">17</span> Correlation matrix heatmaps</a></li>
<li><a class="active" href="cellular-state-plots.html"><span class="header-section-number">18</span> Cellular State Plots</a></li>
<li><a class="" href="ligand-receptor-analysis.html"><span class="header-section-number">19</span> Ligand-Receptor analysis</a></li>
<li><a class="" href="copy-number-variant-analysis-plots.html"><span class="header-section-number">20</span> Copy Number Variant analysis plots</a></li>
<li><a class="" href="pathway-activity-inference-analysis.html"><span class="header-section-number">21</span> Pathway Activity inference analysis</a></li>
<li><a class="" href="tf-activity-inference-analysis.html"><span class="header-section-number">22</span> TF Activity inference analysis</a></li>
<li><a class="" href="pseudotime-analysis.html"><span class="header-section-number">23</span> Pseudotime analysis</a></li>
<li><a class="" href="color-palettes.html"><span class="header-section-number">24</span> Color palettes</a></li>
<li><a class="" href="common-features-across-plots.html">Common features across plots</a></li>
<li><a class="" href="rasterized-figures.html">Rasterized figures</a></li>
<li><a class="" href="save-the-figures.html">Save the figures</a></li>
<li><a class="" href="troubleshooting.html">Troubleshooting</a></li>
<li><a class="" href="citation.html">Citation</a></li>
</ul>

        <div class="book-extra">
          <!-- Duplicated this entry to point to the package repo. -->
          <p class="mb-2"><a id="package-repo" href="https://github.com/enblacar/SCpubr">View package source <i class="fab fa-github"></i></a></p>
          <p><a id="book-repo" href="https://github.com/enblacar/SCpubr-book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="cellular-state-plots" class="section level1" number="18">
<h1>
<span class="header-section-number">18</span> Cellular State Plots<a class="anchor" aria-label="anchor" href="#cellular-state-plots"><i class="fas fa-link"></i></a>
</h1>
<p>These plots are, on their bare basis, scatter plots. As of today, I am not completely sure if this is the correct name for the plot, but I will follow the name provided to such plot in <a href="https://pubmed.ncbi.nlm.nih.gov/31327527/">Neftel, et al, 2019</a>. The core concept of the function computing these plots, <code><a href="https://rdrr.io/pkg/SCpubr/man/do_CellularStatesPlot.html">SCpubr::do_CellularStatesPlot()</a></code> is that you only need a Seurat object and a <em>named list of gene signatures</em>. With this, the function will compute enrichment scores using <code><a href="https://satijalab.org/seurat/reference/AddModuleScore.html">Seurat::AddModuleScore()</a></code> and store them as metadata in the object, that will be use for the plotting later on. That is why, alongside the list of gene signatures, the user needs to provide the names of the lists to be plotted as arguments.</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/VariableFeatures.html">VariableFeatures</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>,</span>
<span>                 <span class="st">"B"</span> <span class="op">=</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/VariableFeatures.html">VariableFeatures</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span>
<span>                 <span class="st">"C"</span> <span class="op">=</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/VariableFeatures.html">VariableFeatures</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span><span class="op">[</span><span class="fl">21</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span>,</span>
<span>                 <span class="st">"D"</span> <span class="op">=</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/VariableFeatures.html">VariableFeatures</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span><span class="op">[</span><span class="fl">31</span><span class="op">:</span><span class="fl">40</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div id="variable-plots" class="section level2" number="18.1">
<h2>
<span class="header-section-number">18.1</span> 2 variable plots<a class="anchor" aria-label="anchor" href="#variable-plots"><i class="fas fa-link"></i></a>
</h2>
<p><span class="border-0"><img src="images/2_variables.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"></span></p>
<p>This is the easiest case. For this, the user needs to provide the name of <em>two gene signatures</em> present in the list of genes provided to <code>input_gene_list</code> parameter:
- <code>x1</code>: The enrichment scores computed for this list will be displayed on the X axis.
- <code>y1</code>: The enrichment scores computed for this list will be displayed on the Y axis.</p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_CellularStatesPlot.html">do_CellularStatesPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                   input_gene_list <span class="op">=</span> <span class="va">gene_set</span>,</span>
<span>                                   x1 <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                   y1 <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="20-CellularStatePlots_files/figure-html/unnamed-chunk-3-1.png" alt="SCpubr::do_CellularStatesPlot, 2 variables" width="100%" height="100%"><p class="caption">
Figure 1.2: SCpubr::do_CellularStatesPlot, 2 variables
</p>
</div>
<p>This way, we can see how much effect gene set A has with regards to gene set B. One can further enforce some symmetry in the plot with <code>enforce_symmetry = TRUE</code>.</p>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_CellularStatesPlot.html">do_CellularStatesPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                   input_gene_list <span class="op">=</span> <span class="va">gene_set</span>,</span>
<span>                                   x1 <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                   y1 <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                                   enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="20-CellularStatePlots_files/figure-html/unnamed-chunk-4-1.png" alt="SCpubr::do_CellularStatesPlot, 2 variables symmetry enforced" width="100%" height="100%"><p class="caption">
Figure 1.3: SCpubr::do_CellularStatesPlot, 2 variables symmetry enforced
</p>
</div>
</div>
<div id="variables" class="section level2" number="18.2">
<h2>
<span class="header-section-number">18.2</span> 3 variables<a class="anchor" aria-label="anchor" href="#variables"><i class="fas fa-link"></i></a>
</h2>
<p><span class="border-0"><img src="images/3_variables.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"></span></p>
<p>This plot is retrieved from <a href="https://www.nature.com/articles/nature20123">Tirosh, et al, 2016</a> and plot requires the user to provide three gene sets, for which enrichment scores are computed using <code><a href="https://satijalab.org/seurat/reference/AddModuleScore.html">Seurat::AddModuleScore</a></code>. For the X axis, two gene sets are assigned to it. Cells will be placed towards the right if they are enriched in <code>x1</code> and towards the left if they are enriched in <code>x2</code>. This is decided by, first, retrieving the enrichment scores for both lists and keeping the highest out of the two. The score will turn positive or negative depending on the gene list for which the highest enrichment score belonged to: positive for <code>x1</code> and negative for <code>x2</code>. For the Y axis. one gene set is provided. The value for the Y axis is computed by subtracting to the enrichment scores for <code>y1</code> the value for the X axis.</p>
<p>This plot makes a lot of sense, as showcased by <a href="https://www.nature.com/articles/nature20123">Tirosh, et al, 2016</a>, when the Y axis shows a differentiation trajectory. This is, it contains enrichment scores for <em>stemness</em> genes. Therefore, the lower on the Y axis, the less stem a given cell is. On the X axis, cells will order depending on whether they are enriched more in <code>x1</code> or <code>x2</code>. the more extreme the value on the X axis, the more differentiated towards the given list of genes the cell will be.</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_CellularStatesPlot.html">do_CellularStatesPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                   input_gene_list <span class="op">=</span> <span class="va">gene_set</span>,</span>
<span>                                   x1 <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                   y1 <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                                   x2 <span class="op">=</span> <span class="st">"C"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="20-CellularStatePlots_files/figure-html/unnamed-chunk-5-1.png" alt="SCpubr::do_CellularStatesPlot, 3 variables" width="100%" height="100%"><p class="caption">
Figure 1.4: SCpubr::do_CellularStatesPlot, 3 variables
</p>
</div>
<p>If <code>enforce_symmetry</code> is set to true, the X axis will have 0 as middle point.</p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_CellularStatesPlot.html">do_CellularStatesPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                   input_gene_list <span class="op">=</span> <span class="va">gene_set</span>,</span>
<span>                                   x1 <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                   y1 <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                                   x2 <span class="op">=</span> <span class="st">"C"</span>,</span>
<span>                                   enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="20-CellularStatePlots_files/figure-html/unnamed-chunk-6-1.png" alt="SCpubr::do_CellularStatesPlot, 3 variables symmetry enforced" width="100%" height="100%"><p class="caption">
Figure 1.5: SCpubr::do_CellularStatesPlot, 3 variables symmetry enforced
</p>
</div>
</div>
<div id="variables-1" class="section level2" number="18.3">
<h2>
<span class="header-section-number">18.3</span> 4 variables<a class="anchor" aria-label="anchor" href="#variables-1"><i class="fas fa-link"></i></a>
</h2>
<p><span class="border-0"><img src="images/4_variables.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"></span></p>
<p>This the most complicated variant of the plot, retrieved from <a href="https://pubmed.ncbi.nlm.nih.gov/31327527/">Neftel, et al, 2019</a>. This makes use of four gene sets: <code>x1</code>, <code>x2</code>, <code>y1</code> and <code>y2</code>. As a general, brief description, enrichment scores are computed for all 4 gene sets and the cells will locate in the resulting figure according to the list they are most enriched on, towards a given corner, following the scheme shown above.</p>
<p>This is achieved by assuming:
- <code>x1</code> and <code>x2</code> are connected, so are <code>y1</code> and <code>y2</code>. The first step will be to decide which the highest score out of <code>x1</code>-<code>x2</code> and <code>y1</code>-<code>y2</code>, which will locate the cells either on the upper or lower half (Y axis).
- Then, for the X axis, and depending on whether the score for the Y axis is positive or negative, the values will be computed as the log2 logarithm of the absolute of the difference in enrichment scores plus 1: <code>log2(abs((x1 or y1) - (x2 or y2)) + 1)</code>. The resulting value will be positive or negative depending on whether the score for <code>x1</code> or <code>y1</code> is higher or lower than the score for <code>x2</code> or <code>y2</code>.</p>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_CellularStatesPlot.html">do_CellularStatesPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                   input_gene_list <span class="op">=</span> <span class="va">gene_set</span>,</span>
<span>                                   x1 <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                   y1 <span class="op">=</span> <span class="st">"C"</span>,</span>
<span>                                   x2 <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                                   y2 <span class="op">=</span> <span class="st">"D"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-7"></span>
<img src="20-CellularStatePlots_files/figure-html/unnamed-chunk-7-1.png" alt="SCpubr::do_CellularStatesPlot, 4 variables" width="100%" height="100%"><p class="caption">
Figure 1.6: SCpubr::do_CellularStatesPlot, 4 variables
</p>
</div>
<p>If <code>enforce_symmetry</code> is set to true, then the plot is completely squared.</p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_CellularStatesPlot.html">do_CellularStatesPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                   input_gene_list <span class="op">=</span> <span class="va">gene_set</span>,</span>
<span>                                   x1 <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                   y1 <span class="op">=</span> <span class="st">"C"</span>,</span>
<span>                                   x2 <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                                   y2 <span class="op">=</span> <span class="st">"D"</span>,</span>
<span>                                   enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="20-CellularStatePlots_files/figure-html/unnamed-chunk-8-1.png" alt="SCpubr::do_CellularStatesPlot, 4 variables symmetry enforced" width="100%" height="100%"><p class="caption">
Figure 1.7: SCpubr::do_CellularStatesPlot, 4 variables symmetry enforced
</p>
</div>
</div>
<div id="continuous-features" class="section level2" number="18.4">
<h2>
<span class="header-section-number">18.4</span> Continuous features<a class="anchor" aria-label="anchor" href="#continuous-features"><i class="fas fa-link"></i></a>
</h2>
<p>In addition to all the above, one can also further query the resulting plot for any other feature that would be accepted in a regular <code>SCpubr::do_FeaturePlot().</code> The plots are returned alongside the original one. This behavior is achieved by using <code>plot_features = TRUE</code> and providing the desired features to <code>features</code> parameter.</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot continuous features.</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_CellularStatesPlot.html">do_CellularStatesPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                     input_gene_list <span class="op">=</span> <span class="va">gene_set</span>,</span>
<span>                                     x1 <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                     y1 <span class="op">=</span> <span class="st">"C"</span>,</span>
<span>                                     x2 <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                                     y2 <span class="op">=</span> <span class="st">"D"</span>,</span>
<span>                                     plot_cell_borders <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                     enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                     plot_features <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                     features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PC_1"</span>, <span class="st">"nFeature_RNA"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">main</span> <span class="op">|</span> <span class="va">out</span><span class="op">$</span><span class="va">PC_1</span> <span class="op">|</span> <span class="va">out</span><span class="op">$</span><span class="va">nFeature_RNA</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-9"></span>
<img src="20-CellularStatePlots_files/figure-html/unnamed-chunk-9-1.png" alt="SCpubr::do_CellularStatesPlot, 4 variables symmetry enforced querying for features" width="100%" height="100%"><p class="caption">
Figure 1.8: SCpubr::do_CellularStatesPlot, 4 variables symmetry enforced querying for features
</p>
</div>
<p>Furthermore, the original list of genes queried can be also plotted as enrichment scores. This can be achieved by <code>plot_enrichment_scores = TRUE</code>:</p>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot enrichment scores for the input gene lists.</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_CellularStatesPlot.html">do_CellularStatesPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                     input_gene_list <span class="op">=</span> <span class="va">gene_set</span>,</span>
<span>                                     x1 <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                     y1 <span class="op">=</span> <span class="st">"C"</span>,</span>
<span>                                     x2 <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>                                     y2 <span class="op">=</span> <span class="st">"D"</span>,</span>
<span>                                     plot_cell_borders <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                     enforce_symmetry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                     plot_enrichment_scores <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">layout</span> <span class="op">&lt;-</span> <span class="st">"AABC</span></span>
<span><span class="st">           AADE"</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html">wrap_plots</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">main</span>,</span>
<span>                           B <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">A</span>,</span>
<span>                           C <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">B</span>,</span>
<span>                           D <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">C</span>,</span>
<span>                           E <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">D</span>,</span>
<span>                           design <span class="op">=</span> <span class="va">layout</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="20-CellularStatePlots_files/figure-html/unnamed-chunk-10-1.png" alt="SCpubr::do_CellularStatesPlot, 4 variables symmetry enforced querying for enrichment scores of the original list of genes" width="100%" height="100%"><p class="caption">
Figure 1.9: SCpubr::do_CellularStatesPlot, 4 variables symmetry enforced querying for enrichment scores of the original list of genes
</p>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="correlation-matrix-heatmaps.html"><span class="header-section-number">17</span> Correlation matrix heatmaps</a></div>
<div class="next"><a href="ligand-receptor-analysis.html"><span class="header-section-number">19</span> Ligand-Receptor analysis</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><form role="search" class="mt-4 mb-4">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>
      <div class="book-extra">
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#cellular-state-plots"><span class="header-section-number">18</span> Cellular State Plots</a></li>
<li><a class="nav-link" href="#variable-plots"><span class="header-section-number">18.1</span> 2 variable plots</a></li>
<li><a class="nav-link" href="#variables"><span class="header-section-number">18.2</span> 3 variables</a></li>
<li><a class="nav-link" href="#variables-1"><span class="header-section-number">18.3</span> 4 variables</a></li>
<li><a class="nav-link" href="#continuous-features"><span class="header-section-number">18.4</span> Continuous features</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<!-- Modified page for chapter. --><li><a id="book-source" href="https://github.com/enblacar/SCpubr-book/blob/main/20-CellularStatePlots.Rmd">View chapter source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/enblacar/SCpubr-book/edit/main/20-CellularStatePlots.Rmd">Edit this chapter <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    
  </div>

</nav>
</div>
</div> <!-- .container -->




</div>
</body>
<!-- Moved the footer outside of the body to make it span all page width. --><footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p class="text-center">Written by <strong>Enrique Blanco Carmona</strong> on 06 October, 2022.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p class="text-center">This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</html>
