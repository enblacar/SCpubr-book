<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>1 Ridge plots | SCpubr</title>
<meta name="author" content="Enrique Blanco Carmona">
<meta name="description" content="Ridge plots are a very interesting way to display multiple violin plots together. The main idea of this type of visualization is to observe shifts in the distribution of a given variable across...">
<meta name="generator" content="bookdown 0.28 with bs4_book()">
<meta property="og:title" content="1 Ridge plots | SCpubr">
<meta property="og:type" content="book">
<meta property="og:url" content="https://enblacar.github.io/SCpubr-book/ridge-plots.html">
<meta property="og:image" content="https://enblacar.github.io/SCpubr-book/images/logo.png">
<meta property="og:description" content="Ridge plots are a very interesting way to display multiple violin plots together. The main idea of this type of visualization is to observe shifts in the distribution of a given variable across...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="1 Ridge plots | SCpubr">
<meta name="twitter:description" content="Ridge plots are a very interesting way to display multiple violin plots together. The main idea of this type of visualization is to observe shifts in the distribution of a given variable across...">
<meta name="twitter:image" content="https://enblacar.github.io/SCpubr-book/images/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link rel="shortcut icon" href="images/SCpubr_logo_favicon.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a id="toc_title" href="index.html" title="">SCpubr</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <div class="book-extra"></div>
      <nav id="left-panel" aria-label="Table of contents"><ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About this package</a></li>
<li><a class="active" href="ridge-plots.html"><span class="header-section-number">1</span> Ridge plots</a></li>
</ul>

        <div class="book-extra">
          <!-- Duplicated this entry to point to the package repo. -->
          <p class="mb-2"><a id="package-repo" href="https://github.com/enblacar/SCpubr">View package source <i class="fab fa-github"></i></a></p>
          <p><a id="book-repo" href="https://github.com/enblacar/SCpubr-book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="ridge-plots" class="section level1" number="1">
<h1>
<span class="header-section-number">1</span> Ridge plots<a class="anchor" aria-label="anchor" href="#ridge-plots"><i class="fas fa-link"></i></a>
</h1>
<p>Ridge plots are a very interesting way to display multiple <em>violin plots</em> together. The main idea of this type of visualization is to observe shifts in the distribution of a given variable across several groups. This can be accomplished using package.</p>
<p>The most basic ridge plot can be computed as:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute the most basic ridge plot.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_RidgePlot.html">do_RidgePlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                          feature <span class="op">=</span> <span class="st">"nFeature_RNA"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="07--RidgePlots_files/figure-html/unnamed-chunk-2-1.png" alt="Basic ridge plot" width="100%" height="100%"><p class="caption">
Figure 1.1: Basic ridge plot
</p>
</div>
<p>By default, the groups plotted are the current identities in the sample, but this can be changed by using <code>group.by</code>. One can also color the ridges based on the continuous values being represented, using <code>continuous_scale = TRUE</code>. The direction of the color scale can be controlled using <code>viridis_direction</code> :</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use continuous color scale.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_RidgePlot.html">do_RidgePlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                           feature <span class="op">=</span> <span class="st">"nFeature_RNA"</span>,</span>
<span>                           continuous_scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           viridis_direction <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_RidgePlot.html">do_RidgePlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                           feature <span class="op">=</span> <span class="st">"nFeature_RNA"</span>,</span>
<span>                           continuous_scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           viridis_direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="07--RidgePlots_files/figure-html/unnamed-chunk-3-1.png" alt="Basic ridge plot colored using the continuous scale." width="100%" height="100%"><p class="caption">
Figure 1.2: Basic ridge plot colored using the continuous scale.
</p>
</div>
<div id="plot-quantiles-of-the-distribution." class="section level2" number="1.1">
<h2>
<span class="header-section-number">1.1</span> Plot quantiles of the distribution.<a class="anchor" aria-label="anchor" href="#plot-quantiles-of-the-distribution."><i class="fas fa-link"></i></a>
</h2>
<p>One can also draw quantiles of the distribution for each of the groups. For this, we need to set up the scale to continuous. Also, we can modify the quantiles by using <code>quantiles</code> parameter:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Draw quantiles of the distribution.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_RidgePlot.html">do_RidgePlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                           feature <span class="op">=</span> <span class="st">"nFeature_RNA"</span>,</span>
<span>                           continuous_scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           compute_quantiles <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           compute_custom_quantiles <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_RidgePlot.html">do_RidgePlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                           feature <span class="op">=</span> <span class="st">"nFeature_RNA"</span>,</span>
<span>                           continuous_scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           compute_quantiles <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           compute_custom_quantiles <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="07--RidgePlots_files/figure-html/unnamed-chunk-4-1.png" alt="RidgePlots with quantiles." width="100%" height="100%"><p class="caption">
Figure 1.3: RidgePlots with quantiles.
</p>
</div>
</div>
<div id="compute-probability-tails" class="section level2" number="1.2">
<h2>
<span class="header-section-number">1.2</span> Compute probability tails<a class="anchor" aria-label="anchor" href="#compute-probability-tails"><i class="fas fa-link"></i></a>
</h2>
<p>One can draw probability tails of the distribution by using <code>compute_distribution_tails</code> and <code>prob_tails</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Draw probability tails.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_RidgePlot.html">do_RidgePlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                           feature <span class="op">=</span> <span class="st">"nFeature_RNA"</span>,</span>
<span>                           continuous_scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           compute_quantiles <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           compute_distribution_tails <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_RidgePlot.html">do_RidgePlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                           feature <span class="op">=</span> <span class="st">"nFeature_RNA"</span>,</span>
<span>                           continuous_scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           compute_quantiles <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           compute_distribution_tails <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           prob_tails <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="07--RidgePlots_files/figure-html/unnamed-chunk-5-1.png" alt="RidgePlots with probability tails." width="100%" height="100%"><p class="caption">
Figure 1.4: RidgePlots with probability tails.
</p>
</div>
</div>
<div id="compute-probability-densities" class="section level2" number="1.3">
<h2>
<span class="header-section-number">1.3</span> Compute probability densities<a class="anchor" aria-label="anchor" href="#compute-probability-densities"><i class="fas fa-link"></i></a>
</h2>
<p>One can also display the probability densities of the distributions by using :</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Draw probability tails.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_RidgePlot.html">do_RidgePlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                          feature <span class="op">=</span> <span class="st">"nFeature_RNA"</span>,</span>
<span>                          continuous_scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          compute_quantiles <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          color_by_probabilities <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="07--RidgePlots_files/figure-html/unnamed-chunk-6-1.png" alt="RidgePlots with probability densities." width="100%" height="100%"><p class="caption">
Figure 1.5: RidgePlots with probability densities.
</p>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="index.html">About this package</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><form role="search" class="mt-4 mb-4">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>
      <div class="book-extra">
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#ridge-plots"><span class="header-section-number">1</span> Ridge plots</a></li>
<li><a class="nav-link" href="#plot-quantiles-of-the-distribution."><span class="header-section-number">1.1</span> Plot quantiles of the distribution.</a></li>
<li><a class="nav-link" href="#compute-probability-tails"><span class="header-section-number">1.2</span> Compute probability tails</a></li>
<li><a class="nav-link" href="#compute-probability-densities"><span class="header-section-number">1.3</span> Compute probability densities</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<!-- Modified page for chapter. --><li><a id="book-source" href="https://github.com/enblacar/SCpubr-book/blob/main/07--RidgePlots.Rmd">View chapter source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/enblacar/SCpubr-book/edit/main/07--RidgePlots.Rmd">Edit this chapter <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    
  </div>

</nav>
</div>
</div> <!-- .container -->




</div>
</body>
<!-- Moved the footer outside of the body to make it span all page width. --><footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p class="text-center">Written by <strong>Enrique Blanco Carmona</strong> on 30 September, 2022.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p class="text-center">This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</html>
