<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.226">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>SCpubr - 23&nbsp; Ligand-Receptor analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./22-CopyNumberVariantPlots.html" rel="next">
<link href="./20-CellularStatesPlot.html" rel="prev">
<link href=".//images/SCpubr_logo_favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<meta property="og:title" content="SCpubr - 23&nbsp; Ligand-Receptor analysis">
<meta property="og:description" content="One very interesting analysis that can be carried out is Ligand-Receptor analysis.">
<meta property="og:site-name" content="SCpubr">
<meta name="twitter:title" content="SCpubr - 23&nbsp; Ligand-Receptor analysis">
<meta name="twitter:description" content="One very interesting analysis that can be carried out is Ligand-Receptor analysis.">
<meta name="twitter:card" content="summary">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Ligand-Receptor analysis</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">SCpubr </a><a href="https://github.com/enblacar/SCpubr/blob/main/NEWS.md"><code>v1.1.2</code></a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/enblacar/SCpubr/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">Getting started</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">About this package</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Installation-guide.html" class="sidebar-item-text sidebar-link">Installation guide</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-Dataset.html" class="sidebar-item-text sidebar-link">Dataset used</a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Basic plots</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-DimPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Dim plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-FeaturePlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Feature plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-NebulosaPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Nebulosa plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-BeeSwarmPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bee Swarm plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-ViolinPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Violin plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-RidgePlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ridge plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-DotPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Dot plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-BarPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Bar plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-BoxPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Box plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-GeyserPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Geyser plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-AlluvialPlot.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Alluvial plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-SankeyPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Sankey plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-ChordDiagramPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Chord Diagram plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-VolcanoPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Volcano plots</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Advanced plots</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-GroupwiseDEPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Group-wise DE analysis plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-GroupedGOPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Grouped GO Term analysis plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-FunctionalEnrichmentPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Functional Annotation Analysis plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-TermEnrichmentPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Term Enrichment Plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-ExpressionHeatmaps.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Expression heatmaps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-EnrichmentHeatmaps.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Enrichment score heatmaps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-CorrelationHeatmaps.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Correlation matrix heatmaps</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-CellularStatesPlot.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Cellular State Plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-LigandReceptorPlot.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Ligand-Receptor analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-CopyNumberVariantPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Copy Number Variant analysis plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-PathwayActivityPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Pathway Activity inference analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-TFActivityPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">TF Activity inference analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-AzimuthAnalysisPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Azimuth reference mapping reports</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-PseudotimeAnalysisPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Pseudotime analysis</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">Miscellaneous</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./93-ColorPalettes.html" class="sidebar-item-text sidebar-link">Color palettes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./94-CommonFeatures.html" class="sidebar-item-text sidebar-link">Common features across plots</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./95-SaveFigures.html" class="sidebar-item-text sidebar-link">Save the figures</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./96-Citation.html" class="sidebar-item-text sidebar-link">Citation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./97-NEWS.html" class="sidebar-item-text sidebar-link">News</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-Acknowledgements.html" class="sidebar-item-text sidebar-link">Acknowledgements</a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#basic-usage" id="toc-basic-usage" class="nav-link active" data-scroll-target="#basic-usage"><span class="toc-section-number">23.1</span>  Basic usage</a></li>
  <li><a href="#the-basis-of-the-analysis" id="toc-the-basis-of-the-analysis" class="nav-link" data-scroll-target="#the-basis-of-the-analysis"><span class="toc-section-number">23.2</span>  The basis of the analysis</a></li>
  <li><a href="#control-how-interactions-are-arranged" id="toc-control-how-interactions-are-arranged" class="nav-link" data-scroll-target="#control-how-interactions-are-arranged"><span class="toc-section-number">23.3</span>  Control how interactions are arranged</a></li>
  <li><a href="#order-interacting-pairs-alphabetically" id="toc-order-interacting-pairs-alphabetically" class="nav-link" data-scroll-target="#order-interacting-pairs-alphabetically"><span class="toc-section-number">23.4</span>  Order interacting pairs alphabetically</a></li>
  <li><a href="#increase-the-top-significant-interactions-plotted" id="toc-increase-the-top-significant-interactions-plotted" class="nav-link" data-scroll-target="#increase-the-top-significant-interactions-plotted"><span class="toc-section-number">23.5</span>  Increase the top significant interactions plotted</a></li>
  <li><a href="#add-or-remove-missing-source-target-combinations" id="toc-add-or-remove-missing-source-target-combinations" class="nav-link" data-scroll-target="#add-or-remove-missing-source-target-combinations"><span class="toc-section-number">23.6</span>  Add or remove missing source-target combinations</a></li>
  <li><a href="#modify-the-size-of-dots" id="toc-modify-the-size-of-dots" class="nav-link" data-scroll-target="#modify-the-size-of-dots"><span class="toc-section-number">23.7</span>  Modify the size of dots</a></li>
  <li><a href="#toggle-grid-lines" id="toc-toggle-grid-lines" class="nav-link" data-scroll-target="#toggle-grid-lines"><span class="toc-section-number">23.8</span>  Toggle grid lines</a></li>
  <li><a href="#invert-axis" id="toc-invert-axis" class="nav-link" data-scroll-target="#invert-axis"><span class="toc-section-number">23.9</span>  Invert axis</a></li>
  <li><a href="#split-the-plot-by-ligand-or-receptor-complex" id="toc-split-the-plot-by-ligand-or-receptor-complex" class="nav-link" data-scroll-target="#split-the-plot-by-ligand-or-receptor-complex"><span class="toc-section-number">23.10</span>  Split the plot by ligand or receptor complex</a></li>
  <li><a href="#restrict-the-plot-to-given-source-andor-targets" id="toc-restrict-the-plot-to-given-source-andor-targets" class="nav-link" data-scroll-target="#restrict-the-plot-to-given-source-andor-targets"><span class="toc-section-number">23.11</span>  Restrict the plot to given source and/or targets</a></li>
  <li><a href="#compute-chord-diagrams-of-the-interactions" id="toc-compute-chord-diagrams-of-the-interactions" class="nav-link" data-scroll-target="#compute-chord-diagrams-of-the-interactions"><span class="toc-section-number">23.12</span>  Compute chord diagrams of the interactions</a></li>
  <li><a href="#avoid-generating-a-omnipath-log-folder" id="toc-avoid-generating-a-omnipath-log-folder" class="nav-link" data-scroll-target="#avoid-generating-a-omnipath-log-folder"><span class="toc-section-number">23.13</span>  Avoid generating a <code>omnipath-log</code> folder</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/enblacar/SCpubr/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">
<span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Ligand-Receptor analysis</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Please note:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Due to CRAN policies, this function could not make it to the <strong>official release</strong> and is only available in the <strong>development release</strong> of <strong>SCpubr</strong>. Find how to install it <a href="https://github.com/enblacar/SCpubr/releases/tag/v1.1.2-dev-stable"><strong>here</strong></a>.</p>
<p>Once the package becomes available on CRAN/Bioconductor, the function will be integrated in the official release.</p>
</div>
</div>
<div class="cell" data-layout-align="center">

</div>
<p>One very interesting analysis that can be carried out is <strong>Ligand-Receptor analysis</strong>. This allows to compute whether specific clusters interact with each other based on the co-expression of a ligand and its receptor in the respective clusters. The interactions are retrieved from different databases and a plethora of tools have been released to tackle this analysis. One of them is <a href="https://saezlab.github.io/liana/index.html">liana</a>, which is a framework that allows to run and <strong>integrate</strong> the results of several tools, providing a meta-analysis of the co-expression of ligand-receptor pairs. <code>SCpubr</code> makes use of <code>liana</code> and has its analysis and visualization integrated in the <code><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">SCpubr::do_LigandReceptorPlot()</a></code> function.</p>
<section id="basic-usage" class="level2" data-number="23.1"><h2 data-number="23.1" class="anchored" data-anchor-id="basic-usage">
<span class="header-section-number">23.1</span> Basic usage</h2>
<p>By default, the user has to run <code>liana</code> on their own and provide the resulting output as input for the function. The following code would produces the object that <code><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">SCpubr::do_LigandReceptorPlot()</a></code> expects as input:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">liana_output</span> <span class="op">&lt;-</span> <span class="fu">liana</span><span class="fu">::</span><span class="fu"><a href="https://saezlab.github.io/liana/reference/liana_wrap.html">liana_wrap</a></span><span class="op">(</span>sce <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"natmi"</span>, <span class="st">"connectome"</span>, <span class="st">"logfc"</span>, <span class="st">"sca"</span>, <span class="st">"cellphonedb"</span><span class="op">)</span>,</span>
<span>                                  idents_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                  assay <span class="op">=</span> <span class="st">"SCT"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is very important to note that <code>liana_output</code> has to contain the five different methods. This is a design choice. The output looks like:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Ligand Receptor analysis plot.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="21-LigandReceptorPlot_files/figure-html/unnamed-chunk-4-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Default output.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="the-basis-of-the-analysis" class="level2" data-number="23.2"><h2 data-number="23.2" class="anchored" data-anchor-id="the-basis-of-the-analysis">
<span class="header-section-number">23.2</span> The basis of the analysis</h2>
<p>To give a more complete overview of how the scores retrieved from <strong>liana</strong> are treated in <code>SCpubr::do_LigandReceptorAnalysis()</code>, here is a short summary:</p>
<p>The output of <code><a href="https://saezlab.github.io/liana/reference/liana_wrap.html">liana::liana_wrap()</a></code> is fed to liana::liana_aggregate(), that computes a metric called “aggregate_rank”, which <a href="https://github.com/saezlab/liana/issues/47#issuecomment-1192528005">according to the authors</a>, is the metric that can be used for <strong>significance</strong>.</p>
<blockquote class="blockquote">
<p><em>For the ranks, it’s a bit different. rank_aggregate is simply a probability distribution saying how highly-ranked a given interaction is when aggregating all score vectors - i.e.&nbsp;it’s only indicative of what you have it aggregate.</em></p>
</blockquote>
<p>In the GitHub issue, <strong>liana’s developer</strong> discuss how different metrics from different tools can be used to measure the <strong>significance</strong> and <strong>magnitude</strong> of the interactions. Then, he suggests how to approach the downstream analysis of the aggregated scores:</p>
<blockquote class="blockquote">
<p><em>Really then the user can pick how to best approach the results. 1) You can filter by CellPhoneDB p-value or the aggregate_rank probabilities, 2) Rank interactions by specificity /w NATMI’s edge weights, 3) Use LRscores for magnitude as they are easy to intepret and comparable across datasets.</em></p>
</blockquote>
<p>Following this line of thought, this is what is then implemented in <code>SCpubr::do_LigandReceptorAnalysis()</code>:</p>
<ul>
<li>Originally, interactions were filtered out using <code>aggregate_rank &lt;= 0.05</code>, but now this is not applied as we also want to display the non-significant interactions in contrast with the significant ones. If we were to filter them out, the dotplot will only containing statistically significant interactions. This will render the dotplot completely blank. In order to populate it with plot with the rest of interactions, a design choice was made to also include non-significant interactions to get a better sense of the plot by comparing them to the significant ones.</li>
<li>Then, interactions are sorted out by <code>decresing significance</code> (<strong>natmi.edge_specificity column</strong>) and <code>decreasing magnitude</code> (<strong>sca.LRscore column</strong>).</li>
<li>For plotting, the <em>top N</em> interactions (designated by the user) with the <code>top_interactions parameter</code> are displayed (thus including, if <code>top_interactions</code> is <strong>really</strong> large, potentially non-significant interactions).</li>
</ul>
<p>This means that, <strong>depending on the number of top interactions retrieved</strong>, we might end up with non-significant interactions across any source-target combinations. However, this will be clearly evident in contrast with the top hits. One has also to understand the meaning behind the chosen <strong>specificity</strong> and <strong>magnitude</strong> columns used to sort the interactions. For this, individual inspection of the methods used by <strong>liana</strong> is advisable.</p>
<p>Finally, for the <strong>chord diagram plots</strong>, different number of interactions are used: - To represent the <strong>total number of interactions</strong> between <strong>source</strong> and <strong>target</strong>, interactions are filtered out using <code>aggregate_rank &lt;= 0.05</code>. The remaining ones are considered significant and therefore included in the diagram. - To represent the <strong>total number of interactions</strong> between <strong>ligand.complex</strong> and <strong>receptor.complex</strong>, the <strong>top interactions</strong> are used instead. Since this means retreaving the interactions across all possible <strong>source/target pairs</strong>, like in the output dotplots, they include potential non-significant interactions as well.</p>
</section><section id="control-how-interactions-are-arranged" class="level2" data-number="23.3"><h2 data-number="23.3" class="anchored" data-anchor-id="control-how-interactions-are-arranged">
<span class="header-section-number">23.3</span> Control how interactions are arranged</h2>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Please note:
</div>
</div>
<div class="callout-body-container callout-body">
<p>This feature will be available in the next CRAN release! (v1.1.0)</p>
</div>
</div>
<p>The result of <code><a href="https://saezlab.github.io/liana/reference/liana_aggregate.html">liana::liana_aggregate()</a></code> can be processed in multiple ways:</p>
<ul>
<li>By default, the output matrix is already arranged by ascending <code>aggregate_rank</code>, which acts as a kind of p-value.</li>
<li>The interactions can be arranged by descending <code>magnitude</code> (how strong is the interaction) or <code>specificity</code> (how significant is the interaction).</li>
<li>Or both.</li>
</ul>
<p>In this context, users can decide how the results are arranged in the final plot by providing <code>arrange_interactions_by</code> and one of: <code>aggregate_rank</code>, <code>magnitude</code>, <code>specificity</code> or <code>both</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Arrange the interactions by aggregate_rank</span></span>
<span><span class="co"># Ligand Receptor analysis plot with extra interactions.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   arrange_interactions_by <span class="op">=</span> <span class="st">"aggregate_rank"</span>,</span>
<span>                                   top_interactions <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="21-LigandReceptorPlot_files/figure-html/unnamed-chunk-5-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Arrange the interactions by aggregate_rank.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Arrange the interactions by specificity</span></span>
<span><span class="co"># Ligand Receptor analysis plot with extra interactions.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   arrange_interactions_by <span class="op">=</span> <span class="st">"specificity"</span>,</span>
<span>                                   top_interactions <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="21-LigandReceptorPlot_files/figure-html/unnamed-chunk-6-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Arrange the interactions by specificity.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Arrange the interactions by magnitude</span></span>
<span><span class="co"># Ligand Receptor analysis plot with extra interactions.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   arrange_interactions_by <span class="op">=</span> <span class="st">"magnitude"</span>,</span>
<span>                                   top_interactions <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="21-LigandReceptorPlot_files/figure-html/unnamed-chunk-7-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Arrange the interactions by magnitude.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Arrange the interactions by both magnitude and specificity.</span></span>
<span><span class="co"># Ligand Receptor analysis plot with extra interactions.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   arrange_interactions_by <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>                                   top_interactions <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="21-LigandReceptorPlot_files/figure-html/unnamed-chunk-8-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Arrange the interactions by both magnitude and specificity.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="order-interacting-pairs-alphabetically" class="level2" data-number="23.4"><h2 data-number="23.4" class="anchored" data-anchor-id="order-interacting-pairs-alphabetically">
<span class="header-section-number">23.4</span> Order interacting pairs alphabetically</h2>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Please note:
</div>
</div>
<div class="callout-body-container callout-body">
<p>This feature will be available in the next CRAN release! (v1.1.0)</p>
</div>
</div>
<p>By default, the interactions are shown as they are in the original matrix. However, we can also order them alphabetically by using <code>sort_interactions_alphabetically = TRUE</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Arrange the interactions alphabetically.</span></span>
<span><span class="co"># Ligand Receptor analysis plot with extra interactions.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   sort_interactions_alphabetically <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   top_interactions <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="21-LigandReceptorPlot_files/figure-html/unnamed-chunk-9-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Arrange the interactions alphabetically.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="increase-the-top-significant-interactions-plotted" class="level2" data-number="23.5"><h2 data-number="23.5" class="anchored" data-anchor-id="increase-the-top-significant-interactions-plotted">
<span class="header-section-number">23.5</span> Increase the top significant interactions plotted</h2>
<p>By default, top 25 unique, most significant interactions are retrieved and plotted. However, this can be changed by using <code>top_interactions</code>. Also, clusters that have no interactions, both as source and target, will be removed.:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Ligand Receptor analysis plot with extra interactions.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   top_interactions <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="21-LigandReceptorPlot_files/figure-html/unnamed-chunk-10-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Increase the number of interactions.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="add-or-remove-missing-source-target-combinations" class="level2" data-number="23.6"><h2 data-number="23.6" class="anchored" data-anchor-id="add-or-remove-missing-source-target-combinations">
<span class="header-section-number">23.6</span> Add or remove missing source-target combinations</h2>
<p>Depending on the value we select for <code>top_interactions</code>, we might find out that there are specific source-target combinations for which we have no interactions at all. These show up in the resulting dotplot as empty columns. This is a design choice, as <strong>SCpubr</strong> brings these combinations back as NA values, thus making the different panels in the dotplot easier to read. However, with a small number of interactions, this might result in a very empty dotplot. Also, if we have many different sources, the plot can also become very long.</p>
<p>In cases like these, we might rather go for only the relevant columns. We can toggle on/off this behaviour by using <code>add_missing_LR_combinations = TRUE/FALSE</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># Add missing LR combinations.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                    add_missing_LR_combinations <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Restrict the results to only the LR combinations that have a value.</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                    add_missing_LR_combinations <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span><span class="va">p2</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="21-LigandReceptorPlot_files/figure-html/unnamed-chunk-11-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Add or remove the missing Ligand-Receptor interactions.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="modify-the-size-of-dots" class="level2" data-number="23.7"><h2 data-number="23.7" class="anchored" data-anchor-id="modify-the-size-of-dots">
<span class="header-section-number">23.7</span> Modify the size of dots</h2>
<p>Size of dots can be modified with <code>dot.size</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Ligand Receptor analysis plot with increased dot size.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   dot.size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="21-LigandReceptorPlot_files/figure-html/unnamed-chunk-12-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Increase the dot size.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="toggle-grid-lines" class="level2" data-number="23.8"><h2 data-number="23.8" class="anchored" data-anchor-id="toggle-grid-lines">
<span class="header-section-number">23.8</span> Toggle grid lines</h2>
<p>One can also draw some grid lines. This is specially useful when the plot gets too big. This can be achieved by using <code>plot.grid = TRUE/FALSE</code>. The grid lines can be controlled using <code>grid.type</code> and the color with <code>grid.color</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Ligand Receptor analysis plot with grid.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   grid.color <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="21-LigandReceptorPlot_files/figure-html/unnamed-chunk-13-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Add grid lines.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="invert-axis" class="level2" data-number="23.9"><h2 data-number="23.9" class="anchored" data-anchor-id="invert-axis">
<span class="header-section-number">23.9</span> Invert axis</h2>
<p>For the cases in which one want to plot a lot of interactions, the plot can be flipped with <code>flip = TRUE</code>. X axis labels can be rotated with <code>rotate_x_axis_labels</code>, providing either 0, 45 or 90 degrees and strip text can be also rotated with <code>rotate_strip_text = TRUE</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Ligand Receptor analysis plot with inverted axes.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   flip <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                   rotate_x_axis_labels <span class="op">=</span> <span class="fl">90</span>,</span>
<span>                                   rotate_strip_text <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="21-LigandReceptorPlot_files/figure-html/unnamed-chunk-14-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Flip the plot.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="split-the-plot-by-ligand-or-receptor-complex" class="level2" data-number="23.10"><h2 data-number="23.10" class="anchored" data-anchor-id="split-the-plot-by-ligand-or-receptor-complex">
<span class="header-section-number">23.10</span> Split the plot by ligand or receptor complex</h2>
<p>Furthermore, the plot can be also further divided by grouping the interactions by common ligand or receptor complex. This can be achieved using <code>split.by</code> parameter.:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Ligand Receptor analysis plot grouped by ligand.complex.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   plot.grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   grid.color <span class="op">=</span> <span class="st">"grey90"</span>,</span>
<span>                                   grid.type <span class="op">=</span> <span class="st">"dotted"</span>,</span>
<span>                                   rotate_x_axis_labels <span class="op">=</span> <span class="fl">90</span>,</span>
<span>                                   rotate_strip_text <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   split.by <span class="op">=</span> <span class="st">"ligand.complex"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="21-LigandReceptorPlot_files/figure-html/unnamed-chunk-15-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Split by ligand complex.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># Ligand Receptor analysis plot grouped by ligand.complex.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   split.by <span class="op">=</span> <span class="st">"receptor.complex"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="21-LigandReceptorPlot_files/figure-html/unnamed-chunk-16-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Split by receptor complex.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="restrict-the-plot-to-given-source-andor-targets" class="level2" data-number="23.11"><h2 data-number="23.11" class="anchored" data-anchor-id="restrict-the-plot-to-given-source-andor-targets">
<span class="header-section-number">23.11</span> Restrict the plot to given source and/or targets</h2>
<p>Finally, one can also restrict the output to given source and target clusters. This can be achieved by provided the desired identities to <code>keep_source</code> and <code>keep_target</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="co"># Ligand Receptor analysis plot with inverted axes with filtered source and targets.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   flip <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                   keep_source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"3"</span>, <span class="st">"9"</span><span class="op">)</span>,</span>
<span>                                   keep_target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"9"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="21-LigandReceptorPlot_files/figure-html/unnamed-chunk-17-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Filter ligand and/or recpetor complex.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="compute-chord-diagrams-of-the-interactions" class="level2" data-number="23.12"><h2 data-number="23.12" class="anchored" data-anchor-id="compute-chord-diagrams-of-the-interactions">
<span class="header-section-number">23.12</span> Compute chord diagrams of the interactions</h2>
<p>Another supplementary visualizations that one can do with the results of liana is to visualize: - The total number of significant interactions between each pair of clusters. - The number of interactions between the <code>top_interactions</code> ligand-receptor pairs.</p>
<p>This can be achieved by providing <code>compute_ChordDiagrams = TRUE</code>. This will return a list with the dot plot and chord diagrams.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Chord diagram of the total significant interactions from each cluster and all the rest.</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                     top_interactions <span class="op">=</span> <span class="fl">25</span>,</span>
<span>                                     compute_ChordDiagrams <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">chord_total_interactions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/chord1.png" class="mx-auto d-block" style="box-shadow: none; width: 100%"></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Chord diagram of the total ligand-receptor interactions from each cluster and all the rest.</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">chord_ligand_receptor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/chord2.png" class="mx-auto d-block" style="box-shadow: none; width: 100%"></p>
<p>However, the plot can become quite messy. For this, it becomes more interesting to use in combination of <code>keep_source</code> or <code>keep_target</code> parameters:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Chord diagram of the total significant interactions from each cluster and all the rest.</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                     top_interactions <span class="op">=</span> <span class="fl">25</span>,</span>
<span>                                     keep_source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"7"</span><span class="op">)</span>,</span>
<span>                                     compute_ChordDiagrams <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">chord_total_interactions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/chord3.png" class="mx-auto d-block" style="box-shadow: none; width: 100%"></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Chord diagram of the total ligand-receptor interactions from each cluster and all the rest.</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">chord_ligand_receptor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/chord4.png" class="mx-auto d-block" style="box-shadow: none; width: 100%"></p>
</section><section id="avoid-generating-a-omnipath-log-folder" class="level2" data-number="23.13"><h2 data-number="23.13" class="anchored" data-anchor-id="avoid-generating-a-omnipath-log-folder">
<span class="header-section-number">23.13</span> Avoid generating a <code>omnipath-log</code> folder</h2>
<p>If this folder appears in your tree structure, consider applying the hotfix stated <a href="https://github.com/saezlab/liana/issues/61#issuecomment-1271589284">here</a>.</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./20-CellularStatesPlot.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Cellular State Plots</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./22-CopyNumberVariantPlots.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Copy Number Variant analysis plots</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Written by <strong>Enrique Blanco Carmona</strong></div>   
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>