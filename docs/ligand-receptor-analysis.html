<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>19 Ligand-Receptor analysis | SCpubr</title>
<meta name="author" content="Enrique Blanco Carmona">
<meta name="description" content="Due to CRAN policies, this function could not make it to the official release and is only available in the development release of SCpubr. Find how to install it here. Once the package becomes...">
<meta name="generator" content="bookdown 0.28 with bs4_book()">
<meta property="og:title" content="19 Ligand-Receptor analysis | SCpubr">
<meta property="og:type" content="book">
<meta property="og:url" content="https://enblacar.github.io/SCpubr-book/ligand-receptor-analysis.html">
<meta property="og:image" content="https://enblacar.github.io/SCpubr-book/images/logo.png">
<meta property="og:description" content="Due to CRAN policies, this function could not make it to the official release and is only available in the development release of SCpubr. Find how to install it here. Once the package becomes...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="19 Ligand-Receptor analysis | SCpubr">
<meta name="twitter:description" content="Due to CRAN policies, this function could not make it to the official release and is only available in the development release of SCpubr. Find how to install it here. Once the package becomes...">
<meta name="twitter:image" content="https://enblacar.github.io/SCpubr-book/images/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link rel="shortcut icon" href="images/SCpubr_logo_favicon.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a id="toc_title" href="index.html" title="">SCpubr</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <div class="book-extra"></div>
      <nav id="left-panel" aria-label="Table of contents"><ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About this package</a></li>
<li><a class="" href="installation-guide.html">Installation guide</a></li>
<li><a class="" href="dataset-used.html">Dataset used</a></li>
<li><a class="" href="dim-plots.html"><span class="header-section-number">1</span> Dim plots</a></li>
<li><a class="" href="feature-plots.html"><span class="header-section-number">2</span> Feature plots</a></li>
<li><a class="" href="nebulosa-plots.html"><span class="header-section-number">3</span> Nebulosa plots</a></li>
<li><a class="" href="bee-swarm-plots.html"><span class="header-section-number">4</span> Bee Swarm plots</a></li>
<li><a class="" href="violin-plots.html"><span class="header-section-number">5</span> Violin plots</a></li>
<li><a class="" href="ridge-plots.html"><span class="header-section-number">6</span> Ridge plots</a></li>
<li><a class="" href="dot-plots.html"><span class="header-section-number">7</span> Dot plots</a></li>
<li><a class="" href="bar-plots.html"><span class="header-section-number">8</span> Bar plots</a></li>
<li><a class="" href="box-plots.html"><span class="header-section-number">9</span> Box plots</a></li>
<li><a class="" href="geyser-plots.html"><span class="header-section-number">10</span> Geyser plots</a></li>
<li><a class="" href="sankey-and-alluvial-plots.html"><span class="header-section-number">11</span> Sankey and alluvial plots</a></li>
<li><a class="" href="chord-diagram-plots.html"><span class="header-section-number">12</span> Chord Diagram plots</a></li>
<li><a class="" href="volcano-plots.html"><span class="header-section-number">13</span> Volcano plots</a></li>
<li><a class="" href="group-wise-de-analysis-plots.html"><span class="header-section-number">14</span> Group-wise DE analysis plots</a></li>
<li><a class="" href="term-enrichment-plots.html"><span class="header-section-number">15</span> Term Enrichment Plots</a></li>
<li><a class="" href="enrichment-score-heatmaps.html"><span class="header-section-number">16</span> Enrichment score heatmaps</a></li>
<li><a class="" href="correlation-matrix-heatmaps.html"><span class="header-section-number">17</span> Correlation matrix heatmaps</a></li>
<li><a class="" href="cellular-state-plots.html"><span class="header-section-number">18</span> Cellular State Plots</a></li>
<li><a class="active" href="ligand-receptor-analysis.html"><span class="header-section-number">19</span> Ligand-Receptor analysis</a></li>
<li><a class="" href="copy-number-variant-analysis-plots.html"><span class="header-section-number">20</span> Copy Number Variant analysis plots</a></li>
<li><a class="" href="pathway-activity-inference-analysis.html"><span class="header-section-number">21</span> Pathway Activity inference analysis</a></li>
<li><a class="" href="tf-activity-inference-analysis.html"><span class="header-section-number">22</span> TF Activity inference analysis</a></li>
<li><a class="" href="pseudotime-analysis.html"><span class="header-section-number">23</span> Pseudotime analysis</a></li>
<li><a class="" href="color-palettes.html"><span class="header-section-number">24</span> Color palettes</a></li>
<li><a class="" href="common-features-across-plots.html">Common features across plots</a></li>
<li><a class="" href="save-the-figures.html">Save the figures</a></li>
<li><a class="" href="citation.html">Citation</a></li>
<li><a class="" href="news.html">News</a></li>
<li><a class="" href="acknowledgements.html">Acknowledgements</a></li>
</ul>

        <div class="book-extra">
          <!-- Duplicated this entry to point to the package repo. -->
          <p class="mb-2"><a id="package-repo" href="https://github.com/enblacar/SCpubr">View package source <i class="fab fa-github"></i></a></p>
          <p><a id="book-repo" href="https://github.com/enblacar/SCpubr-book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="ligand-receptor-analysis" class="section level1" number="19">
<h1>
<span class="header-section-number">19</span> Ligand-Receptor analysis<a class="anchor" aria-label="anchor" href="#ligand-receptor-analysis"><i class="fas fa-link"></i></a>
</h1>
<div class="warningbox warning">
<p>Due to CRAN policies, this function could not make it to the <strong>official release</strong> and is only available in the <strong>development release</strong> of <strong>SCpubr</strong>.
Find how to install it <a href="https://github.com/enblacar/SCpubr/releases/tag/v1.0.1-dev-stable"><strong>here</strong></a>.</p>
<p>Once the package becomes available on CRAN/Bioconductor, the function will be integrated in the official release.</p>
</div>
<p>One very interesting analysis that can be carried out is <strong>Ligand-Receptor analysis</strong>. This allows to compute whether specific clusters interact with each other based on the co-expression of a ligand and its receptor in the respective clusters. The interactions are retrieved from different databases and a plethora of tools have been released to tackle this analysis. One of them is <a href="https://saezlab.github.io/liana/index.html">liana</a>, which is a framework that allows to run and <strong>integrate</strong> the results of several tools, providing a meta-analysis of the co-expression of ligand-receptor pairs. <code>SCpubr</code> makes use of <code>liana</code> and has its analysis and visualization integrated in the <code><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">SCpubr::do_LigandReceptorPlot()</a></code> function.</p>
<div id="basic-usage-12" class="section level2" number="19.1">
<h2>
<span class="header-section-number">19.1</span> Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage-12"><i class="fas fa-link"></i></a>
</h2>
<p>By default, the user has to run <code>liana</code> on their own and provide the resulting output as input for the function. The following code would produces the object that <code><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">SCpubr::do_LigandReceptorPlot()</a></code> expects as input:</p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">liana_output</span> <span class="op">&lt;-</span> <span class="fu">liana</span><span class="fu">::</span><span class="fu"><a href="https://saezlab.github.io/liana/reference/liana_wrap.html">liana_wrap</a></span><span class="op">(</span>sce <span class="op">=</span> <span class="va">sample</span>,</span>
<span>                                  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"natmi"</span>, <span class="st">"connectome"</span>, <span class="st">"logfc"</span>, <span class="st">"sca"</span>, <span class="st">"cellphonedb"</span><span class="op">)</span>,</span>
<span>                                  idents_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                  assay <span class="op">=</span> <span class="st">"SCT"</span><span class="op">)</span></span></code></pre></div>
<p>It is very important to note that <code>liana_output</code> has to contain the five different methods. This is a design choice. The output looks like:</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ligand Receptor analysis plot.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="21-LigandReceptorAnalysis_files/figure-html/unnamed-chunk-3-1.png" alt="SCpubr do_LigandReceptorPlot default output." width="100%" height="100%"><p class="caption">
Figure 1.2: SCpubr do_LigandReceptorPlot default output.
</p>
</div>
</div>
<div id="increase-the-top-significant-interactions-plotted" class="section level2" number="19.2">
<h2>
<span class="header-section-number">19.2</span> Increase the top significant interactions plotted<a class="anchor" aria-label="anchor" href="#increase-the-top-significant-interactions-plotted"><i class="fas fa-link"></i></a>
</h2>
<p>By default, top 25 unique, most significant interactions are retrieved and plotted. However, this can be changed by using <code>top_interactions</code>. Also, clusters that have no interactions, both as source and target, will be removed.:</p>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ligand Receptor analysis plot with extra interactions.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   top_interactions <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="21-LigandReceptorAnalysis_files/figure-html/unnamed-chunk-4-1.png" alt="SCpubr do_LigandReceptorPlot default output with extra interactions." width="100%" height="100%"><p class="caption">
Figure 1.3: SCpubr do_LigandReceptorPlot default output with extra interactions.
</p>
</div>
</div>
<div id="add-or-remove-missing-source-target-combinations" class="section level2" number="19.3">
<h2>
<span class="header-section-number">19.3</span> Add or remove missing source-target combinations<a class="anchor" aria-label="anchor" href="#add-or-remove-missing-source-target-combinations"><i class="fas fa-link"></i></a>
</h2>
<p>Depending on the value we select for <code>top_interactions</code>, we might find out that there are specific source-target combinations for which we have no interactions at all. These show up in the resulting dotplot as empty columns. This is a design choice, as <strong>SCpubr</strong> brings these combinations back as NA values, thus making the different panels in the dotplot easier to read. However, with a small number of interactions, this might result in a very empty dotplot. Also, if we have many different sources, the plot can also become very long.</p>
<p>In cases like these, we might rather go for only the relevant columns. We can toggle on/off this behaviour by using ``:</p>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add missing LR combinations.</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                    add_missing_LR_combinations <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Restrict the results to only the LR combinations that have a value.</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                    add_missing_LR_combinations <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">/</span><span class="va">p2</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="21-LigandReceptorAnalysis_files/figure-html/unnamed-chunk-5-1.png" alt="SCpubr do_LigandReceptorPlot with and without missing LR combinations." width="100%" height="100%"><p class="caption">
Figure 1.4: SCpubr do_LigandReceptorPlot with and without missing LR combinations.
</p>
</div>
</div>
<div id="modify-the-size-of-dots" class="section level2" number="19.4">
<h2>
<span class="header-section-number">19.4</span> Modify the size of dots<a class="anchor" aria-label="anchor" href="#modify-the-size-of-dots"><i class="fas fa-link"></i></a>
</h2>
<p>Size of dots can be modified with <code>dot.size</code>:</p>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ligand Receptor analysis plot with increased dot size.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   dot.size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="21-LigandReceptorAnalysis_files/figure-html/unnamed-chunk-6-1.png" alt="SCpubr do_LigandReceptorPlot with increased dot size." width="100%" height="100%"><p class="caption">
Figure 1.5: SCpubr do_LigandReceptorPlot with increased dot size.
</p>
</div>
</div>
<div id="toggle-grid-lines" class="section level2" number="19.5">
<h2>
<span class="header-section-number">19.5</span> Toggle grid lines<a class="anchor" aria-label="anchor" href="#toggle-grid-lines"><i class="fas fa-link"></i></a>
</h2>
<p>One can also draw some grid lines. This is specially useful when the plot gets too big. This can be achieved by using <code>plot.grid = TRUE/FALSE</code>. The grid lines can be controlled using <code>grid.type</code> and the color with <code>grid.color</code>:</p>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ligand Receptor analysis plot with grid.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   grid.color <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-7"></span>
<img src="21-LigandReceptorAnalysis_files/figure-html/unnamed-chunk-7-1.png" alt="SCpubr do_LigandReceptorPlot with grid lines." width="100%" height="100%"><p class="caption">
Figure 1.6: SCpubr do_LigandReceptorPlot with grid lines.
</p>
</div>
</div>
<div id="invert-axis" class="section level2" number="19.6">
<h2>
<span class="header-section-number">19.6</span> Invert axis<a class="anchor" aria-label="anchor" href="#invert-axis"><i class="fas fa-link"></i></a>
</h2>
<p>For the cases in which one want to plot a lot of interactions, the plot can be flipped with <code>flip = TRUE</code>. X axis labels can be rotated with <code>x_labels_angle</code>, providing either 0, 45 or 90 degrees and strip text can be also rotated with <code>rotate_strip_text = TRUE</code>.</p>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ligand Receptor analysis plot with inverted axes.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   flip <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                   x_labels_angle <span class="op">=</span> <span class="fl">90</span>,</span>
<span>                                   rotate_strip_text <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="21-LigandReceptorAnalysis_files/figure-html/unnamed-chunk-8-1.png" alt="SCpubr do_LigandReceptorPlot with inverted axes." width="100%" height="100%"><p class="caption">
Figure 1.7: SCpubr do_LigandReceptorPlot with inverted axes.
</p>
</div>
</div>
<div id="split-the-plot-by-ligand-or-receptor-complex" class="section level2" number="19.7">
<h2>
<span class="header-section-number">19.7</span> Split the plot by ligand or receptor complex<a class="anchor" aria-label="anchor" href="#split-the-plot-by-ligand-or-receptor-complex"><i class="fas fa-link"></i></a>
</h2>
<p>Furthermore, the plot can be also further divided by grouping the interactions by common ligand or receptor complex. This can be achieved using <code>split.by</code> parameter.:</p>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ligand Receptor analysis plot grouped by ligand.complex.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   plot.grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   grid.color <span class="op">=</span> <span class="st">"grey90"</span>,</span>
<span>                                   grid.type <span class="op">=</span> <span class="st">"dotted"</span>,</span>
<span>                                   x_labels_angle <span class="op">=</span> <span class="fl">90</span>,</span>
<span>                                   rotate_strip_text <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   split.by <span class="op">=</span> <span class="st">"ligand.complex"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-9"></span>
<img src="21-LigandReceptorAnalysis_files/figure-html/unnamed-chunk-9-1.png" alt="SCpubr do_LigandReceptorPlot split by ligand.complex." width="100%" height="100%"><p class="caption">
Figure 1.8: SCpubr do_LigandReceptorPlot split by ligand.complex.
</p>
</div>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ligand Receptor analysis plot grouped by ligand.complex.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   split.by <span class="op">=</span> <span class="st">"receptor.complex"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="21-LigandReceptorAnalysis_files/figure-html/unnamed-chunk-10-1.png" alt="SCpubr do_LigandReceptorPlot split by receptor.complex." width="100%" height="100%"><p class="caption">
Figure 1.9: SCpubr do_LigandReceptorPlot split by receptor.complex.
</p>
</div>
</div>
<div id="restrict-the-plot-to-given-source-andor-targets" class="section level2" number="19.8">
<h2>
<span class="header-section-number">19.8</span> Restrict the plot to given source and/or targets<a class="anchor" aria-label="anchor" href="#restrict-the-plot-to-given-source-andor-targets"><i class="fas fa-link"></i></a>
</h2>
<p>Finally, one can also restrict the output to given source and target clusters. This can be achieved by provided the desired identities to <code>keep_source</code> and <code>keep_target</code>:</p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ligand Receptor analysis plot with inverted axes with filtered source and targets.</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                   flip <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                   keep_source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"3"</span>, <span class="st">"9"</span><span class="op">)</span>,</span>
<span>                                   keep_target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"9"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-11"></span>
<img src="21-LigandReceptorAnalysis_files/figure-html/unnamed-chunk-11-1.png" alt="SCpubr do_LigandReceptorPlot with filtered source and targets." width="100%" height="100%"><p class="caption">
Figure 1.10: SCpubr do_LigandReceptorPlot with filtered source and targets.
</p>
</div>
</div>
<div id="compute-chord-diagrams-of-the-interactions" class="section level2" number="19.9">
<h2>
<span class="header-section-number">19.9</span> Compute chord diagrams of the interactions<a class="anchor" aria-label="anchor" href="#compute-chord-diagrams-of-the-interactions"><i class="fas fa-link"></i></a>
</h2>
<p>Another supplementary visualizations that one can do with the results of liana is to visualize:
- The total number of significant interactions between each pair of clusters.
- The number of interactions between the <code>top_interactions</code> ligand-receptor pairs.</p>
<p>This can be achieved by providing <code>compute_ChordDiagrams = TRUE</code>. This will return a list with the dot plot and chord diagrams.</p>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Chord diagram of the total significant interactions from each cluster and all the rest.</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                     top_interactions <span class="op">=</span> <span class="fl">25</span>,</span>
<span>                                     compute_ChordDiagrams <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">chord_total_interactions</span></span></code></pre></div>
<p><span class="border-0"><img src="images/chord1.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"></span></p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Chord diagram of the total ligand-receptor interactions from each cluster and all the rest.</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">chord_ligand_receptor</span></span></code></pre></div>
<p><span class="border-0"><img src="images/chord2.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"></span></p>
<p>However, the plot can become quite messy. For this, it becomes more interesting to use in combination of <code>keep_source</code> or <code>keep_target</code> parameters:</p>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Chord diagram of the total significant interactions from each cluster and all the rest.</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_LigandReceptorPlot.html">do_LigandReceptorPlot</a></span><span class="op">(</span>liana_output <span class="op">=</span> <span class="va">liana_output</span>,</span>
<span>                                     top_interactions <span class="op">=</span> <span class="fl">25</span>,</span>
<span>                                     keep_source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"7"</span><span class="op">)</span>,</span>
<span>                                     compute_ChordDiagrams <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">chord_total_interactions</span></span></code></pre></div>
<p><span class="border-0"><img src="images/chord3.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"></span></p>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Chord diagram of the total ligand-receptor interactions from each cluster and all the rest.</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">chord_ligand_receptor</span></span></code></pre></div>
<p><span class="border-0"><img src="images/chord4.png" class="mx-auto d-block" alt="" style="box-shadow: none; width: 100%"></span></p>
</div>
<div id="avoid-generating-a-omnipath-log-folder" class="section level2" number="19.10">
<h2>
<span class="header-section-number">19.10</span> Avoid generating a <code>omnipath-log</code> folder<a class="anchor" aria-label="anchor" href="#avoid-generating-a-omnipath-log-folder"><i class="fas fa-link"></i></a>
</h2>
<p>If this folder appears in your tree structure, consider applying the hotfix stated <a href="https://github.com/saezlab/liana/issues/61#issuecomment-1271589284">here</a>.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="cellular-state-plots.html"><span class="header-section-number">18</span> Cellular State Plots</a></div>
<div class="next"><a href="copy-number-variant-analysis-plots.html"><span class="header-section-number">20</span> Copy Number Variant analysis plots</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><form role="search" class="mt-4 mb-4">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>
      <div class="book-extra">
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#ligand-receptor-analysis"><span class="header-section-number">19</span> Ligand-Receptor analysis</a></li>
<li><a class="nav-link" href="#basic-usage-12"><span class="header-section-number">19.1</span> Basic usage</a></li>
<li><a class="nav-link" href="#increase-the-top-significant-interactions-plotted"><span class="header-section-number">19.2</span> Increase the top significant interactions plotted</a></li>
<li><a class="nav-link" href="#add-or-remove-missing-source-target-combinations"><span class="header-section-number">19.3</span> Add or remove missing source-target combinations</a></li>
<li><a class="nav-link" href="#modify-the-size-of-dots"><span class="header-section-number">19.4</span> Modify the size of dots</a></li>
<li><a class="nav-link" href="#toggle-grid-lines"><span class="header-section-number">19.5</span> Toggle grid lines</a></li>
<li><a class="nav-link" href="#invert-axis"><span class="header-section-number">19.6</span> Invert axis</a></li>
<li><a class="nav-link" href="#split-the-plot-by-ligand-or-receptor-complex"><span class="header-section-number">19.7</span> Split the plot by ligand or receptor complex</a></li>
<li><a class="nav-link" href="#restrict-the-plot-to-given-source-andor-targets"><span class="header-section-number">19.8</span> Restrict the plot to given source and/or targets</a></li>
<li><a class="nav-link" href="#compute-chord-diagrams-of-the-interactions"><span class="header-section-number">19.9</span> Compute chord diagrams of the interactions</a></li>
<li><a class="nav-link" href="#avoid-generating-a-omnipath-log-folder"><span class="header-section-number">19.10</span> Avoid generating a omnipath-log folder</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<!-- Modified page for chapter. --><li><a id="book-source" href="https://github.com/enblacar/SCpubr-book/blob/main/21-LigandReceptorAnalysis.Rmd">View chapter source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/enblacar/SCpubr-book/edit/main/21-LigandReceptorAnalysis.Rmd">Edit this chapter <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    
  </div>

</nav>
</div>
</div> <!-- .container -->




</div>
</body>
<!-- Moved the footer outside of the body to make it span all page width. --><footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p class="text-center">Written by <strong>Enrique Blanco Carmona</strong> on 17 October, 2022.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p class="text-center">This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</html>
