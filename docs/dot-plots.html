<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Dot plots | SCpubr - Complete reference</title>
<meta name="author" content="Enrique Blanco Carmona">
<meta name="description" content="Dot plots are a very nice data representation technique. It involves the use of two scales. One scale is color-based while the second one is size-based. In the context of Seurat::DotPlot(), these...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 6 Dot plots | SCpubr - Complete reference">
<meta property="og:type" content="book">
<meta property="og:url" content="https://enblacar.github.io/SCpubr/dot-plots.html">
<meta property="og:image" content="https://enblacar.github.io/SCpubr/images/SCpubr_logo_big.png">
<meta property="og:description" content="Dot plots are a very nice data representation technique. It involves the use of two scales. One scale is color-based while the second one is size-based. In the context of Seurat::DotPlot(), these...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Dot plots | SCpubr - Complete reference">
<meta name="twitter:description" content="Dot plots are a very nice data representation technique. It involves the use of two scales. One scale is color-based while the second one is size-based. In the context of Seurat::DotPlot(), these...">
<meta name="twitter:image" content="https://enblacar.github.io/SCpubr/images/SCpubr_logo_big.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">SCpubr - Complete reference</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About this package</a></li>
<li><a class="" href="installation-guide.html">Installation guide</a></li>
<li><a class="" href="dataset.html">Dataset</a></li>
<li><a class="" href="dim-plots.html"><span class="header-section-number">1</span> Dim plots</a></li>
<li><a class="" href="feature-plots.html"><span class="header-section-number">2</span> Feature plots</a></li>
<li><a class="" href="nebulosa-plots.html"><span class="header-section-number">3</span> Nebulosa plots</a></li>
<li><a class="" href="bee-swarm-plots.html"><span class="header-section-number">4</span> Bee Swarm plots</a></li>
<li><a class="" href="violin-plots.html"><span class="header-section-number">5</span> Violin plots</a></li>
<li><a class="active" href="dot-plots.html"><span class="header-section-number">6</span> Dot plots</a></li>
<li><a class="" href="bar-plots.html"><span class="header-section-number">7</span> Bar plots</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/enblacar/SCpubr/tree/main/docs">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="dot-plots" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Dot plots<a class="anchor" aria-label="anchor" href="#dot-plots"><i class="fas fa-link"></i></a>
</h1>
<p>Dot plots are a very nice data representation technique. It involves the use of two scales. One scale is color-based while the second one is size-based. In the context of <code><a href="https://satijalab.org/seurat/reference/DotPlot.html">Seurat::DotPlot()</a></code>, these scales are pre-defined to contain the average expression values on the color scale and the percentage of cells within the group expressing the feature on the size, increasing it as this percentage grows bigger. It is heavily implied that the features need to be genes, otherwise the color scale will be lost. This is the output from <code>Seurat</code>:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/DotPlot.html">DotPlot</a></span><span class="op">(</span><span class="va">sample</span>, features <span class="op">=</span> <span class="st">"CD14"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/DotPlot.html">DotPlot</a></span><span class="op">(</span><span class="va">sample</span>, features <span class="op">=</span> <span class="st">"nCount_RNA"</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></code></pre></div>
<p>As can be seen, if we try to plot other type of variables, the resulting plot will not contain a color scale. <code><a href="https://rdrr.io/pkg/SCpubr/man/do_DimPlot.html">SCpubr::do_DimPlot()</a></code> focuses on enhancing the overall appearance of the plots. Implementation using other types of features is not currently supported. This is how it looks using <code><a href="https://rdrr.io/pkg/SCpubr/man/do_DimPlot.html">SCpubr::do_DimPlot()</a></code>:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_DotPlot.html">do_DotPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, features <span class="op">=</span> <span class="st">"CD14"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_DotPlot.html">do_DotPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, features <span class="op">=</span> <span class="st">"nFeature_RNA"</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></code></pre></div>
<div id="querying-multiple-features-at-once." class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Querying multiple features at once.<a class="anchor" aria-label="anchor" href="#querying-multiple-features-at-once."><i class="fas fa-link"></i></a>
</h2>
<p>The true power of this data visualization relies on querying multiple genes at once. Letâ€™s query the ones described in this <a href="https://satijalab.org/seurat/articles/pbmc3k_tutorial.html#assigning-cell-type-identity-to-clusters-1">Seurat vignette</a>:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"IL7R"</span>, <span class="st">"CCR7"</span>, <span class="st">"CD14"</span>, <span class="st">"LYZ"</span>, <span class="st">"S100A4"</span>, <span class="st">"MS4A1"</span>, <span class="st">"CD8A"</span>, <span class="st">"FCGR3A"</span>, <span class="st">"MS4A7"</span>, <span class="st">"GNLY"</span>, <span class="st">"NKG7"</span>, <span class="st">"FCER1A"</span>, <span class="st">"CST3"</span>, <span class="st">"PPBP"</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_DotPlot.html">do_DotPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, features <span class="op">=</span> <span class="va">genes</span><span class="op">)</span>
<span class="va">p1</span></code></pre></div>
<p>Here, we can clearly distinguish which clusters are highly enriched in which given genes. This proves to be a very interesting way to query for cluster identities. It is highly dependent, though, on the accuracy of the selected genes for the queried dataset. If we actually provide the list of genes as a named list, we can facet the plot in the different list of genes provided:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Naive CD4+ T"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"IL7R"</span>, <span class="st">"CCR7"</span><span class="op">)</span>,
              <span class="st">"CD14+ Mono"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CD14"</span>, <span class="st">"LYZ"</span><span class="op">)</span>,
              <span class="st">"Memory CD4+"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"S100A4"</span><span class="op">)</span>,
              <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MS4A1"</span><span class="op">)</span>,
              <span class="st">"CD8+ T"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CD8A"</span><span class="op">)</span>,
              <span class="st">"FCGR3A+ Mono"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCGR3A"</span>, <span class="st">"MS4A7"</span><span class="op">)</span>,
              <span class="st">"NK"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GNLY"</span>, <span class="st">"NKG7"</span><span class="op">)</span>,
              <span class="st">"DC"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCER1A"</span>, <span class="st">"CST3"</span><span class="op">)</span>,
              <span class="st">"Platelet"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PPBP"</span><span class="op">)</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_DotPlot.html">do_DotPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, features <span class="op">=</span> <span class="va">genes</span><span class="op">)</span>
<span class="va">p1</span></code></pre></div>
</div>
<div id="clustering-the-identities." class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Clustering the identities.<a class="anchor" aria-label="anchor" href="#clustering-the-identities."><i class="fas fa-link"></i></a>
</h2>
<p>One really cool feature from <code><a href="https://satijalab.org/seurat/reference/DotPlot.html">Seurat::DotPlot()</a></code> is that it lets you cluster the identities in the Y axis depending on how similar they are between them across the values on the X axis. This is achieved by using <code>cluster.idents = TRUE</code>, parameter also implemented in <code><a href="https://rdrr.io/pkg/SCpubr/man/do_DotPlot.html">SCpubr::do_DotPlot()</a></code>:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Naive CD4+ T"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"IL7R"</span>, <span class="st">"CCR7"</span><span class="op">)</span>,
              <span class="st">"CD14+ Mono"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CD14"</span>, <span class="st">"LYZ"</span><span class="op">)</span>,
              <span class="st">"Memory CD4+"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"S100A4"</span><span class="op">)</span>,
              <span class="st">"B"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MS4A1"</span><span class="op">)</span>,
              <span class="st">"CD8+ T"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CD8A"</span><span class="op">)</span>,
              <span class="st">"FCGR3A+ Mono"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCGR3A"</span>, <span class="st">"MS4A7"</span><span class="op">)</span>,
              <span class="st">"NK"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GNLY"</span>, <span class="st">"NKG7"</span><span class="op">)</span>,
              <span class="st">"DC"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCER1A"</span>, <span class="st">"CST3"</span><span class="op">)</span>,
              <span class="st">"Platelet"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PPBP"</span><span class="op">)</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_DotPlot.html">do_DotPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, features <span class="op">=</span> <span class="va">genes</span>, plot.title <span class="op">=</span> <span class="st">"Not clustered"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_DotPlot.html">do_DotPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, features <span class="op">=</span> <span class="va">genes</span>, cluster.idents <span class="op">=</span> <span class="cn">TRUE</span>, plot.title <span class="op">=</span> <span class="st">"Clustered"</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></code></pre></div>
</div>
<div id="inverting-the-axes." class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Inverting the axes.<a class="anchor" aria-label="anchor" href="#inverting-the-axes."><i class="fas fa-link"></i></a>
</h2>
<p>In <code><a href="https://rdrr.io/pkg/SCpubr/man/do_DotPlot.html">SCpubr::do_DotPlot()</a></code>, we can also invert the axes, so that the groups are in the X axis and the genes in the Y axis. This is achieved by using <code>flip = TRUE</code>. Note, however, that this does not work when using a named list of genes as input, as it completelyl distort the way facets are computed. Given this, this combination of parameters is currently blocked by <code>SCpubr</code>.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"IL7R"</span>, <span class="st">"CCR7"</span>, <span class="st">"CD14"</span>, <span class="st">"LYZ"</span>, <span class="st">"S100A4"</span>, <span class="st">"MS4A1"</span>, <span class="st">"CD8A"</span>, <span class="st">"FCGR3A"</span>, <span class="st">"MS4A7"</span>, <span class="st">"GNLY"</span>, <span class="st">"NKG7"</span>, <span class="st">"FCER1A"</span>, <span class="st">"CST3"</span>, <span class="st">"PPBP"</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_DotPlot.html">do_DotPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, features <span class="op">=</span> <span class="va">genes</span>, plot.title <span class="op">=</span> <span class="st">"Not clustered"</span>, flip <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">SCpubr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SCpubr/man/do_DotPlot.html">do_DotPlot</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">sample</span>, features <span class="op">=</span> <span class="va">genes</span>, cluster.idents <span class="op">=</span> <span class="cn">TRUE</span>, plot.title <span class="op">=</span> <span class="st">"Clustered"</span>, flip <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="violin-plots.html"><span class="header-section-number">5</span> Violin plots</a></div>
<div class="next"><a href="bar-plots.html"><span class="header-section-number">7</span> Bar plots</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#dot-plots"><span class="header-section-number">6</span> Dot plots</a></li>
<li><a class="nav-link" href="#querying-multiple-features-at-once."><span class="header-section-number">6.1</span> Querying multiple features at once.</a></li>
<li><a class="nav-link" href="#clustering-the-identities."><span class="header-section-number">6.2</span> Clustering the identities.</a></li>
<li><a class="nav-link" href="#inverting-the-axes."><span class="header-section-number">6.3</span> Inverting the axes.</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/enblacar/SCpubr/tree/main/docs/blob//08-DotPlots.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/enblacar/SCpubr/tree/main/docs/edit//08-DotPlots.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>SCpubr - Complete reference</strong>" was written by Enrique Blanco Carmona. It was last built on 17 February, 2022.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
